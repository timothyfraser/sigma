<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Statistical Process Control in Python | System Reliability and Six Sigma in R</title>
  <meta name="description" content="Your online textbook for learning reliability and six sigma techniques in R! Made for Cornell University Course SYSEN 5300." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Statistical Process Control in Python | System Reliability and Six Sigma in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Your online textbook for learning reliability and six sigma techniques in R! Made for Cornell University Course SYSEN 5300." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Statistical Process Control in Python | System Reliability and Six Sigma in R" />
  
  <meta name="twitter:description" content="Your online textbook for learning reliability and six sigma techniques in R! Made for Cornell University Course SYSEN 5300." />
  

<meta name="author" content="Timothy Fraser, PhD" />


<meta name="date" content="2025-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html"><i class="fa fa-check"></i><b>1</b> Statistical Process Control in Python</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#getting-started"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#custom-functions"><i class="fa fa-check"></i>Custom Functions</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#our-case"><i class="fa fa-check"></i>Our Case</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#our-data"><i class="fa fa-check"></i>Our Data</a></li>
</ul></li>
<li class="chapter" data-level="1.1" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#process-descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> Process Descriptive Statistics</a></li>
<li class="chapter" data-level="1.2" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#process-overview-visual"><i class="fa fa-check"></i><b>1.2</b> Process Overview Visual</a></li>
<li class="chapter" data-level="1.3" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#subgroup-within-group-statistics"><i class="fa fa-check"></i><b>1.3</b> Subgroup (Within-Group) Statistics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#total-statistics-between-groups"><i class="fa fa-check"></i><b>1.3.1</b> Total Statistics (Between Groups)</a></li>
<li class="chapter" data-level="1.3.2" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#average-and-standard-deviation-charts"><i class="fa fa-check"></i><b>1.3.2</b> Average and Standard Deviation Charts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#learning-check-1"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="1.4" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#moving-range-charts-n1"><i class="fa fa-check"></i><b>1.4</b> Moving Range Charts (n=1)</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">System Reliability and Six Sigma in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-process-control-in-python" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Statistical Process Control in Python<a href="statistical-process-control-in-python.html#statistical-process-control-in-python" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="images/9_chart.png" alt="Statistical Process Control!" width="100%" />
<p class="caption">
Figure 1.1: Statistical Process Control!
</p>
</div>
<p>In this workshop, we will learn how to perform statistical process control in Python, using statistical tools and <code>plotnine</code> visualizations! Statistical Process Control refers to using statistics to (1) measure variation in product quality over time and (2) identify benchmarks to know when intervention is needed. Let’s get started!</p>
<hr />
<div id="getting-started" class="section level2 unnumbered hasAnchor">
<h2>Getting Started<a href="statistical-process-control-in-python.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="packages" class="section level3 unnumbered hasAnchor">
<h3>Packages<a href="statistical-process-control-in-python.html#packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="statistical-process-control-in-python.html#cb1-1" tabindex="-1"></a><span class="co"># Remember to install these packages using a terminal, if you haven&#39;t already!</span></span>
<span id="cb1-2"><a href="statistical-process-control-in-python.html#cb1-2" tabindex="-1"></a><span class="op">!</span>pip install pandas plotnine scipy</span></code></pre></div>
<p>We’ll be using <code>pandas</code> for data manipulation, <code>plotnine</code> for visualization, and <code>scipy</code> for statistical functions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="statistical-process-control-in-python.html#cb2-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="statistical-process-control-in-python.html#cb2-2" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span></code></pre></div>
</div>
<div id="custom-functions" class="section level3 unnumbered hasAnchor">
<h3>Custom Functions<a href="statistical-process-control-in-python.html#custom-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This workshop uses custom functions from the <code>functions/</code> directory. You may need both:
- <code>functions_distributions.py</code> - for reliability and distribution functions
- <code>functions_process_control.py</code> - for statistical process control functions</p>
<p>To use these functions, you need to acquire them from the repository at <a href="https://github.com/timothyfraser/sigma/tree/main/functions">github.com/timothyfraser/sigma/tree/main/functions</a>.</p>
<p><strong>Add the functions directory to your Python path</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="statistical-process-control-in-python.html#cb3-1" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb3-2"><a href="statistical-process-control-in-python.html#cb3-2" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="statistical-process-control-in-python.html#cb3-3" tabindex="-1"></a><span class="co"># Add the functions directory to Python path</span></span>
<span id="cb3-4"><a href="statistical-process-control-in-python.html#cb3-4" tabindex="-1"></a>sys.path.append(<span class="st">&#39;functions&#39;</span>)  <span class="co"># or path to wherever you placed the functions folder</span></span></code></pre></div>
<p>Once you have the functions available, you can import them:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="statistical-process-control-in-python.html#cb4-1" tabindex="-1"></a><span class="im">from</span> functions_distributions <span class="im">import</span> density, tidy_density, approxfun</span>
<span id="cb4-2"><a href="statistical-process-control-in-python.html#cb4-2" tabindex="-1"></a><span class="co"># from functions_process_control import ggprocess, ggsubgroup, ggmoving, ggcapability  # if needed</span></span></code></pre></div>
</div>
<div id="our-case" class="section level3 unnumbered hasAnchor">
<h3>Our Case<a href="statistical-process-control-in-python.html#our-case" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="https://static.wixstatic.com/media/e8dc42_9cf1b5c0e5664ebd96581ffa8891eae2~mv2_d_1960_1200_s_2.jpg/v1/fill/w_1225,h_819,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/DSC00255-1-3_JPG.jpg" alt="Obanazawa City, Yamagata Prefecture - A Hot Springs Economy. [**Photo credit and more here.**](https://www.thehiddenjapan.com/ginzanonsen)" width="100%" />
<p class="caption">
Figure 1.2: Obanazawa City, Yamagata Prefecture - A Hot Springs Economy. <a href="https://www.thehiddenjapan.com/ginzanonsen"><strong>Photo credit and more here.</strong></a>
</p>
</div>
<p>For today’s workshop, we’re going to think about why quality control matters in a local economy, by examining the case of the Japanese Hot Springs bath economy! Hot springs, or <em>onsen</em>, are <a href="https://asiatimes.com/2020/07/japanese-hot-spring-tourism-at-a-crossroads/">a major source of tourism and recreation for families in Japan</a>, bringing residents from across the country every year to often rural communities where the right geological conditions have brought on naturally occurring hot springs. Restaurants, taxi and bus companies, and many service sector firms rely on their local onsen to bring in a steady stream (pun intended) of tourists to the local economy. So, it’s often in the best interest of <em>onsen</em> operators to keep an eye on the temperature, minerals, or other aspects of their hot springs baths to ensure quality control, to keep up their firm (and town’s!) reputation for quality rest and relaxation!</p>
<p><em>Onsen</em>-goers often seek out <em>specific</em> types of hot springs, so it’s important for an <em>onsen</em> to actually provide what it advertises! <a href="http://dx.doi.org/10.1016/j.healthplace.2012.06.020">Serbulea and Payyappallimana (2012)</a> describe some of these benchmarks.</p>
<ul>
<li><p><strong>Temperature</strong>: Onsen are divided into “Extra Hot Springs” (<code>&gt;42°C</code>), “Hot Springs” (<code>41~34°C</code>), and “Warm Springs” (<code>33~25°C</code>).</p></li>
<li><p><strong>pH</strong>: Onsen are classified into “Acidic” (<code>pH &lt; 3</code>), “Mildly Acidic” (<code>pH 3~6</code>), “Neutral” (<code>pH 6~7.5</code>), “Mildly alkaline” (<code>pH 7.5~8.5</code>), and “Alkaline” (<code>pH &gt; 8.5</code>).</p></li>
<li><p><strong>Sulfur</strong>: Sulfur <em>onsen</em> typically have about 2mg of sulfur per 1kg of hot spring water; sulfur levels <em>must</em> exceed 1 mg to count as a Sulfur <em>onsen.</em> (It smells like rotten eggs!)</p></li>
</ul>
<p>These are decent examples of quality control metrics that <em>onsen</em> operators might want to keep tabs on!</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="images/9_monkeys.png" alt="Monkeys are even fans of onsen! Read [**more here!**](https://www.nytimes.com/2018/04/03/science/japan-monkeys-hot-springs-stress.html)" width="100%" />
<p class="caption">
Figure 1.3: Monkeys are even fans of onsen! Read <a href="https://www.nytimes.com/2018/04/03/science/japan-monkeys-hot-springs-stress.html"><strong>more here!</strong></a>
</p>
</div>
</div>
<div id="our-data" class="section level3 unnumbered hasAnchor">
<h3>Our Data<a href="statistical-process-control-in-python.html#our-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You’ve been hired to evaluate quality control at a local <em>onsen</em> in sunny Kagoshima prefecture! Every month, for 15 months, you systematically took 20 random samples of hot spring water and recorded its <strong>temperature</strong>, <strong>pH</strong>, and <strong>sulfur</strong> levels. How might you determine if this <em>onsen</em> is at risk of slipping out of one sector of the market (eg. Extra Hot!) and into another (just normal Hot Springs?).</p>
<p>Let’s read in our data from <code>workshops/onsen.csv</code>!</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="statistical-process-control-in-python.html#cb5-1" tabindex="-1"></a><span class="co"># Add functions directory to path if not already there</span></span>
<span id="cb5-2"><a href="statistical-process-control-in-python.html#cb5-2" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb5-3"><a href="statistical-process-control-in-python.html#cb5-3" tabindex="-1"></a><span class="cf">if</span> <span class="st">&#39;functions&#39;</span> <span class="kw">not</span> <span class="kw">in</span> sys.path:</span>
<span id="cb5-4"><a href="statistical-process-control-in-python.html#cb5-4" tabindex="-1"></a>    sys.path.append(<span class="st">&#39;functions&#39;</span>)</span>
<span id="cb5-5"><a href="statistical-process-control-in-python.html#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="statistical-process-control-in-python.html#cb5-6" tabindex="-1"></a><span class="im">from</span> functions_distributions <span class="im">import</span> density, tidy_density, approxfun</span>
<span id="cb5-7"><a href="statistical-process-control-in-python.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="statistical-process-control-in-python.html#cb5-8" tabindex="-1"></a>water <span class="op">=</span> pd.read_csv(<span class="st">&#39;workshops/onsen.csv&#39;</span>)</span>
<span id="cb5-9"><a href="statistical-process-control-in-python.html#cb5-9" tabindex="-1"></a>water.head(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    id  time  temp   ph  sulfur
## 0   1     1  43.2  5.1     0.0
## 1   2     1  45.3  4.8     0.4
## 2   3     1  45.5  6.2     0.9</code></pre>
</div>
</div>
<div id="process-descriptive-statistics" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Process Descriptive Statistics<a href="statistical-process-control-in-python.html#process-descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s get a sense of our process by calculating some basic descriptive statistics. We’ll create a simple function to calculate the mean and standard deviation, which are fundamental to understanding process variation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="statistical-process-control-in-python.html#cb7-1" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> Series</span>
<span id="cb7-2"><a href="statistical-process-control-in-python.html#cb7-2" tabindex="-1"></a><span class="kw">def</span> describe(x: Series):</span>
<span id="cb7-3"><a href="statistical-process-control-in-python.html#cb7-3" tabindex="-1"></a>  x <span class="op">=</span> Series(x)</span>
<span id="cb7-4"><a href="statistical-process-control-in-python.html#cb7-4" tabindex="-1"></a>  out <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-5"><a href="statistical-process-control-in-python.html#cb7-5" tabindex="-1"></a>    <span class="st">&#39;mean&#39;</span>: [x.mean()],</span>
<span id="cb7-6"><a href="statistical-process-control-in-python.html#cb7-6" tabindex="-1"></a>    <span class="st">&#39;sd&#39;</span>: [x.std()],</span>
<span id="cb7-7"><a href="statistical-process-control-in-python.html#cb7-7" tabindex="-1"></a>  })</span>
<span id="cb7-8"><a href="statistical-process-control-in-python.html#cb7-8" tabindex="-1"></a>  out[<span class="st">&#39;caption&#39;</span>] <span class="op">=</span> (<span class="st">&quot;Process Mean: &quot;</span> <span class="op">+</span> out[<span class="st">&#39;mean&#39;</span>].<span class="bu">round</span>(<span class="dv">2</span>).astype(<span class="bu">str</span>) <span class="op">+</span></span>
<span id="cb7-9"><a href="statistical-process-control-in-python.html#cb7-9" tabindex="-1"></a>                    <span class="st">&quot; | SD: &quot;</span> <span class="op">+</span> out[<span class="st">&#39;sd&#39;</span>].<span class="bu">round</span>(<span class="dv">2</span>).astype(<span class="bu">str</span>))</span>
<span id="cb7-10"><a href="statistical-process-control-in-python.html#cb7-10" tabindex="-1"></a>  <span class="cf">return</span> out</span>
<span id="cb7-11"><a href="statistical-process-control-in-python.html#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="statistical-process-control-in-python.html#cb7-12" tabindex="-1"></a>tab <span class="op">=</span> describe(water[<span class="st">&#39;temp&#39;</span>])</span>
<span id="cb7-13"><a href="statistical-process-control-in-python.html#cb7-13" tabindex="-1"></a>tab</span></code></pre></div>
<pre><code>##     mean        sd                         caption
## 0  44.85  1.989501  Process Mean: 44.85 | SD: 1.99</code></pre>
<p>Now let’s apply this to our temperature data to see the overall process mean and variation.</p>
</div>
<div id="process-overview-visual" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Process Overview Visual<a href="statistical-process-control-in-python.html#process-overview-visual" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The process overview chart is one of the most important tools in SPC. It shows us how our process behaves over time, helping us identify patterns, trends, and potential issues. We’ll create a visualization that shows individual measurements, subgroup means, and the overall process average.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="statistical-process-control-in-python.html#cb9-1" tabindex="-1"></a>g1 <span class="op">=</span> (ggplot(water, aes(x<span class="op">=</span><span class="st">&#39;time&#39;</span>, y<span class="op">=</span><span class="st">&#39;temp&#39;</span>, group<span class="op">=</span><span class="st">&#39;time&#39;</span>)) <span class="op">+</span></span>
<span id="cb9-2"><a href="statistical-process-control-in-python.html#cb9-2" tabindex="-1"></a>  geom_hline(aes(yintercept<span class="op">=</span>water[<span class="st">&#39;temp&#39;</span>].mean()), color<span class="op">=</span><span class="st">&#39;lightgrey&#39;</span>, size<span class="op">=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb9-3"><a href="statistical-process-control-in-python.html#cb9-3" tabindex="-1"></a>  geom_jitter(height<span class="op">=</span><span class="dv">0</span>, width<span class="op">=</span><span class="fl">0.25</span>) <span class="op">+</span></span>
<span id="cb9-4"><a href="statistical-process-control-in-python.html#cb9-4" tabindex="-1"></a>  geom_boxplot() <span class="op">+</span></span>
<span id="cb9-5"><a href="statistical-process-control-in-python.html#cb9-5" tabindex="-1"></a>  labs(x<span class="op">=</span><span class="st">&#39;Time (Subgroup)&#39;</span>, y<span class="op">=</span><span class="st">&#39;Temperature (Celsius)&#39;</span>, subtitle<span class="op">=</span><span class="st">&#39;Process Overview&#39;</span>, caption<span class="op">=</span>tab[<span class="st">&#39;caption&#39;</span>][<span class="dv">0</span>]))</span>
<span id="cb9-6"><a href="statistical-process-control-in-python.html#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="statistical-process-control-in-python.html#cb9-7" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb9-8"><a href="statistical-process-control-in-python.html#cb9-8" tabindex="-1"></a>g1.save(<span class="st">&#39;images/05_process_overview.png&#39;</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">6</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="images/05_process_overview.png" width="100%" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="statistical-process-control-in-python.html#cb10-1" tabindex="-1"></a>g2 <span class="op">=</span> (ggplot(water, aes(x<span class="op">=</span><span class="st">&#39;temp&#39;</span>)) <span class="op">+</span> geom_histogram(bins<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">&#39;white&#39;</span>, fill<span class="op">=</span><span class="st">&#39;grey&#39;</span>) <span class="op">+</span> theme_void() <span class="op">+</span> coord_flip())</span>
<span id="cb10-2"><a href="statistical-process-control-in-python.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="statistical-process-control-in-python.html#cb10-3" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb10-4"><a href="statistical-process-control-in-python.html#cb10-4" tabindex="-1"></a>g2.save(<span class="st">&#39;images/05_process_histogram.png&#39;</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">6</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="images/05_process_histogram.png" width="100%" /></p>
<p>The histogram shows us the distribution of all temperature measurements, giving us insight into the overall process variation. This helps us understand if our process is centered and how much variation we’re seeing.</p>
</div>
<div id="subgroup-within-group-statistics" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Subgroup (Within-Group) Statistics<a href="statistical-process-control-in-python.html#subgroup-within-group-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In SPC, we often work with <em>subgroups</em> - small samples taken at regular intervals. This allows us to distinguish between common cause variation (inherent to the process) and special cause variation (due to specific events). Let’s calculate statistics for each subgroup to see how the process behaves over time.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="statistical-process-control-in-python.html#cb11-1" tabindex="-1"></a>stat_s <span class="op">=</span> (water.groupby(<span class="st">&#39;time&#39;</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> d: pd.Series({</span>
<span id="cb11-2"><a href="statistical-process-control-in-python.html#cb11-2" tabindex="-1"></a>  <span class="st">&#39;xbar&#39;</span>: d[<span class="st">&#39;temp&#39;</span>].mean(),</span>
<span id="cb11-3"><a href="statistical-process-control-in-python.html#cb11-3" tabindex="-1"></a>  <span class="st">&#39;r&#39;</span>: d[<span class="st">&#39;temp&#39;</span>].<span class="bu">max</span>() <span class="op">-</span> d[<span class="st">&#39;temp&#39;</span>].<span class="bu">min</span>(),</span>
<span id="cb11-4"><a href="statistical-process-control-in-python.html#cb11-4" tabindex="-1"></a>  <span class="st">&#39;sd&#39;</span>: d[<span class="st">&#39;temp&#39;</span>].std(),</span>
<span id="cb11-5"><a href="statistical-process-control-in-python.html#cb11-5" tabindex="-1"></a>  <span class="st">&#39;nw&#39;</span>: <span class="bu">len</span>(d)</span>
<span id="cb11-6"><a href="statistical-process-control-in-python.html#cb11-6" tabindex="-1"></a>})).reset_index())</span>
<span id="cb11-7"><a href="statistical-process-control-in-python.html#cb11-7" tabindex="-1"></a>stat_s[<span class="st">&#39;df&#39;</span>] <span class="op">=</span> stat_s[<span class="st">&#39;nw&#39;</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb11-8"><a href="statistical-process-control-in-python.html#cb11-8" tabindex="-1"></a>stat_s[<span class="st">&#39;sigma_s&#39;</span>] <span class="op">=</span> ( (stat_s[<span class="st">&#39;df&#39;</span>] <span class="op">*</span> (stat_s[<span class="st">&#39;sd&#39;</span>]<span class="op">**</span><span class="dv">2</span>)).<span class="bu">sum</span>() <span class="op">/</span> stat_s[<span class="st">&#39;df&#39;</span>].<span class="bu">sum</span>() )<span class="op">**</span><span class="fl">0.5</span></span>
<span id="cb11-9"><a href="statistical-process-control-in-python.html#cb11-9" tabindex="-1"></a>stat_s[<span class="st">&#39;se&#39;</span>] <span class="op">=</span> stat_s[<span class="st">&#39;sigma_s&#39;</span>] <span class="op">/</span> (stat_s[<span class="st">&#39;nw&#39;</span>]<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb11-10"><a href="statistical-process-control-in-python.html#cb11-10" tabindex="-1"></a>stat_s[<span class="st">&#39;upper&#39;</span>] <span class="op">=</span> stat_s[<span class="st">&#39;xbar&#39;</span>].mean() <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>stat_s[<span class="st">&#39;se&#39;</span>]</span>
<span id="cb11-11"><a href="statistical-process-control-in-python.html#cb11-11" tabindex="-1"></a>stat_s[<span class="st">&#39;lower&#39;</span>] <span class="op">=</span> stat_s[<span class="st">&#39;xbar&#39;</span>].mean() <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>stat_s[<span class="st">&#39;se&#39;</span>]</span>
<span id="cb11-12"><a href="statistical-process-control-in-python.html#cb11-12" tabindex="-1"></a>stat_s.head(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    time    xbar    r        sd    nw    df   sigma_s        se      upper      lower
## 0     1  44.635  4.2  1.342533  20.0  19.0  1.986174  0.444122  46.182366  43.517634
## 1     3  45.305  7.9  2.001440  20.0  19.0  1.986174  0.444122  46.182366  43.517634
## 2     5  44.765  5.9  1.628133  20.0  19.0  1.986174  0.444122  46.182366  43.517634</code></pre>
<p>Here we’ve calculated key statistics for each subgroup:</p>
<ul>
<li><strong>xbar</strong>: The mean of each subgroup</li>
<li><strong>r</strong>: The range (max - min) within each subgroup<br />
</li>
<li><strong>sd</strong>: The standard deviation within each subgroup</li>
<li><strong>sigma_s</strong>: The pooled within-subgroup standard deviation</li>
<li><strong>se</strong>: The standard error for each subgroup mean</li>
</ul>
<div id="total-statistics-between-groups" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Total Statistics (Between Groups)<a href="statistical-process-control-in-python.html#total-statistics-between-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s calculate the overall process statistics that summarize the behavior across all subgroups:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="statistical-process-control-in-python.html#cb13-1" tabindex="-1"></a>stat_t <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-2"><a href="statistical-process-control-in-python.html#cb13-2" tabindex="-1"></a>  <span class="st">&#39;xbbar&#39;</span>: [stat_s[<span class="st">&#39;xbar&#39;</span>].mean()],</span>
<span id="cb13-3"><a href="statistical-process-control-in-python.html#cb13-3" tabindex="-1"></a>  <span class="st">&#39;rbar&#39;</span>: [stat_s[<span class="st">&#39;r&#39;</span>].mean()],</span>
<span id="cb13-4"><a href="statistical-process-control-in-python.html#cb13-4" tabindex="-1"></a>  <span class="st">&#39;sdbar&#39;</span>: [stat_s[<span class="st">&#39;sd&#39;</span>].mean()],</span>
<span id="cb13-5"><a href="statistical-process-control-in-python.html#cb13-5" tabindex="-1"></a>  <span class="st">&#39;sigma_s&#39;</span>: [(stat_s[<span class="st">&#39;sd&#39;</span>]<span class="op">**</span><span class="dv">2</span>).mean()<span class="op">**</span><span class="fl">0.5</span>],</span>
<span id="cb13-6"><a href="statistical-process-control-in-python.html#cb13-6" tabindex="-1"></a>  <span class="st">&#39;sigma_t&#39;</span>: [water[<span class="st">&#39;temp&#39;</span>].std()]</span>
<span id="cb13-7"><a href="statistical-process-control-in-python.html#cb13-7" tabindex="-1"></a>})</span>
<span id="cb13-8"><a href="statistical-process-control-in-python.html#cb13-8" tabindex="-1"></a>stat_t</span></code></pre></div>
<pre><code>##    xbbar    rbar    sdbar   sigma_s   sigma_t
## 0  44.85  7.2625  1.93619  1.986174  1.989501</code></pre>
<p>These statistics give us:</p>
<ul>
<li><strong>xbbar</strong>: The grand mean (average of all subgroup means)</li>
<li><strong>rbar</strong>: The average range across subgroups</li>
<li><strong>sdbar</strong>: The average standard deviation across subgroups</li>
<li><strong>sigma_s</strong>: The pooled within-subgroup standard deviation</li>
<li><strong>sigma_t</strong>: The total process standard deviation</li>
</ul>
</div>
<div id="average-and-standard-deviation-charts" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Average and Standard Deviation Charts<a href="statistical-process-control-in-python.html#average-and-standard-deviation-charts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Control charts are the heart of SPC. They help us monitor process stability over time and detect when the process is out of control. We’ll create charts for both the subgroup means (X-bar chart) and standard deviations (S chart).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="statistical-process-control-in-python.html#cb15-1" tabindex="-1"></a>labels <span class="op">=</span> pd.DataFrame({</span>
<span id="cb15-2"><a href="statistical-process-control-in-python.html#cb15-2" tabindex="-1"></a>  <span class="st">&#39;time&#39;</span>: [stat_s[<span class="st">&#39;time&#39;</span>].<span class="bu">max</span>()]<span class="op">*</span><span class="dv">3</span>,</span>
<span id="cb15-3"><a href="statistical-process-control-in-python.html#cb15-3" tabindex="-1"></a>  <span class="st">&#39;type&#39;</span>: [<span class="st">&#39;xbbar&#39;</span>,<span class="st">&#39;upper&#39;</span>,<span class="st">&#39;lower&#39;</span>],</span>
<span id="cb15-4"><a href="statistical-process-control-in-python.html#cb15-4" tabindex="-1"></a>  <span class="st">&#39;name&#39;</span>: [<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;+3 s&#39;</span>,<span class="st">&#39;-3 s&#39;</span>],</span>
<span id="cb15-5"><a href="statistical-process-control-in-python.html#cb15-5" tabindex="-1"></a>  <span class="st">&#39;value&#39;</span>: [stat_s[<span class="st">&#39;xbar&#39;</span>].mean(), stat_s[<span class="st">&#39;upper&#39;</span>].iloc[<span class="dv">0</span>], stat_s[<span class="st">&#39;lower&#39;</span>].iloc[<span class="dv">0</span>]]</span>
<span id="cb15-6"><a href="statistical-process-control-in-python.html#cb15-6" tabindex="-1"></a>})</span>
<span id="cb15-7"><a href="statistical-process-control-in-python.html#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="statistical-process-control-in-python.html#cb15-8" tabindex="-1"></a>control_chart <span class="op">=</span> (ggplot(stat_s, aes(x<span class="op">=</span><span class="st">&#39;time&#39;</span>, y<span class="op">=</span><span class="st">&#39;xbar&#39;</span>)) <span class="op">+</span></span>
<span id="cb15-9"><a href="statistical-process-control-in-python.html#cb15-9" tabindex="-1"></a>  geom_hline(aes(yintercept<span class="op">=</span>stat_s[<span class="st">&#39;xbar&#39;</span>].mean()), color<span class="op">=</span><span class="st">&#39;lightgrey&#39;</span>, size<span class="op">=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb15-10"><a href="statistical-process-control-in-python.html#cb15-10" tabindex="-1"></a>  geom_ribbon(aes(ymin<span class="op">=</span><span class="st">&#39;lower&#39;</span>, ymax<span class="op">=</span><span class="st">&#39;upper&#39;</span>), fill<span class="op">=</span><span class="st">&#39;steelblue&#39;</span>, alpha<span class="op">=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb15-11"><a href="statistical-process-control-in-python.html#cb15-11" tabindex="-1"></a>  geom_line(size<span class="op">=</span><span class="dv">1</span>) <span class="op">+</span> geom_point(size<span class="op">=</span><span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb15-12"><a href="statistical-process-control-in-python.html#cb15-12" tabindex="-1"></a>  geom_label(data<span class="op">=</span>labels, mapping<span class="op">=</span>aes(x<span class="op">=</span><span class="st">&#39;time&#39;</span>, y<span class="op">=</span><span class="st">&#39;value&#39;</span>, label<span class="op">=</span><span class="st">&#39;name&#39;</span>), ha<span class="op">=</span><span class="st">&#39;right&#39;</span>) <span class="op">+</span></span>
<span id="cb15-13"><a href="statistical-process-control-in-python.html#cb15-13" tabindex="-1"></a>  labs(x<span class="op">=</span><span class="st">&#39;Time (Subgroups)&#39;</span>, y<span class="op">=</span><span class="st">&#39;Average&#39;</span>, subtitle<span class="op">=</span><span class="st">&#39;Average and Standard Deviation Chart&#39;</span>))</span>
<span id="cb15-14"><a href="statistical-process-control-in-python.html#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="statistical-process-control-in-python.html#cb15-15" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb15-16"><a href="statistical-process-control-in-python.html#cb15-16" tabindex="-1"></a>control_chart.save(<span class="st">&#39;images/05_control_chart.png&#39;</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">6</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="images/05_control_chart.png" width="100%" /></p>
<p>This control chart shows:</p>
<ul>
<li><strong>Center line</strong>: The grand mean (xbbar)</li>
<li><strong>Control limits</strong>: Upper and lower 3-sigma limits based on the standard error</li>
<li><strong>Individual points</strong>: Each subgroup mean plotted over time</li>
<li><strong>Shaded area</strong>: The control limits region</li>
</ul>
<p>Points outside the control limits or showing non-random patterns indicate the process may be out of control and requires investigation.</p>
<hr />
</div>
</div>
<div id="learning-check-1" class="section level2 unnumbered LC hasAnchor">
<h2>Learning Check 1<a href="statistical-process-control-in-python.html#learning-check-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Question</strong></p>
<p>Produce the same process overview chart for <code>pH</code>.</p>
<details>
<summary>
<strong>[View Answer!]</strong>
</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="statistical-process-control-in-python.html#cb16-1" tabindex="-1"></a><span class="kw">def</span> ggprocess(x, y, xlab<span class="op">=</span><span class="st">&#39;Subgroup&#39;</span>, ylab<span class="op">=</span><span class="st">&#39;Metric&#39;</span>):</span>
<span id="cb16-2"><a href="statistical-process-control-in-python.html#cb16-2" tabindex="-1"></a>  <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-3"><a href="statistical-process-control-in-python.html#cb16-3" tabindex="-1"></a>  <span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, geom_hline, geom_jitter, geom_boxplot, labs</span>
<span id="cb16-4"><a href="statistical-process-control-in-python.html#cb16-4" tabindex="-1"></a>  d <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>: x, <span class="st">&#39;y&#39;</span>: y})</span>
<span id="cb16-5"><a href="statistical-process-control-in-python.html#cb16-5" tabindex="-1"></a>  g <span class="op">=</span> (ggplot(d, aes(x<span class="op">=</span><span class="st">&#39;x&#39;</span>, y<span class="op">=</span><span class="st">&#39;y&#39;</span>, group<span class="op">=</span><span class="st">&#39;x&#39;</span>)) <span class="op">+</span></span>
<span id="cb16-6"><a href="statistical-process-control-in-python.html#cb16-6" tabindex="-1"></a>       geom_hline(aes(yintercept<span class="op">=</span>d[<span class="st">&#39;y&#39;</span>].mean()), color<span class="op">=</span><span class="st">&#39;lightgrey&#39;</span>, size<span class="op">=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb16-7"><a href="statistical-process-control-in-python.html#cb16-7" tabindex="-1"></a>       geom_jitter(height<span class="op">=</span><span class="dv">0</span>, width<span class="op">=</span><span class="fl">0.25</span>) <span class="op">+</span></span>
<span id="cb16-8"><a href="statistical-process-control-in-python.html#cb16-8" tabindex="-1"></a>       geom_boxplot() <span class="op">+</span></span>
<span id="cb16-9"><a href="statistical-process-control-in-python.html#cb16-9" tabindex="-1"></a>       labs(x<span class="op">=</span>xlab, y<span class="op">=</span>ylab, subtitle<span class="op">=</span><span class="st">&#39;Process Overview&#39;</span>))</span>
<span id="cb16-10"><a href="statistical-process-control-in-python.html#cb16-10" tabindex="-1"></a>  <span class="cf">return</span> g</span>
<span id="cb16-11"><a href="statistical-process-control-in-python.html#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="statistical-process-control-in-python.html#cb16-12" tabindex="-1"></a>ph_chart <span class="op">=</span> ggprocess(water[<span class="st">&#39;time&#39;</span>], water[<span class="st">&#39;ph&#39;</span>])</span>
<span id="cb16-13"><a href="statistical-process-control-in-python.html#cb16-13" tabindex="-1"></a></span>
<span id="cb16-14"><a href="statistical-process-control-in-python.html#cb16-14" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb16-15"><a href="statistical-process-control-in-python.html#cb16-15" tabindex="-1"></a>ph_chart.save(<span class="st">&#39;images/05_ph_chart.png&#39;</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">6</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="images/05_ph_chart.png" width="100%" /></p>
</details>
<hr />
</div>
<div id="moving-range-charts-n1" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Moving Range Charts (n=1)<a href="statistical-process-control-in-python.html#moving-range-charts-n1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we have individual measurements rather than subgroups, we use moving range charts. The moving range is the absolute difference between consecutive measurements, which helps us estimate process variation when we can’t calculate within-subgroup statistics.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="statistical-process-control-in-python.html#cb17-1" tabindex="-1"></a>indiv <span class="op">=</span> water.iloc[[<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>,<span class="dv">100</span>,<span class="dv">120</span>,<span class="dv">140</span>]]</span>
<span id="cb17-2"><a href="statistical-process-control-in-python.html#cb17-2" tabindex="-1"></a>mr <span class="op">=</span> (indiv[<span class="st">&#39;temp&#39;</span>].diff().<span class="bu">abs</span>().dropna())</span>
<span id="cb17-3"><a href="statistical-process-control-in-python.html#cb17-3" tabindex="-1"></a>mrbar <span class="op">=</span> mr.mean()</span>
<span id="cb17-4"><a href="statistical-process-control-in-python.html#cb17-4" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-5"><a href="statistical-process-control-in-python.html#cb17-5" tabindex="-1"></a>d2 <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(np.diff(np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">10000</span>))))</span>
<span id="cb17-6"><a href="statistical-process-control-in-python.html#cb17-6" tabindex="-1"></a>sigma_s <span class="op">=</span> mrbar <span class="op">/</span> d2</span>
<span id="cb17-7"><a href="statistical-process-control-in-python.html#cb17-7" tabindex="-1"></a>se <span class="op">=</span> sigma_s <span class="op">/</span> (<span class="dv">1</span><span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb17-8"><a href="statistical-process-control-in-python.html#cb17-8" tabindex="-1"></a>upper <span class="op">=</span> mrbar <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>se</span>
<span id="cb17-9"><a href="statistical-process-control-in-python.html#cb17-9" tabindex="-1"></a>lower <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="statistical-process-control-in-python.html#cb18-1" tabindex="-1"></a>istat <span class="op">=</span> pd.DataFrame({<span class="st">&#39;time&#39;</span>: indiv[<span class="st">&#39;time&#39;</span>].iloc[<span class="dv">1</span>:], <span class="st">&#39;mr&#39;</span>: mr, <span class="st">&#39;mrbar&#39;</span>: mrbar, <span class="st">&#39;upper&#39;</span>: upper, <span class="st">&#39;lower&#39;</span>: lower})</span>
<span id="cb18-2"><a href="statistical-process-control-in-python.html#cb18-2" tabindex="-1"></a>mr_chart <span class="op">=</span> (ggplot(istat, aes(x<span class="op">=</span><span class="st">&#39;time&#39;</span>, y<span class="op">=</span><span class="st">&#39;mr&#39;</span>)) <span class="op">+</span></span>
<span id="cb18-3"><a href="statistical-process-control-in-python.html#cb18-3" tabindex="-1"></a>  geom_ribbon(aes(ymin<span class="op">=</span><span class="st">&#39;lower&#39;</span>, ymax<span class="op">=</span><span class="st">&#39;upper&#39;</span>), fill<span class="op">=</span><span class="st">&#39;steelblue&#39;</span>, alpha<span class="op">=</span><span class="fl">0.25</span>) <span class="op">+</span></span>
<span id="cb18-4"><a href="statistical-process-control-in-python.html#cb18-4" tabindex="-1"></a>  geom_hline(aes(yintercept<span class="op">=</span>mr.mean()), size<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">&#39;darkgrey&#39;</span>) <span class="op">+</span></span>
<span id="cb18-5"><a href="statistical-process-control-in-python.html#cb18-5" tabindex="-1"></a>  geom_line(size<span class="op">=</span><span class="dv">1</span>) <span class="op">+</span> geom_point(size<span class="op">=</span><span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb18-6"><a href="statistical-process-control-in-python.html#cb18-6" tabindex="-1"></a>  labs(x<span class="op">=</span><span class="st">&#39;Time (Subgroup)&#39;</span>, y<span class="op">=</span><span class="st">&#39;Moving Range&#39;</span>, subtitle<span class="op">=</span><span class="st">&#39;Moving Range Chart&#39;</span>))</span>
<span id="cb18-7"><a href="statistical-process-control-in-python.html#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="statistical-process-control-in-python.html#cb18-8" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb18-9"><a href="statistical-process-control-in-python.html#cb18-9" tabindex="-1"></a>mr_chart.save(<span class="st">&#39;images/05_moving_range_chart.png&#39;</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">6</span>, dpi<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="images/05_moving_range_chart.png" width="100%" /></p>
<p>The moving range chart shows:</p>
<ul>
<li><strong>Center line</strong>: The average moving range (mrbar)</li>
<li><strong>Upper control limit</strong>: Based on the estimated process standard deviation</li>
<li><strong>Lower control limit</strong>: Set to 0 (moving ranges can’t be negative)</li>
<li><strong>Individual points</strong>: Each moving range value</li>
</ul>
<p>This chart helps us monitor process variation when we have individual measurements rather than subgroups.</p>
</div>
<div id="conclusion" class="section level2 unnumbered hasAnchor">
<h2>Conclusion<a href="statistical-process-control-in-python.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You’ve successfully produced SPC visuals and statistics in Python: process overviews, subgroup statistics, and moving range logic. These tools help us understand process behavior, identify when processes are in or out of control, and make data-driven decisions about process improvement.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>

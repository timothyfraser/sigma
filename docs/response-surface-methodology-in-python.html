<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>29 Response Surface Methodology in Python | System Reliability and Six Sigma in R and Python</title>
  <meta name="description" content="Your online textbook for learning reliability and six sigma techniques in R and Python! Made for Cornell University Course SYSEN 5300." />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="29 Response Surface Methodology in Python | System Reliability and Six Sigma in R and Python" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Your online textbook for learning reliability and six sigma techniques in R and Python! Made for Cornell University Course SYSEN 5300." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="29 Response Surface Methodology in Python | System Reliability and Six Sigma in R and Python" />
  
  <meta name="twitter:description" content="Your online textbook for learning reliability and six sigma techniques in R and Python! Made for Cornell University Course SYSEN 5300." />
  

<meta name="author" content="Timothy Fraser, PhD" />


<meta name="date" content="2025-12-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="conclusion-22.html"/>
<link rel="next" href="appendix-ggplot-tips.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="assets/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="assets/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="assets/d3-3.3.8/d3.min.js"></script>
<script src="assets/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="assets/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="assets/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="assets/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="assets/chromatography-0.1/chromatography.js"></script>
<script src="assets/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script>
<script src="assets/bslib-component-js-0.9.0/components.min.js"></script>
<script src="assets/bslib-component-js-0.9.0/web-components.min.js" type="module"></script>
<link href="assets/bslib-component-css-0.9.0/components.css" rel="stylesheet" />
<script src="assets/bslib-tag-require-0.9.0/tag-require.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="about-this-book.html"><a href="about-this-book.html"><i class="fa fa-check"></i><b>1</b> About this Book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="about-this-book.html"><a href="about-this-book.html#what-youll-learn"><i class="fa fa-check"></i><b>1.1</b> What You’ll Learn</a></li>
<li class="chapter" data-level="1.2" data-path="about-this-book.html"><a href="about-this-book.html#learning-approach"><i class="fa fa-check"></i><b>1.2</b> Learning Approach</a></li>
<li class="chapter" data-level="1.3" data-path="about-this-book.html"><a href="about-this-book.html#prerequisites"><i class="fa fa-check"></i><b>1.3</b> Prerequisites</a></li>
<li class="chapter" data-level="1.4" data-path="about-this-book.html"><a href="about-this-book.html#about-the-author"><i class="fa fa-check"></i><b>1.4</b> About the Author</a></li>
<li class="chapter" data-level="1.5" data-path="about-this-book.html"><a href="about-this-book.html#acknowledgments"><i class="fa fa-check"></i><b>1.5</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.6" data-path="about-this-book.html"><a href="about-this-book.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.6</b> How to Use This Book</a></li>
</ul></li>
<li class="part"><span><b>I Failure Mode and Effects Analysis</b></span></li>
<li class="chapter" data-level="2" data-path="coding-in-r.html"><a href="coding-in-r.html"><i class="fa fa-check"></i><b>2</b> Coding in R</a>
<ul>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#getting-started"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#making-an-posit.cloud-account"><i class="fa fa-check"></i>Making an Posit.Cloud account</a></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#using-r-for-the-first-time"><i class="fa fa-check"></i>Using R for the First Time</a></li>
</ul></li>
<li class="chapter" data-level="2.1" data-path="coding-in-r.html"><a href="coding-in-r.html#introduction-to-r"><i class="fa fa-check"></i><b>2.1</b> Introduction to <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="coding-in-r.html"><a href="coding-in-r.html#basic-calculations-in-r"><i class="fa fa-check"></i><b>2.2</b> Basic Calculations in R</a></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#learning-check-1"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="2.3" data-path="coding-in-r.html"><a href="coding-in-r.html#types-of-values-in-r"><i class="fa fa-check"></i><b>2.3</b> Types of Values in R</a></li>
<li class="chapter" data-level="2.4" data-path="coding-in-r.html"><a href="coding-in-r.html#types-of-data-in-r"><i class="fa fa-check"></i><b>2.4</b> Types of Data in R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="coding-in-r.html"><a href="coding-in-r.html#values"><i class="fa fa-check"></i><b>2.4.1</b> Values</a></li>
<li class="chapter" data-level="2.4.2" data-path="coding-in-r.html"><a href="coding-in-r.html#vectors"><i class="fa fa-check"></i><b>2.4.2</b> Vectors</a></li>
<li class="chapter" data-level="2.4.3" data-path="coding-in-r.html"><a href="coding-in-r.html#dataframes"><i class="fa fa-check"></i><b>2.4.3</b> Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#learning-check-2"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="2.5" data-path="coding-in-r.html"><a href="coding-in-r.html#common-functions-in-r"><i class="fa fa-check"></i><b>2.5</b> Common Functions in R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="coding-in-r.html"><a href="coding-in-r.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>2.5.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="2.5.2" data-path="coding-in-r.html"><a href="coding-in-r.html#measures-of-dispersion"><i class="fa fa-check"></i><b>2.5.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="2.5.3" data-path="coding-in-r.html"><a href="coding-in-r.html#other-good-functions"><i class="fa fa-check"></i><b>2.5.3</b> Other Good Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="coding-in-r.html"><a href="coding-in-r.html#missing-data"><i class="fa fa-check"></i><b>2.6</b> Missing Data</a></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#learning-check-3"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="2.7" data-path="coding-in-r.html"><a href="coding-in-r.html#packages"><i class="fa fa-check"></i><b>2.7</b> Packages</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="coding-in-r.html"><a href="coding-in-r.html#using-packages"><i class="fa fa-check"></i><b>2.7.1</b> Using Packages</a></li>
<li class="chapter" data-level="2.7.2" data-path="coding-in-r.html"><a href="coding-in-r.html#installing-packages"><i class="fa fa-check"></i><b>2.7.2</b> Installing Packages</a></li>
<li class="chapter" data-level="2.7.3" data-path="coding-in-r.html"><a href="coding-in-r.html#loading-packages"><i class="fa fa-check"></i><b>2.7.3</b> Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#the-pipeline"><i class="fa fa-check"></i>The Pipeline</a></li>
<li class="chapter" data-level="2.8" data-path="coding-in-r.html"><a href="coding-in-r.html#visualizing-data-with-histograms"><i class="fa fa-check"></i><b>2.8</b> Visualizing Data with Histograms</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="coding-in-r.html"><a href="coding-in-r.html#hist"><i class="fa fa-check"></i><b>2.8.1</b> <code>hist()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#learning-check-4"><i class="fa fa-check"></i>Learning Check 4</a>
<ul>
<li class="chapter" data-level="2.8.2" data-path="coding-in-r.html"><a href="coding-in-r.html#geom_histogram-in-ggplot2"><i class="fa fa-check"></i><b>2.8.2</b> <code>geom_histogram()</code> in <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#learning-check-5"><i class="fa fa-check"></i>Learning Check 5</a></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#conclusion"><i class="fa fa-check"></i>Conclusion</a>
<ul>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#next-steps"><i class="fa fa-check"></i>Next Steps</a></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#advice"><i class="fa fa-check"></i>Advice</a></li>
<li class="chapter" data-level="" data-path="coding-in-r.html"><a href="coding-in-r.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="coding-in-python.html"><a href="coding-in-python.html"><i class="fa fa-check"></i><b>3</b> Coding in Python</a>
<ul>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#getting-started-1"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#making-a-posit-cloud-account"><i class="fa fa-check"></i>Making a Posit Cloud account</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#using-python-for-the-first-time"><i class="fa fa-check"></i>Using Python for the First Time</a></li>
</ul></li>
<li class="chapter" data-level="3.1" data-path="coding-in-python.html"><a href="coding-in-python.html#introduction-to-python"><i class="fa fa-check"></i><b>3.1</b> Introduction to <code>Python</code></a></li>
<li class="chapter" data-level="3.2" data-path="coding-in-python.html"><a href="coding-in-python.html#basic-calculations-in-python"><i class="fa fa-check"></i><b>3.2</b> Basic Calculations in Python</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#learning-check-1-1"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="3.3" data-path="coding-in-python.html"><a href="coding-in-python.html#types-of-values-in-python"><i class="fa fa-check"></i><b>3.3</b> Types of Values in Python</a></li>
<li class="chapter" data-level="3.4" data-path="coding-in-python.html"><a href="coding-in-python.html#types-of-data-in-python"><i class="fa fa-check"></i><b>3.4</b> Types of Data in Python</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="coding-in-python.html"><a href="coding-in-python.html#values-and-variables"><i class="fa fa-check"></i><b>3.4.1</b> Values and Variables</a></li>
<li class="chapter" data-level="3.4.2" data-path="coding-in-python.html"><a href="coding-in-python.html#lists-like-r-vectors"><i class="fa fa-check"></i><b>3.4.2</b> Lists (like R vectors)</a></li>
<li class="chapter" data-level="3.4.3" data-path="coding-in-python.html"><a href="coding-in-python.html#dataframes-with-pandas"><i class="fa fa-check"></i><b>3.4.3</b> DataFrames with pandas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#learning-check-2-1"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="3.5" data-path="coding-in-python.html"><a href="coding-in-python.html#common-functions-in-python"><i class="fa fa-check"></i><b>3.5</b> Common Functions in Python</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="coding-in-python.html"><a href="coding-in-python.html#measures-of-central-tendency-1"><i class="fa fa-check"></i><b>3.5.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="3.5.2" data-path="coding-in-python.html"><a href="coding-in-python.html#measures-of-dispersion-1"><i class="fa fa-check"></i><b>3.5.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="3.5.3" data-path="coding-in-python.html"><a href="coding-in-python.html#other-good-functions-1"><i class="fa fa-check"></i><b>3.5.3</b> Other Good Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="coding-in-python.html"><a href="coding-in-python.html#missing-data-1"><i class="fa fa-check"></i><b>3.6</b> Missing Data</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#learning-check-3-1"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="3.7" data-path="coding-in-python.html"><a href="coding-in-python.html#packages-1"><i class="fa fa-check"></i><b>3.7</b> Packages</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="coding-in-python.html"><a href="coding-in-python.html#installing-packages-1"><i class="fa fa-check"></i><b>3.7.1</b> Installing packages</a></li>
<li class="chapter" data-level="3.7.2" data-path="coding-in-python.html"><a href="coding-in-python.html#importing-packages"><i class="fa fa-check"></i><b>3.7.2</b> Importing packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#the-pipeline-1"><i class="fa fa-check"></i>The Pipeline</a></li>
<li class="chapter" data-level="3.8" data-path="coding-in-python.html"><a href="coding-in-python.html#visualizing-data-with-histograms-1"><i class="fa fa-check"></i><b>3.8</b> Visualizing Data with Histograms</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="coding-in-python.html"><a href="coding-in-python.html#pandasmatplotlib"><i class="fa fa-check"></i><b>3.8.1</b> pandas/matplotlib</a></li>
<li class="chapter" data-level="3.8.2" data-path="coding-in-python.html"><a href="coding-in-python.html#geom_histogram-in-plotnine"><i class="fa fa-check"></i><b>3.8.2</b> <code>geom_histogram()</code> in <code>plotnine</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#learning-check-4-1"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#learning-check-5-1"><i class="fa fa-check"></i>Learning Check 5</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#conclusion-1"><i class="fa fa-check"></i>Conclusion</a>
<ul>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#next-steps-1"><i class="fa fa-check"></i>Next Steps</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#advice-1"><i class="fa fa-check"></i>Advice</a></li>
<li class="chapter" data-level="" data-path="coding-in-python.html"><a href="coding-in-python.html#troubleshooting-1"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fmea-in-r.html"><a href="fmea-in-r.html"><i class="fa fa-check"></i><b>4</b> FMEA in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="fmea-in-r.html"><a href="fmea-in-r.html#getting-started-2"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="fmea-in-r.html"><a href="fmea-in-r.html#load-packages"><i class="fa fa-check"></i>Load Packages</a></li>
</ul></li>
<li class="chapter" data-level="4.1" data-path="fmea-in-r.html"><a href="fmea-in-r.html#example-ben-and-jerrys-ice-cream"><i class="fa fa-check"></i><b>4.1</b> Example: Ben and Jerry’s Ice Cream</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="fmea-in-r.html"><a href="fmea-in-r.html#scope-resolution"><i class="fa fa-check"></i><b>4.1.1</b> Scope &amp; Resolution</a></li>
<li class="chapter" data-level="4.1.2" data-path="fmea-in-r.html"><a href="fmea-in-r.html#measuring-criticality"><i class="fa fa-check"></i><b>4.1.2</b> Measuring Criticality</a></li>
<li class="chapter" data-level="4.1.3" data-path="fmea-in-r.html"><a href="fmea-in-r.html#block-diagram"><i class="fa fa-check"></i><b>4.1.3</b> Block Diagram</a></li>
<li class="chapter" data-level="4.1.4" data-path="fmea-in-r.html"><a href="fmea-in-r.html#failure-modes"><i class="fa fa-check"></i><b>4.1.4</b> Failure Modes</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="fmea-in-r.html"><a href="fmea-in-r.html#calculating-criticality"><i class="fa fa-check"></i><b>4.2</b> Calculating Criticality</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="fmea-in-r.html"><a href="fmea-in-r.html#estimate-severity"><i class="fa fa-check"></i><b>4.2.1</b> Estimate Severity</a></li>
<li class="chapter" data-level="4.2.2" data-path="fmea-in-r.html"><a href="fmea-in-r.html#estimate-occurrence"><i class="fa fa-check"></i><b>4.2.2</b> Estimate Occurrence</a></li>
<li class="chapter" data-level="4.2.3" data-path="fmea-in-r.html"><a href="fmea-in-r.html#estimate-detection"><i class="fa fa-check"></i><b>4.2.3</b> Estimate Detection</a></li>
<li class="chapter" data-level="4.2.4" data-path="fmea-in-r.html"><a href="fmea-in-r.html#estimate-criticality-rpn"><i class="fa fa-check"></i><b>4.2.4</b> Estimate Criticality (RPN)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fmea-in-r.html"><a href="fmea-in-r.html#learning-check-1-2"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="" data-path="fmea-in-r.html"><a href="fmea-in-r.html#conclusion-2"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html"><i class="fa fa-check"></i><b>5</b> Visualization with <code>ggplot</code> in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#getting-started-3"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#loading-packages-1"><i class="fa fa-check"></i>Loading Packages</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#gapminder-data"><i class="fa fa-check"></i>Gapminder data</a></li>
</ul></li>
<li class="chapter" data-level="5.1" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#your-first-scatterplot"><i class="fa fa-check"></i><b>5.1</b> Your first scatterplot</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-1-3"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-2-2"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-3-2"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="5.2" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#improving-our-visualizations"><i class="fa fa-check"></i><b>5.2</b> Improving our Visualizations</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-4-2"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-5-2"><i class="fa fa-check"></i>Learning Check 5</a></li>
<li class="chapter" data-level="5.3" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#visualizing-diamonds-data"><i class="fa fa-check"></i><b>5.3</b> Visualizing <code>diamonds</code> data</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-6"><i class="fa fa-check"></i>Learning Check 6</a></li>
<li class="chapter" data-level="5.4" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#visualizing-distributions"><i class="fa fa-check"></i><b>5.4</b> Visualizing Distributions</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#learning-check-9"><i class="fa fa-check"></i>Learning Check 9</a></li>
<li class="chapter" data-level="" data-path="visualization-with-ggplot-in-r.html"><a href="visualization-with-ggplot-in-r.html#conclusion-3"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html"><i class="fa fa-check"></i><b>6</b> Visualization with <code>plotnine</code> in <code>Python</code></a>
<ul>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#getting-started-4"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#loading-packages-2"><i class="fa fa-check"></i>Loading Packages</a></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#gapminder-data-1"><i class="fa fa-check"></i>Gapminder data</a></li>
</ul></li>
<li class="chapter" data-level="6.1" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#your-first-scatterplot-1"><i class="fa fa-check"></i><b>6.1</b> Your first scatterplot</a></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#learning-check-1-4"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="6.2" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#transparency-alpha"><i class="fa fa-check"></i><b>6.2</b> Transparency (alpha)</a></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#learning-check-2-3"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="6.3" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#color-constant-vs-mapped"><i class="fa fa-check"></i><b>6.3</b> Color: constant vs mapped</a></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#learning-check-3-3"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="6.4" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#improving-our-visualizations-1"><i class="fa fa-check"></i><b>6.4</b> Improving our visualizations</a></li>
<li class="chapter" data-level="6.5" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#visualizing-diamonds-data-1"><i class="fa fa-check"></i><b>6.5</b> Visualizing <code>diamonds</code> data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#boxplots-by-cut"><i class="fa fa-check"></i><b>6.5.1</b> Boxplots by cut</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#learning-check-4-3"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="6.6" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#visualizing-distributions-1"><i class="fa fa-check"></i><b>6.6</b> Visualizing Distributions</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#try-adjusting-binwidth-and-theme"><i class="fa fa-check"></i><b>6.6.1</b> Try adjusting binwidth and theme</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#learning-check-5-3"><i class="fa fa-check"></i>Learning Check 5</a></li>
<li class="chapter" data-level="" data-path="visualization-with-plotnine-in-python.html"><a href="visualization-with-plotnine-in-python.html#conclusion-4"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="part"><span><b>II Statistics &amp; Reliability</b></span></li>
<li class="chapter" data-level="7" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html"><i class="fa fa-check"></i><b>7</b> Distributions and Descriptive Statistics in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#getting-started-5"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#load-packages-1"><i class="fa fa-check"></i>Load Packages</a></li>
</ul></li>
<li class="chapter" data-level="7.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#distributions"><i class="fa fa-check"></i><b>7.1</b> Distributions</a></li>
<li class="chapter" data-level="7.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#descriptive-statistics"><i class="fa fa-check"></i><b>7.2</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#whats-a-statistic"><i class="fa fa-check"></i><b>7.2.1</b> What’s a statistic?</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#our-data"><i class="fa fa-check"></i><b>7.3</b> Our Data</a></li>
<li class="chapter" data-level="7.4" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#size"><i class="fa fa-check"></i><b>7.4</b> Size</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#length"><i class="fa fa-check"></i><b>7.4.1</b> Length</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#location"><i class="fa fa-check"></i><b>7.5</b> Location</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#mean"><i class="fa fa-check"></i><b>7.5.1</b> Mean</a></li>
<li class="chapter" data-level="7.5.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#median"><i class="fa fa-check"></i><b>7.5.2</b> Median</a></li>
<li class="chapter" data-level="7.5.3" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#mode"><i class="fa fa-check"></i><b>7.5.3</b> Mode</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#spread-1"><i class="fa fa-check"></i><b>7.6</b> Spread (1)</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#percentile"><i class="fa fa-check"></i><b>7.6.1</b> Percentile</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#learning-check-1-5"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="7.7" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#spread-2"><i class="fa fa-check"></i><b>7.7</b> Spread (2)</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#standard-deviation"><i class="fa fa-check"></i><b>7.7.1</b> Standard Deviation</a></li>
<li class="chapter" data-level="7.7.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#variance"><i class="fa fa-check"></i><b>7.7.2</b> Variance</a></li>
<li class="chapter" data-level="7.7.3" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#coefficient-of-variation-cv"><i class="fa fa-check"></i><b>7.7.3</b> Coefficient of Variation (CV)</a></li>
<li class="chapter" data-level="7.7.4" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#standard-error-se"><i class="fa fa-check"></i><b>7.7.4</b> Standard Error (SE)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#learning-check-2-4"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="7.8" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#shape"><i class="fa fa-check"></i><b>7.8</b> Shape</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#skewness"><i class="fa fa-check"></i><b>7.8.1</b> Skewness</a></li>
<li class="chapter" data-level="7.8.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#kurtosis"><i class="fa fa-check"></i><b>7.8.2</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#learning-check-3-4"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="7.9" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#simulating-distributions"><i class="fa fa-check"></i><b>7.9</b> Simulating Distributions</a></li>
<li class="chapter" data-level="7.10" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#finding-parameters-for-your-distribution"><i class="fa fa-check"></i><b>7.10</b> Finding Parameters for your Distribution</a></li>
<li class="chapter" data-level="7.11" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#common-distributions"><i class="fa fa-check"></i><b>7.11</b> Common Distributions</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#normal-distribution"><i class="fa fa-check"></i><b>7.11.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="7.11.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#poisson-distribution"><i class="fa fa-check"></i><b>7.11.2</b> Poisson Distribution</a></li>
<li class="chapter" data-level="7.11.3" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#exponential-distribution"><i class="fa fa-check"></i><b>7.11.3</b> Exponential Distribution</a></li>
<li class="chapter" data-level="7.11.4" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#gamma-distribution"><i class="fa fa-check"></i><b>7.11.4</b> Gamma Distribution</a></li>
<li class="chapter" data-level="7.11.5" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#weibull-distribution"><i class="fa fa-check"></i><b>7.11.5</b> Weibull Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#special-distributions"><i class="fa fa-check"></i><b>7.12</b> Special Distributions</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#binomial-distribution"><i class="fa fa-check"></i><b>7.12.1</b> Binomial Distribution</a></li>
<li class="chapter" data-level="7.12.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#uniform-distribution"><i class="fa fa-check"></i><b>7.12.2</b> Uniform Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#comparing-distributions"><i class="fa fa-check"></i><b>7.13</b> Comparing Distributions</a></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#learning-check-4-4"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#conclusion-5"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#getting-started-6"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#install-and-import-packages"><i class="fa fa-check"></i>Install and Import Packages</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#our-data-1"><i class="fa fa-check"></i><b>7.14</b> Our Data</a></li>
<li class="chapter" data-level="7.15" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#size-1"><i class="fa fa-check"></i><b>7.15</b> Size</a>
<ul>
<li class="chapter" data-level="7.15.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#length-1"><i class="fa fa-check"></i><b>7.15.1</b> Length</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#location-1"><i class="fa fa-check"></i><b>7.16</b> Location</a>
<ul>
<li class="chapter" data-level="7.16.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#mean-and-median"><i class="fa fa-check"></i><b>7.16.1</b> Mean and Median</a></li>
<li class="chapter" data-level="7.16.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#mode-1"><i class="fa fa-check"></i><b>7.16.2</b> Mode</a></li>
</ul></li>
<li class="chapter" data-level="7.17" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#spread-1-1"><i class="fa fa-check"></i><b>7.17</b> Spread (1)</a>
<ul>
<li class="chapter" data-level="7.17.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#percentiles"><i class="fa fa-check"></i><b>7.17.1</b> Percentiles</a></li>
</ul></li>
<li class="chapter" data-level="7.18" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#spread-2-1"><i class="fa fa-check"></i><b>7.18</b> Spread (2)</a>
<ul>
<li class="chapter" data-level="7.18.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#standard-deviation-variance-cv-se"><i class="fa fa-check"></i><b>7.18.1</b> Standard Deviation, Variance, CV, SE</a></li>
</ul></li>
<li class="chapter" data-level="7.19" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#shape-1"><i class="fa fa-check"></i><b>7.19</b> Shape</a>
<ul>
<li class="chapter" data-level="7.19.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#skewness-and-kurtosis"><i class="fa fa-check"></i><b>7.19.1</b> Skewness and Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="7.20" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#finding-parameters-for-your-distributions"><i class="fa fa-check"></i><b>7.20</b> Finding Parameters for Your Distributions</a></li>
<li class="chapter" data-level="7.21" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#common-distributions-1"><i class="fa fa-check"></i><b>7.21</b> Common Distributions</a>
<ul>
<li class="chapter" data-level="7.21.1" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#normal"><i class="fa fa-check"></i><b>7.21.1</b> Normal</a></li>
<li class="chapter" data-level="7.21.2" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#poisson"><i class="fa fa-check"></i><b>7.21.2</b> Poisson</a></li>
<li class="chapter" data-level="7.21.3" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#exponential"><i class="fa fa-check"></i><b>7.21.3</b> Exponential</a></li>
<li class="chapter" data-level="7.21.4" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#gamma"><i class="fa fa-check"></i><b>7.21.4</b> Gamma</a></li>
<li class="chapter" data-level="7.21.5" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#weibull"><i class="fa fa-check"></i><b>7.21.5</b> Weibull</a></li>
</ul></li>
<li class="chapter" data-level="7.22" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#comparing-distributions-1"><i class="fa fa-check"></i><b>7.22</b> Comparing Distributions</a></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#learning-check-1-6"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="" data-path="distributions-and-descriptive-statistics-in-r.html"><a href="distributions-and-descriptive-statistics-in-r.html#conclusion-6"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functions-in-r.html"><a href="functions-in-r.html"><i class="fa fa-check"></i><b>8</b> Functions in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="functions-in-r.html"><a href="functions-in-r.html#getting-started-7"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="functions-in-r.html"><a href="functions-in-r.html#packages-2"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="chapter" data-level="8.1" data-path="functions-in-r.html"><a href="functions-in-r.html#coding-your-own-function"><i class="fa fa-check"></i><b>8.1</b> Coding your own function!</a></li>
<li class="chapter" data-level="8.2" data-path="functions-in-r.html"><a href="functions-in-r.html#functions-with-default-inputs"><i class="fa fa-check"></i><b>8.2</b> Functions with Default Inputs</a></li>
<li class="chapter" data-level="" data-path="functions-in-r.html"><a href="functions-in-r.html#conclusion-7"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functions-in-python.html"><a href="functions-in-python.html"><i class="fa fa-check"></i><b>9</b> Functions in <code>Python</code></a>
<ul>
<li class="chapter" data-level="" data-path="functions-in-python.html"><a href="functions-in-python.html#getting-started-8"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="functions-in-python.html"><a href="functions-in-python.html#packages-3"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="chapter" data-level="9.1" data-path="functions-in-python.html"><a href="functions-in-python.html#coding-your-own-function-1"><i class="fa fa-check"></i><b>9.1</b> Coding your own function!</a></li>
<li class="chapter" data-level="9.2" data-path="functions-in-python.html"><a href="functions-in-python.html#functions-with-default-inputs-1"><i class="fa fa-check"></i><b>9.2</b> Functions with Default Inputs</a></li>
<li class="chapter" data-level="" data-path="functions-in-python.html"><a href="functions-in-python.html#conclusion-8"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="probability-in-r.html"><a href="probability-in-r.html"><i class="fa fa-check"></i><b>10</b> Probability in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="probability-in-r.html"><a href="probability-in-r.html#getting-started-9"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="probability-in-r.html"><a href="probability-in-r.html#load-packages-2"><i class="fa fa-check"></i>Load Packages</a></li>
</ul></li>
<li class="chapter" data-level="10.1" data-path="probability-in-r.html"><a href="probability-in-r.html#key-functions"><i class="fa fa-check"></i><b>10.1</b> Key Functions</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="probability-in-r.html"><a href="probability-in-r.html#bind_rows"><i class="fa fa-check"></i><b>10.1.1</b> <code>bind_rows()</code></a></li>
<li class="chapter" data-level="10.1.2" data-path="probability-in-r.html"><a href="probability-in-r.html#mutate"><i class="fa fa-check"></i><b>10.1.2</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="probability-in-r.html"><a href="probability-in-r.html#summarize"><i class="fa fa-check"></i><b>10.1.3</b> <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="probability-in-r.html"><a href="probability-in-r.html#probability"><i class="fa fa-check"></i><b>10.2</b> Probability</a></li>
<li class="chapter" data-level="10.3" data-path="probability-in-r.html"><a href="probability-in-r.html#conditional-probability"><i class="fa fa-check"></i><b>10.3</b> Conditional Probability</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="probability-in-r.html"><a href="probability-in-r.html#example-twizzlers"><i class="fa fa-check"></i><b>10.3.1</b> Example: Twizzlers</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="probability-in-r.html"><a href="probability-in-r.html#total-probabilities"><i class="fa fa-check"></i><b>10.4</b> Total Probabilities</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="probability-in-r.html"><a href="probability-in-r.html#example-marbles"><i class="fa fa-check"></i><b>10.4.1</b> Example: Marbles!</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="probability-in-r.html"><a href="probability-in-r.html#bayes-rule"><i class="fa fa-check"></i><b>10.5</b> Bayes Rule</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="probability-in-r.html"><a href="probability-in-r.html#example-coffee-shop-incomplete-information"><i class="fa fa-check"></i><b>10.5.1</b> Example: Coffee Shop (Incomplete Information)</a></li>
<li class="chapter" data-level="10.5.2" data-path="probability-in-r.html"><a href="probability-in-r.html#example-coffee-shop-complete-information"><i class="fa fa-check"></i><b>10.5.2</b> Example: Coffee Shop (Complete Information)</a></li>
<li class="chapter" data-level="10.5.3" data-path="probability-in-r.html"><a href="probability-in-r.html#example-movie-theatre-popularity"><i class="fa fa-check"></i><b>10.5.3</b> Example: Movie Theatre Popularity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probability-in-r.html"><a href="probability-in-r.html#conclusion-9"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html"><i class="fa fa-check"></i><b>11</b> Probability Functions in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#getting-started-10"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#load-packages-3"><i class="fa fa-check"></i>Load Packages</a></li>
</ul></li>
<li class="chapter" data-level="11.1" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#probability-functions"><i class="fa fa-check"></i><b>11.1</b> Probability Functions</a></li>
<li class="chapter" data-level="11.2" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#hypothetical-probability-functions"><i class="fa fa-check"></i><b>11.2</b> Hypothetical Probability Functions</a>
<ul>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#example-farmers-market"><i class="fa fa-check"></i>Example: Farmers Market</a></li>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#unobserved-distributions"><i class="fa fa-check"></i>Unobserved Distributions</a></li>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#using-hypothetical-probability-functions"><i class="fa fa-check"></i>Using Hypothetical Probability Functions</a></li>
<li class="chapter" data-level="11.2.1" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#density-pdf"><i class="fa fa-check"></i><b>11.2.1</b> Density (PDF)</a></li>
<li class="chapter" data-level="11.2.2" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#cumulative-probabilities-cdf"><i class="fa fa-check"></i><b>11.2.2</b> Cumulative Probabilities (CDF)</a></li>
<li class="chapter" data-level="11.2.3" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#quantiles"><i class="fa fa-check"></i><b>11.2.3</b> Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#learning-check-1-7"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="11.3" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#observed-probability-functions"><i class="fa fa-check"></i><b>11.3</b> Observed Probability Functions</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#example-observed-distributions"><i class="fa fa-check"></i><b>11.3.1</b> Example: Observed Distributions</a></li>
<li class="chapter" data-level="11.3.2" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#observed-pdfs-probability-density-functions"><i class="fa fa-check"></i><b>11.3.2</b> Observed PDFs (Probability Density Functions)</a></li>
<li class="chapter" data-level="11.3.3" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#density"><i class="fa fa-check"></i><b>11.3.3</b> <code>density()</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#using-pdfs-probability-density-functions"><i class="fa fa-check"></i><b>11.3.4</b> Using PDFs (Probability Density Functions)</a></li>
<li class="chapter" data-level="11.3.5" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#observed-cdfs-cumulative-distribution-functions"><i class="fa fa-check"></i><b>11.3.5</b> Observed CDFs (Cumulative Distribution Functions)</a></li>
<li class="chapter" data-level="11.3.6" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#using-calculus"><i class="fa fa-check"></i><b>11.3.6</b> Using Calculus!</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#learning-check-2-5"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="" data-path="probability-functions-in-r.html"><a href="probability-functions-in-r.html#conclusion-10"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="system-reliability.html"><a href="system-reliability.html"><i class="fa fa-check"></i><b>12</b> System Reliability</a>
<ul>
<li class="chapter" data-level="" data-path="system-reliability.html"><a href="system-reliability.html#getting-started-11"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="system-reliability.html"><a href="system-reliability.html#packages-4"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="chapter" data-level="12.1" data-path="system-reliability.html"><a href="system-reliability.html#concepts"><i class="fa fa-check"></i><b>12.1</b> Concepts</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="system-reliability.html"><a href="system-reliability.html#life-distributions"><i class="fa fa-check"></i><b>12.1.1</b> Life Distributions</a></li>
<li class="chapter" data-level="12.1.2" data-path="system-reliability.html"><a href="system-reliability.html#example-airplane-propeller-failure"><i class="fa fa-check"></i><b>12.1.2</b> Example: Airplane Propeller Failure!</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="system-reliability.html"><a href="system-reliability.html#learning-check-1-8"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="12.2" data-path="system-reliability.html"><a href="system-reliability.html#joint-probabilities"><i class="fa fa-check"></i><b>12.2</b> Joint Probabilities</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="system-reliability.html"><a href="system-reliability.html#multiplication-rule"><i class="fa fa-check"></i><b>12.2.1</b> Multiplication Rule</a></li>
<li class="chapter" data-level="12.2.2" data-path="system-reliability.html"><a href="system-reliability.html#compliment-rule"><i class="fa fa-check"></i><b>12.2.2</b> Compliment Rule</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="system-reliability.html"><a href="system-reliability.html#table-of-failure-related-functions"><i class="fa fa-check"></i><b>12.3</b> Table of Failure-Related Functions</a></li>
<li class="chapter" data-level="12.4" data-path="system-reliability.html"><a href="system-reliability.html#hazard-rate-function"><i class="fa fa-check"></i><b>12.4</b> Hazard Rate Function</a></li>
<li class="chapter" data-level="12.5" data-path="system-reliability.html"><a href="system-reliability.html#accumulative-hazard-function"><i class="fa fa-check"></i><b>12.5</b> Accumulative Hazard Function</a></li>
<li class="chapter" data-level="12.6" data-path="system-reliability.html"><a href="system-reliability.html#average-failure-rate"><i class="fa fa-check"></i><b>12.6</b> Average Failure Rate</a></li>
<li class="chapter" data-level="12.7" data-path="system-reliability.html"><a href="system-reliability.html#units"><i class="fa fa-check"></i><b>12.7</b> Units</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="system-reliability.html"><a href="system-reliability.html#failure-functions"><i class="fa fa-check"></i><b>12.7.1</b> Failure Functions</a></li>
<li class="chapter" data-level="12.7.2" data-path="system-reliability.html"><a href="system-reliability.html#conversion-functions"><i class="fa fa-check"></i><b>12.7.2</b> Conversion Functions</a></li>
<li class="chapter" data-level="12.7.3" data-path="system-reliability.html"><a href="system-reliability.html#converting-estimates"><i class="fa fa-check"></i><b>12.7.3</b> Converting Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="system-reliability.html"><a href="system-reliability.html#learning-check-2-6"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="12.8" data-path="system-reliability.html"><a href="system-reliability.html#system-reliability-1"><i class="fa fa-check"></i><b>12.8</b> System Reliability</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="system-reliability.html"><a href="system-reliability.html#series-systems"><i class="fa fa-check"></i><b>12.8.1</b> Series Systems</a></li>
<li class="chapter" data-level="12.8.2" data-path="system-reliability.html"><a href="system-reliability.html#parallel-systems"><i class="fa fa-check"></i><b>12.8.2</b> Parallel Systems</a></li>
<li class="chapter" data-level="12.8.3" data-path="system-reliability.html"><a href="system-reliability.html#combined-systems"><i class="fa fa-check"></i><b>12.8.3</b> Combined Systems</a></li>
<li class="chapter" data-level="12.8.4" data-path="system-reliability.html"><a href="system-reliability.html#example-business-reliability"><i class="fa fa-check"></i><b>12.8.4</b> Example: Business Reliability</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="system-reliability.html"><a href="system-reliability.html#renewal-rates-via-bayes-rule"><i class="fa fa-check"></i><b>12.9</b> Renewal Rates via Bayes Rule</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html"><i class="fa fa-check"></i><b>13</b> System Reliability in <code>Python</code></a>
<ul>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#getting-started-12"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#packages-5"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#custom-functions"><i class="fa fa-check"></i>Custom Functions</a></li>
</ul></li>
<li class="chapter" data-level="13.1" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#concepts-1"><i class="fa fa-check"></i><b>13.1</b> Concepts</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#life-distributions-1"><i class="fa fa-check"></i><b>13.1.1</b> Life Distributions</a></li>
<li class="chapter" data-level="13.1.2" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#example-airplane-propeller-failure-1"><i class="fa fa-check"></i><b>13.1.2</b> Example: Airplane Propeller Failure!</a></li>
<li class="chapter" data-level="13.1.3" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#joint-probabilities-1"><i class="fa fa-check"></i><b>13.1.3</b> Joint Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#hazard-rate-function-1"><i class="fa fa-check"></i><b>13.2</b> Hazard Rate Function</a></li>
<li class="chapter" data-level="13.3" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#accumulative-hazard-function-1"><i class="fa fa-check"></i><b>13.3</b> Accumulative Hazard Function</a></li>
<li class="chapter" data-level="13.4" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#average-failure-rate-1"><i class="fa fa-check"></i><b>13.4</b> Average Failure Rate</a></li>
<li class="chapter" data-level="13.5" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#units-and-conversions"><i class="fa fa-check"></i><b>13.5</b> Units and Conversions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#failure-functions-1"><i class="fa fa-check"></i><b>13.5.1</b> Failure Functions</a></li>
<li class="chapter" data-level="13.5.2" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#conversion-functions-1"><i class="fa fa-check"></i><b>13.5.2</b> Conversion Functions</a></li>
<li class="chapter" data-level="13.5.3" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#converting-estimates-1"><i class="fa fa-check"></i><b>13.5.3</b> Converting Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#learning-check-1-9"><i class="fa fa-check"></i>Learning Check 1</a>
<ul>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#exploding-phones"><i class="fa fa-check"></i>📱💥Exploding Phones!</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#units-and-conversions-1"><i class="fa fa-check"></i><b>13.6</b> Units and Conversions</a></li>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#learning-check-2-7"><i class="fa fa-check"></i>Learning Check 2</a>
<ul>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#does-instant-ramen-ever-go-bad"><i class="fa fa-check"></i>🍜 Does Instant Ramen <em>ever</em> go bad?</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#system-reliability-2"><i class="fa fa-check"></i><b>13.7</b> System Reliability</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#series-systems-1"><i class="fa fa-check"></i><b>13.7.1</b> Series Systems</a></li>
<li class="chapter" data-level="13.7.2" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#parallel-systems-1"><i class="fa fa-check"></i><b>13.7.2</b> Parallel Systems</a></li>
<li class="chapter" data-level="13.7.3" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#combined-systems-1"><i class="fa fa-check"></i><b>13.7.3</b> Combined Systems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="system-reliability-in-python.html"><a href="system-reliability-in-python.html#conclusion-11"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="part"><span><b>III Statistical Process Control</b></span></li>
<li class="chapter" data-level="14" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html"><i class="fa fa-check"></i><b>14</b> Statistical Process Control in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#getting-started-13"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#packages-6"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#our-case"><i class="fa fa-check"></i>Our Case</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#our-data-2"><i class="fa fa-check"></i>Our Data</a></li>
</ul></li>
<li class="chapter" data-level="14.1" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#visualizing-quality-control"><i class="fa fa-check"></i><b>14.1</b> Visualizing Quality Control</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#theme_set"><i class="fa fa-check"></i><b>14.1.1</b> <code>theme_set()</code></a></li>
<li class="chapter" data-level="14.1.2" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#process-descriptive-statistics"><i class="fa fa-check"></i><b>14.1.2</b> Process Descriptive Statistics</a></li>
<li class="chapter" data-level="14.1.3" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#process-overview-visual"><i class="fa fa-check"></i><b>14.1.3</b> Process Overview Visual</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#learning-check-1-10"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="14.2" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#average-and-standard-deviation-graphs"><i class="fa fa-check"></i><b>14.2</b> Average and Standard Deviation Graphs</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#key-statistics"><i class="fa fa-check"></i><b>14.2.1</b> Key Statistics</a></li>
<li class="chapter" data-level="14.2.2" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#subgroup-within-group-statistics"><i class="fa fa-check"></i><b>14.2.2</b> Subgroup (Within-Group) Statistics</a></li>
<li class="chapter" data-level="14.2.3" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#total-statistics-between-groups"><i class="fa fa-check"></i><b>14.2.3</b> Total Statistics (Between Groups)</a></li>
<li class="chapter" data-level="14.2.4" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#average-and-standard-deviation-charts"><i class="fa fa-check"></i><b>14.2.4</b> Average and Standard Deviation Charts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#learning-check-2-8"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="14.3" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#moving-range-charts"><i class="fa fa-check"></i><b>14.3</b> Moving Range Charts</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#individual-and-moving-range-charts"><i class="fa fa-check"></i><b>14.3.1</b> Individual and Moving Range Charts</a></li>
<li class="chapter" data-level="14.3.2" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#factors-d_2-and-friends"><i class="fa fa-check"></i><b>14.3.2</b> Factors <span class="math inline">\(d_{2}\)</span> and Friends</a></li>
<li class="chapter" data-level="14.3.3" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#estimating-sigma_short-for-moving-range-statistics"><i class="fa fa-check"></i><b>14.3.3</b> Estimating <span class="math inline">\(\sigma_{short}\)</span> for Moving Range Statistics</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#constants"><i class="fa fa-check"></i><b>14.4</b> Constants</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#find-any-d_x-factor"><i class="fa fa-check"></i><b>14.4.1</b> Find <em>any</em> <span class="math inline">\(d_x\)</span> Factor</a></li>
<li class="chapter" data-level="14.4.2" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#using-d_x-factors"><i class="fa fa-check"></i><b>14.4.2</b> Using <span class="math inline">\(d_x\)</span> factors</a></li>
<li class="chapter" data-level="14.4.3" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#finding-any-b_x-factor."><i class="fa fa-check"></i><b>14.4.3</b> Finding <em>any</em> <span class="math inline">\(b_x\)</span> Factor.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-r.html"><a href="statistical-process-control-in-r.html#learning-check-3-5"><i class="fa fa-check"></i>Learning Check 3</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html"><i class="fa fa-check"></i><b>15</b> Statistical Process Control in <code>Python</code></a>
<ul>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#getting-started-14"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#packages-7"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#custom-functions-1"><i class="fa fa-check"></i>Custom Functions</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#our-case-1"><i class="fa fa-check"></i>Our Case</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#our-data-3"><i class="fa fa-check"></i>Our Data</a></li>
</ul></li>
<li class="chapter" data-level="15.1" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#process-descriptive-statistics-1"><i class="fa fa-check"></i><b>15.1</b> Process Descriptive Statistics</a></li>
<li class="chapter" data-level="15.2" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#process-overview-visual-1"><i class="fa fa-check"></i><b>15.2</b> Process Overview Visual</a></li>
<li class="chapter" data-level="15.3" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#subgroup-within-group-statistics-1"><i class="fa fa-check"></i><b>15.3</b> Subgroup (Within-Group) Statistics</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#total-statistics-between-groups-1"><i class="fa fa-check"></i><b>15.3.1</b> Total Statistics (Between Groups)</a></li>
<li class="chapter" data-level="15.3.2" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#average-and-standard-deviation-charts-1"><i class="fa fa-check"></i><b>15.3.2</b> Average and Standard Deviation Charts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#learning-check-1-11"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="15.4" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#moving-range-charts-n1"><i class="fa fa-check"></i><b>15.4</b> Moving Range Charts (n=1)</a></li>
<li class="chapter" data-level="" data-path="statistical-process-control-in-python.html"><a href="statistical-process-control-in-python.html#conclusion-12"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><i class="fa fa-check"></i><b>16</b> Indices and Confidence Intervals for Statistical Process Control in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#getting-started-15"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#packages-8"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#our-data-4"><i class="fa fa-check"></i>Our Data</a></li>
</ul></li>
<li class="chapter" data-level="16.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#process-capability-vs.-stability"><i class="fa fa-check"></i><b>16.1</b> Process Capability vs. Stability</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#definitions"><i class="fa fa-check"></i><b>16.1.1</b> Definitions</a></li>
<li class="chapter" data-level="16.1.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#table-of-indices"><i class="fa fa-check"></i><b>16.1.2</b> Table of Indices</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#index-functions"><i class="fa fa-check"></i><b>16.2</b> Index Functions</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#capacity-index-c_p"><i class="fa fa-check"></i><b>16.2.1</b> Capacity Index <span class="math inline">\(C_{p}\)</span></a></li>
<li class="chapter" data-level="16.2.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#process-performance-index-p_p"><i class="fa fa-check"></i><b>16.2.2</b> Process Performance Index <span class="math inline">\(P_{p}\)</span></a></li>
<li class="chapter" data-level="16.2.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#capacity-index-c_pk"><i class="fa fa-check"></i><b>16.2.3</b> Capacity Index <span class="math inline">\(C_{pk}\)</span></a></li>
<li class="chapter" data-level="16.2.4" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#process-performance-index-p_pk"><i class="fa fa-check"></i><b>16.2.4</b> Process Performance Index <span class="math inline">\(P_{pk}\)</span></a></li>
<li class="chapter" data-level="16.2.5" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#equality"><i class="fa fa-check"></i><b>16.2.5</b> Equality</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#learning-check-1-12"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="16.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#confidence-intervals"><i class="fa fa-check"></i><b>16.3</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#confidence-intervals-show-us-sampling-distributions"><i class="fa fa-check"></i><b>16.3.1</b> Confidence Intervals show us Sampling Distributions</a></li>
<li class="chapter" data-level="16.3.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#bootstrapped-or-theoretical-sampling-distributions"><i class="fa fa-check"></i><b>16.3.2</b> Bootstrapped or Theoretical Sampling Distributions?</a></li>
<li class="chapter" data-level="16.3.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#confidence-intervals-with-theoretical-sampling-distributions"><i class="fa fa-check"></i><b>16.3.3</b> Confidence Intervals with Theoretical Sampling Distributions</a></li>
<li class="chapter" data-level="16.3.4" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#visualizing-confidence-intervals"><i class="fa fa-check"></i><b>16.3.4</b> Visualizing Confidence Intervals</a></li>
<li class="chapter" data-level="16.3.5" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#bootstrapping-c_p"><i class="fa fa-check"></i><b>16.3.5</b> Bootstrapping <span class="math inline">\(C_{p}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#cis-for-any-index"><i class="fa fa-check"></i><b>16.4</b> CIs for any Index!</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#cis-for-p_p"><i class="fa fa-check"></i><b>16.4.1</b> CIs for <span class="math inline">\(P_p\)</span></a></li>
<li class="chapter" data-level="16.4.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#cis-for-c_pk"><i class="fa fa-check"></i><b>16.4.2</b> CIs for <span class="math inline">\(C_{pk}\)</span></a></li>
<li class="chapter" data-level="16.4.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#cis-for-p_p-1"><i class="fa fa-check"></i><b>16.4.3</b> CIs for <span class="math inline">\(P_p\)</span></a></li>
<li class="chapter" data-level="16.4.4" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#cis-for-p_pk"><i class="fa fa-check"></i><b>16.4.4</b> CIs for <span class="math inline">\(P_{pk}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-r.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-r.html#conclusion-13"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><i class="fa fa-check"></i><b>17</b> Indices and Confidence Intervals for Statistical Process Control in <code>Python</code></a>
<ul>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#getting-started-16"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#packages-9"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#custom-functions-2"><i class="fa fa-check"></i>Custom Functions</a></li>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#our-data-5"><i class="fa fa-check"></i>Our Data</a></li>
<li class="chapter" data-level="17.0.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#process-overview"><i class="fa fa-check"></i><b>17.0.1</b> Process Overview</a></li>
</ul></li>
<li class="chapter" data-level="17.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#process-capability-vs.-stability-1"><i class="fa fa-check"></i><b>17.1</b> Process Capability vs. Stability</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#definitions-1"><i class="fa fa-check"></i><b>17.1.1</b> Definitions</a></li>
<li class="chapter" data-level="17.1.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#table-of-indices-1"><i class="fa fa-check"></i><b>17.1.2</b> Table of Indices</a></li>
<li class="chapter" data-level="17.1.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#index-functions-1"><i class="fa fa-check"></i><b>17.1.3</b> Index Functions</a></li>
<li class="chapter" data-level="17.1.4" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#ingredients"><i class="fa fa-check"></i><b>17.1.4</b> Ingredients</a></li>
<li class="chapter" data-level="17.1.5" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#cp-and-pp"><i class="fa fa-check"></i><b>17.1.5</b> Cp and Pp</a></li>
<li class="chapter" data-level="17.1.6" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#cpk-and-ppk"><i class="fa fa-check"></i><b>17.1.6</b> Cpk and Ppk</a></li>
<li class="chapter" data-level="17.1.7" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#equality-1"><i class="fa fa-check"></i><b>17.1.7</b> Equality</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#confidence-intervals-normal-approximation"><i class="fa fa-check"></i><b>17.2</b> Confidence Intervals (Normal Approximation)</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#cp-confidence-interval"><i class="fa fa-check"></i><b>17.2.1</b> Cp Confidence Interval</a></li>
<li class="chapter" data-level="17.2.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#cpk-confidence-interval"><i class="fa fa-check"></i><b>17.2.2</b> Cpk Confidence Interval</a></li>
<li class="chapter" data-level="17.2.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#pp-and-ppk-confidence-intervals"><i class="fa fa-check"></i><b>17.2.3</b> Pp and Ppk Confidence Intervals</a></li>
<li class="chapter" data-level="17.2.4" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#visualizing-confidence-intervals-1"><i class="fa fa-check"></i><b>17.2.4</b> Visualizing Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#bootstrapping-cp-example"><i class="fa fa-check"></i><b>17.3</b> Bootstrapping Cp (Example)</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#bootstrap-sampling-distributions-visualization"><i class="fa fa-check"></i><b>17.3.1</b> Bootstrap Sampling Distributions Visualization</a></li>
<li class="chapter" data-level="17.3.2" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>17.3.2</b> Bootstrap Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indices-and-confidence-intervals-for-statistical-process-control-in-python.html"><a href="indices-and-confidence-intervals-for-statistical-process-control-in-python.html#conclusion-14"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html"><i class="fa fa-check"></i><b>18</b> Useful Life Distributions (Exponential)</a>
<ul>
<li class="chapter" data-level="18.1" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#getting-started-17"><i class="fa fa-check"></i><b>18.1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#load-packages-4"><i class="fa fa-check"></i><b>18.1.1</b> Load Packages</a></li>
<li class="chapter" data-level="18.1.2" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#key-concepts"><i class="fa fa-check"></i><b>18.1.2</b> Key Concepts</a></li>
<li class="chapter" data-level="18.1.3" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#our-data-6"><i class="fa fa-check"></i><b>18.1.3</b> Our Data</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#quantities-of-interest"><i class="fa fa-check"></i><b>18.2</b> Quantities of Interest</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#lack-of-memory"><i class="fa fa-check"></i><b>18.2.1</b> Lack of Memory</a></li>
<li class="chapter" data-level="18.2.2" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#mean-time-to-fail"><i class="fa fa-check"></i><b>18.2.2</b> Mean Time to Fail</a></li>
<li class="chapter" data-level="18.2.3" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#mean-time-to-fail-via-integration"><i class="fa fa-check"></i><b>18.2.3</b> Mean Time to Fail via <em>Integration</em></a></li>
<li class="chapter" data-level="18.2.4" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#median-time-to-fail-t_50"><i class="fa fa-check"></i><b>18.2.4</b> Median Time to Fail <span class="math inline">\(T_{50}\)</span></a></li>
<li class="chapter" data-level="18.2.5" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#modal-time-to-fail"><i class="fa fa-check"></i><b>18.2.5</b> Modal Time to Fail</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#learning-check-1-13"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#learning-check-2-9"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="18.3" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#quantities-of-interest-continued"><i class="fa fa-check"></i><b>18.3</b> Quantities of Interest (continued)</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#conditional-reliability-survival-function"><i class="fa fa-check"></i><b>18.3.1</b> Conditional Reliability (Survival) Function</a></li>
<li class="chapter" data-level="18.3.2" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#mut-mean-residual-life"><i class="fa fa-check"></i><b>18.3.2</b> <span class="math inline">\(\mu(t)\)</span>: Mean Residual Life</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#learning-check-3-6"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="18.4" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#system-failure-with-independent-failure-rates"><i class="fa fa-check"></i><b>18.4</b> System Failure with Independent Failure Rates</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#reliability-functions-with-multiple-inputs"><i class="fa fa-check"></i><b>18.4.1</b> Reliability Functions with Multiple Inputs</a></li>
<li class="chapter" data-level="18.4.2" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#phase-type-distributions"><i class="fa fa-check"></i><b>18.4.2</b> Phase-Type Distributions</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="useful-life-distributions-exponential.html"><a href="useful-life-distributions-exponential.html#conclusion-15"><i class="fa fa-check"></i><b>18.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html"><i class="fa fa-check"></i><b>19</b> Statistical Techniques for Exponential Distributions in <code>R</code></a>
<ul>
<li class="chapter" data-level="19.1" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#getting-started-18"><i class="fa fa-check"></i><b>19.1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#load-packages-5"><i class="fa fa-check"></i><b>19.1.1</b> Load Packages</a></li>
<li class="chapter" data-level="19.1.2" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#our-data-7"><i class="fa fa-check"></i><b>19.1.2</b> Our Data</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#factors-in-r"><i class="fa fa-check"></i><b>19.2</b> Factors in R</a></li>
<li class="chapter" data-level="19.3" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#crosstabulation"><i class="fa fa-check"></i><b>19.3</b> Crosstabulation</a></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#learning-check-1-14"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="19.4" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#estimating-lambda"><i class="fa fa-check"></i><b>19.4</b> Estimating Lambda</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#lambda-from-complete-sample"><i class="fa fa-check"></i><b>19.4.1</b> Lambda from Complete Sample</a></li>
<li class="chapter" data-level="19.4.2" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#hatlambda-from-cross-tabulation"><i class="fa fa-check"></i><b>19.4.2</b> <span class="math inline">\(\hat{\lambda}\)</span> from Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#learning-check-2-10"><i class="fa fa-check"></i>Learning Check 2</a>
<ul>
<li class="chapter" data-level="19.4.3" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#confidence-intervals-for-hatlambda"><i class="fa fa-check"></i><b>19.4.3</b> Confidence Intervals for <span class="math inline">\(\hat{\lambda}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#learning-check-3-7"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="19.5" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#planning-experiments"><i class="fa fa-check"></i><b>19.5</b> Planning Experiments</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#example-minimum-sample-size"><i class="fa fa-check"></i><b>19.5.1</b> Example: Minimum Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#chi-squared"><i class="fa fa-check"></i><b>19.6</b> Chi-squared</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#compute-chi-squared-from-scratch"><i class="fa fa-check"></i><b>19.6.1</b> Compute Chi-squared from scratch</a></li>
<li class="chapter" data-level="19.6.2" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#building-a-chi-squared-function"><i class="fa fa-check"></i><b>19.6.2</b> Building a Chi-squared function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#learning-check-4-5"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="19.7" data-path="statistical-techniques-for-exponential-distributions-in-r.html"><a href="statistical-techniques-for-exponential-distributions-in-r.html#conclusion-16"><i class="fa fa-check"></i><b>19.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html"><i class="fa fa-check"></i><b>20</b> Statistical Techniques for Exponential Distributions in <code>Python</code></a>
<ul>
<li class="chapter" data-level="20.1" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#getting-started-19"><i class="fa fa-check"></i><b>20.1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#load-packages-6"><i class="fa fa-check"></i><b>20.1.1</b> Load Packages</a></li>
<li class="chapter" data-level="20.1.2" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#our-data-8"><i class="fa fa-check"></i><b>20.1.2</b> Our Data</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#factors-in-python"><i class="fa fa-check"></i><b>20.2</b> Factors in Python</a></li>
<li class="chapter" data-level="20.3" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#crosstabulation-1"><i class="fa fa-check"></i><b>20.3</b> Crosstabulation</a></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#learning-check-1-15"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="20.4" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#estimating-lambda-1"><i class="fa fa-check"></i><b>20.4</b> Estimating Lambda</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#lambda-from-complete-sample-1"><i class="fa fa-check"></i><b>20.4.1</b> Lambda from Complete Sample</a></li>
<li class="chapter" data-level="20.4.2" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#hatlambda-from-cross-tabulation-1"><i class="fa fa-check"></i><b>20.4.2</b> <span class="math inline">\(\hat{\lambda}\)</span> from Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#learning-check-2-11"><i class="fa fa-check"></i>Learning Check 2</a>
<ul>
<li class="chapter" data-level="20.4.3" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#confidence-intervals-for-hatlambda-1"><i class="fa fa-check"></i><b>20.4.3</b> Confidence Intervals for <span class="math inline">\(\hat{\lambda}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#learning-check-3-8"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="20.5" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#planning-experiments-1"><i class="fa fa-check"></i><b>20.5</b> Planning Experiments</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#example-minimum-sample-size-1"><i class="fa fa-check"></i><b>20.5.1</b> Example: Minimum Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#chi-squared-1"><i class="fa fa-check"></i><b>20.6</b> Chi-squared</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#compute-chi-squared-from-scratch-1"><i class="fa fa-check"></i><b>20.6.1</b> Compute Chi-squared from scratch</a></li>
<li class="chapter" data-level="20.6.2" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#building-a-chi-squared-function-1"><i class="fa fa-check"></i><b>20.6.2</b> Building a Chi-squared function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#learning-check-4-6"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="20.7" data-path="statistical-techniques-for-exponential-distributions-in-python.html"><a href="statistical-techniques-for-exponential-distributions-in-python.html#conclusion-17"><i class="fa fa-check"></i><b>20.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html"><i class="fa fa-check"></i><b>21</b> Useful Life Distributions (Weibull, Gamma, &amp; Lognormal)</a>
<ul>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#getting-started-20"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#load-packages-7"><i class="fa fa-check"></i>Load Packages</a></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#load-data"><i class="fa fa-check"></i>Load Data</a></li>
</ul></li>
<li class="chapter" data-level="21.1" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>21.1</b> Maximum Likelihood Estimation (MLE)</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#likelihood-function"><i class="fa fa-check"></i><b>21.1.1</b> Likelihood Function</a></li>
<li class="chapter" data-level="21.1.2" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#maximizing-with-optim"><i class="fa fa-check"></i><b>21.1.2</b> Maximizing with <code>optim()</code></a></li>
<li class="chapter" data-level="21.1.3" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#under-the-hood"><i class="fa fa-check"></i><b>21.1.3</b> Under the Hood</a></li>
<li class="chapter" data-level="21.1.4" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#multi-parameter-optimization"><i class="fa fa-check"></i><b>21.1.4</b> Multi-parameter optimization</a></li>
<li class="chapter" data-level="21.1.5" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#mle-with-censored-data"><i class="fa fa-check"></i><b>21.1.5</b> MLE with Censored Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#learning-check-1-16"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="21.2" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#gamma-distribution-1"><i class="fa fa-check"></i><b>21.2</b> Gamma Distribution</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#gamma-function-gamma"><i class="fa fa-check"></i><b>21.2.1</b> <span class="math inline">\(\Gamma\)</span> function <code>gamma()</code></a></li>
<li class="chapter" data-level="21.2.2" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#ft-or-dtprobability-density-function-aka-pdf"><i class="fa fa-check"></i><b>21.2.2</b> <span class="math inline">\(f(t)\)</span> or <code>d(t)</code>(<strong>Probability Density Function, aka PDF</strong>)</a></li>
<li class="chapter" data-level="21.2.3" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#ft-failure-function-and-rt-reliability-function"><i class="fa fa-check"></i><b>21.2.3</b> <span class="math inline">\(F(t)\)</span> <strong>Failure Function</strong> and <span class="math inline">\(R(t)\)</span> <strong>Reliability Function</strong></a></li>
<li class="chapter" data-level="21.2.4" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#mttf-and-variance"><i class="fa fa-check"></i><b>21.2.4</b> MTTF and Variance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#learning-check-2-12"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="21.3" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#weibull-distribution-1"><i class="fa fa-check"></i><b>21.3</b> Weibull Distribution</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#ft-failure-function-and-rt-reliability-function-1"><i class="fa fa-check"></i><b>21.3.1</b> <span class="math inline">\(F(t)\)</span> Failure Function and <span class="math inline">\(R(t)\)</span> Reliability Function</a></li>
<li class="chapter" data-level="21.3.2" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#ft-or-dt-pdf"><i class="fa fa-check"></i><b>21.3.2</b> <span class="math inline">\(f(t)\)</span> or <code>d(t)</code> (PDF)</a></li>
<li class="chapter" data-level="21.3.3" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#zt-failure-rate"><i class="fa fa-check"></i><b>21.3.3</b> <span class="math inline">\(z(t)\)</span> Failure Rate</a></li>
<li class="chapter" data-level="21.3.4" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#m-and-c"><i class="fa fa-check"></i><b>21.3.4</b> <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span></a></li>
<li class="chapter" data-level="21.3.5" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#weibull-series-systems"><i class="fa fa-check"></i><b>21.3.5</b> Weibull Series Systems</a></li>
<li class="chapter" data-level="21.3.6" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#mttf-and-variance-1"><i class="fa fa-check"></i><b>21.3.6</b> MTTF and Variance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#learning-check-3-9"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#learning-check-4-7"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="21.4" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#lognormal-distribution"><i class="fa fa-check"></i><b>21.4</b> Lognormal Distribution</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#ft-or-dt-pdf-1"><i class="fa fa-check"></i><b>21.4.1</b> <span class="math inline">\(f(t)\)</span> or <code>d(t)</code> (PDF)</a></li>
<li class="chapter" data-level="21.4.2" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#phi"><i class="fa fa-check"></i><b>21.4.2</b> <span class="math inline">\(\Phi\)</span></a></li>
<li class="chapter" data-level="21.4.3" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#key-functions-1"><i class="fa fa-check"></i><b>21.4.3</b> Key Functions</a></li>
<li class="chapter" data-level="21.4.4" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#mttf-and-variance-2"><i class="fa fa-check"></i><b>21.4.4</b> MTTF and Variance</a></li>
<li class="chapter" data-level="21.4.5" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#using-other-parameters"><i class="fa fa-check"></i><b>21.4.5</b> Using Other Parameters</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#learning-check-5-4"><i class="fa fa-check"></i>Learning Check 5</a></li>
<li class="chapter" data-level="" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#learning-check-6-1"><i class="fa fa-check"></i>Learning Check 6</a></li>
<li class="chapter" data-level="21.5" data-path="useful-life-distributions-weibull-gamma-lognormal.html"><a href="useful-life-distributions-weibull-gamma-lognormal.html#conclusion-18"><i class="fa fa-check"></i><b>21.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html"><i class="fa fa-check"></i><b>22</b> Fault Tree Analysis in R</a>
<ul>
<li class="chapter" data-level="" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#getting-started-21"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#load-packages-8"><i class="fa fa-check"></i>Load Packages</a></li>
</ul></li>
<li class="chapter" data-level="22.1" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#simulating-fault-trees"><i class="fa fa-check"></i><b>22.1</b> Simulating Fault Trees</a></li>
<li class="chapter" data-level="22.2" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#example-superman-fault-tree"><i class="fa fa-check"></i><b>22.2</b> Example: Superman Fault Tree</a></li>
<li class="chapter" data-level="22.3" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#using-raw-probabilities"><i class="fa fa-check"></i><b>22.3</b> Using Raw Probabilities</a></li>
<li class="chapter" data-level="" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#learning-check-1-17"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="22.4" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#using-failure-rates-at-time-t"><i class="fa fa-check"></i><b>22.4</b> Using Failure Rates at Time <code>t</code></a></li>
<li class="chapter" data-level="" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#learning-check-2-13"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="22.5" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#simulating-uncertainty-in-probabilities"><i class="fa fa-check"></i><b>22.5</b> Simulating Uncertainty in Probabilities</a></li>
<li class="chapter" data-level="22.6" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#simulating-uncertainty-in-failure-rates"><i class="fa fa-check"></i><b>22.6</b> Simulating Uncertainty in Failure Rates</a></li>
<li class="chapter" data-level="22.7" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#example-contagion"><i class="fa fa-check"></i><b>22.7</b> Example: Contagion</a></li>
<li class="chapter" data-level="" data-path="fault-tree-analysis-in-r.html"><a href="fault-tree-analysis-in-r.html#learning-check-3-10"><i class="fa fa-check"></i>Learning Check 3</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html"><i class="fa fa-check"></i><b>23</b> Physical Acceleration Models</a>
<ul>
<li class="chapter" data-level="" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#getting-started-22"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#load-packages-9"><i class="fa fa-check"></i>Load Packages</a></li>
<li class="chapter" data-level="" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#helpful-functions"><i class="fa fa-check"></i>Helpful Functions</a></li>
</ul></li>
<li class="chapter" data-level="23.1" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#acceleration-factor"><i class="fa fa-check"></i><b>23.1</b> Acceleration Factor</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#stress-vs.-usage-conditions"><i class="fa fa-check"></i><b>23.1.1</b> Stress vs. Usage Conditions</a></li>
<li class="chapter" data-level="23.1.2" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#acceleration-as-a-function-fracf_stf_ut"><i class="fa fa-check"></i><b>23.1.2</b> Acceleration as a Function <span class="math inline">\(\frac{f_{s}(t)}{f_{u}(t)}\)</span></a></li>
<li class="chapter" data-level="23.1.3" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#linear-acceleration"><i class="fa fa-check"></i><b>23.1.3</b> Linear Acceleration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#learning-check-1-18"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#learning-check-2-14"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="23.2" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#modeling-normal-use-lifespan"><i class="fa fa-check"></i><b>23.2</b> Modeling Normal Use Lifespan</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#models-and-prediction"><i class="fa fa-check"></i><b>23.2.1</b> Models and Prediction</a></li>
<li class="chapter" data-level="23.2.2" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#arrhenius-model-temperature"><i class="fa fa-check"></i><b>23.2.2</b> Arrhenius Model (Temperature)</a></li>
<li class="chapter" data-level="23.2.3" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#visualizing-the-arrhenius-model"><i class="fa fa-check"></i><b>23.2.3</b> Visualizing the Arrhenius Model</a></li>
<li class="chapter" data-level="23.2.4" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#estimating-the-arrhenius-model"><i class="fa fa-check"></i><b>23.2.4</b> Estimating the Arrhenius Model</a></li>
<li class="chapter" data-level="23.2.5" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#prediction"><i class="fa fa-check"></i><b>23.2.5</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#eyring-model-multiple-stressors"><i class="fa fa-check"></i><b>23.3</b> Eyring Model (Multiple Stressors)</a></li>
<li class="chapter" data-level="23.4" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#degradation-model-time-trends"><i class="fa fa-check"></i><b>23.4</b> Degradation Model (Time Trends)</a></li>
<li class="chapter" data-level="23.5" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#burn-in-periods"><i class="fa fa-check"></i><b>23.5</b> Burn-in Periods</a></li>
<li class="chapter" data-level="23.6" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#maximum-likelihood-estimation-mle-for-physical-acceleration-models"><i class="fa fa-check"></i><b>23.6</b> Maximum Likelihood Estimation (MLE) for Physical Acceleration Models</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#mle-for-an-example-arrhenius-model"><i class="fa fa-check"></i><b>23.6.1</b> MLE for an Example Arrhenius Model</a></li>
<li class="chapter" data-level="23.6.2" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#estimating-delta-h-with-mle"><i class="fa fa-check"></i><b>23.6.2</b> Estimating <span class="math inline">\(\Delta H\)</span> with MLE</a></li>
<li class="chapter" data-level="23.6.3" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#visualizing-probabilities"><i class="fa fa-check"></i><b>23.6.3</b> Visualizing Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="physical-acceleration-models.html"><a href="physical-acceleration-models.html#conclusion-19"><i class="fa fa-check"></i><b>23.7</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>IV Life Distributions</b></span></li>
<li class="part"><span><b>V Physical Acceleration Models</b></span></li>
<li class="part"><span><b>VI Regression</b></span></li>
<li class="chapter" data-level="24" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html"><i class="fa fa-check"></i><b>24</b> Bivariate Regression: Modeling Diamond Pricing</a>
<ul>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#getting-started-23"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#load-data-1"><i class="fa fa-check"></i>Load Data</a></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#view-data"><i class="fa fa-check"></i>View Data</a></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#codebook"><i class="fa fa-check"></i>Codebook</a></li>
</ul></li>
<li class="chapter" data-level="24.1" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#review"><i class="fa fa-check"></i><b>24.1</b> Review</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#scatterplots"><i class="fa fa-check"></i><b>24.1.1</b> Scatterplots</a></li>
<li class="chapter" data-level="24.1.2" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#correlation"><i class="fa fa-check"></i><b>24.1.2</b> Correlation</a></li>
<li class="chapter" data-level="24.1.3" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#example"><i class="fa fa-check"></i><b>24.1.3</b> Example</a></li>
<li class="chapter" data-level="24.1.4" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#cor.test-and-tidy"><i class="fa fa-check"></i><b>24.1.4</b> cor.test() and tidy()</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#regression-and-the-line-of-best-fit"><i class="fa fa-check"></i><b>24.2</b> Regression and the Line of Best Fit</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#model-equation"><i class="fa fa-check"></i><b>24.2.1</b> Model Equation</a></li>
<li class="chapter" data-level="24.2.2" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#coding-regression-models"><i class="fa fa-check"></i><b>24.2.2</b> Coding Regression Models</a></li>
<li class="chapter" data-level="24.2.3" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#lm"><i class="fa fa-check"></i><b>24.2.3</b> lm()</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#learning-check-1-19"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="24.3" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#statistical-significance"><i class="fa fa-check"></i><b>24.3</b> Statistical Significance</a></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#learning-check-2-15"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="24.4" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#visualization"><i class="fa fa-check"></i><b>24.4</b> Visualization</a></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#learning-check-3-11"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="24.5" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#finding-the-line-of-best-fit"><i class="fa fa-check"></i><b>24.5</b> Finding the Line of Best Fit</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#predicted-values"><i class="fa fa-check"></i><b>24.5.1</b> Predicted Values</a></li>
<li class="chapter" data-level="24.5.2" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#residuals"><i class="fa fa-check"></i><b>24.5.2</b> Residuals</a></li>
<li class="chapter" data-level="24.5.3" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#r-squared"><i class="fa fa-check"></i><b>24.5.3</b> R-squared</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#learning-check-4-8"><i class="fa fa-check"></i>Learning Check 4</a></li>
<li class="chapter" data-level="24.6" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#f-statistic"><i class="fa fa-check"></i><b>24.6</b> F-statistic</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#interpreting-an-f-statistic"><i class="fa fa-check"></i><b>24.6.1</b> Interpreting an F-statistic</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#summary"><i class="fa fa-check"></i><b>24.7</b> <code>summary()</code></a>
<ul>
<li class="chapter" data-level="24.7.1" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#get-all-stats-all-at-once-with-summary"><i class="fa fa-check"></i><b>24.7.1</b> Get all stats, all at once with <code>summary()</code></a></li>
<li class="chapter" data-level="24.7.2" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#key-statistics-1"><i class="fa fa-check"></i><b>24.7.2</b> <strong>4 Key Statistics</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bivariate-regression-modeling-diamond-pricing.html"><a href="bivariate-regression-modeling-diamond-pricing.html#learning-check-5-5"><i class="fa fa-check"></i>Learning Check 5</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><i class="fa fa-check"></i><b>25</b> Multivariate Regression: Modeling Effects of Disaster on Social Capital</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#getting-started-24"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#load-data-packages"><i class="fa fa-check"></i>Load Data &amp; Packages</a></li>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#view-data-1"><i class="fa fa-check"></i>View Data</a></li>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#codebook-1"><i class="fa fa-check"></i>Codebook</a></li>
</ul></li>
<li class="chapter" data-level="25.1" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#multiple-regression"><i class="fa fa-check"></i><b>25.1</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#beta-coefficients"><i class="fa fa-check"></i><b>25.1.1</b> Beta coefficients</a></li>
<li class="chapter" data-level="25.1.2" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#controls"><i class="fa fa-check"></i><b>25.1.2</b> Controls</a></li>
<li class="chapter" data-level="25.1.3" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#planes"><i class="fa fa-check"></i><b>25.1.3</b> Planes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#learning-check-1-20"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="25.2" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#effect-sizes"><i class="fa fa-check"></i><b>25.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#learning-check-2-16"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="25.3" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#multiple-models"><i class="fa fa-check"></i><b>25.3</b> Multiple Models</a></li>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#learning-check-3-12"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="25.4" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#great-tables"><i class="fa fa-check"></i><b>25.4</b> Great Tables</a></li>
<li class="chapter" data-level="" data-path="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html"><a href="multivariate-regression-modeling-effects-of-disaster-on-social-capital.html#learning-check-4-9"><i class="fa fa-check"></i>Learning Check 4</a></li>
</ul></li>
<li class="part"><span><b>VII Comparing Groups and ANOVA</b></span></li>
<li class="chapter" data-level="26" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html"><i class="fa fa-check"></i><b>26</b> Design of Experiments in R</a>
<ul>
<li class="chapter" data-level="" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#getting-started-25"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#the-experiment"><i class="fa fa-check"></i>The Experiment</a></li>
<li class="chapter" data-level="" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#import-data"><i class="fa fa-check"></i>Import Data</a></li>
</ul></li>
<li class="chapter" data-level="26.1" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#difference-of-means-t-tests"><i class="fa fa-check"></i><b>26.1</b> Difference of Means (t-tests)</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#calculating-dbar"><i class="fa fa-check"></i><b>26.1.1</b> Calculating <code>dbar</code></a></li>
<li class="chapter" data-level="26.1.2" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#visualizing-the-difference-of-means"><i class="fa fa-check"></i><b>26.1.2</b> Visualizing the difference of means</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#definitions-null-vs.-sampling-distributions"><i class="fa fa-check"></i><b>26.2</b> Definitions: Null vs. Sampling Distributions</a></li>
<li class="chapter" data-level="26.3" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#null-distributions"><i class="fa fa-check"></i><b>26.3</b> Null Distributions</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#permutation-test-computational-approach"><i class="fa fa-check"></i><b>26.3.1</b> Permutation Test (Computational Approach)</a></li>
<li class="chapter" data-level="26.3.2" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#t-statistics-theoretical-approach"><i class="fa fa-check"></i><b>26.3.2</b> t-statistics (Theoretical Approach)</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#sampling-distribution"><i class="fa fa-check"></i><b>26.4</b> Sampling Distribution</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#bootstrapped-cis-for-dbar"><i class="fa fa-check"></i><b>26.4.1</b> Bootstrapped CIs for <code>dbar</code></a></li>
<li class="chapter" data-level="26.4.2" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#assume-normal-cis-for-dbar"><i class="fa fa-check"></i><b>26.4.2</b> Assume Normal CIs for <code>dbar</code></a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#speedy-t-tests"><i class="fa fa-check"></i><b>26.5</b> Speedy t-tests</a></li>
<li class="chapter" data-level="26.6" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#anova"><i class="fa fa-check"></i><b>26.6</b> ANOVA</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#visualizing-anova"><i class="fa fa-check"></i><b>26.6.1</b> Visualizing ANOVA</a></li>
<li class="chapter" data-level="26.6.2" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#anova-explained"><i class="fa fa-check"></i><b>26.6.2</b> ANOVA Explained</a></li>
<li class="chapter" data-level="26.6.3" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#functions-for-anova"><i class="fa fa-check"></i><b>26.6.3</b> Functions for ANOVA</a></li>
<li class="chapter" data-level="26.6.4" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#lm---the-easy-way"><i class="fa fa-check"></i><b>26.6.4</b> <code>lm()</code> - the easy way</a></li>
<li class="chapter" data-level="26.6.5" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#aov---the-normal-way"><i class="fa fa-check"></i><b>26.6.5</b> <code>aov()</code> - the normal way</a></li>
<li class="chapter" data-level="26.6.6" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#oneway.test---if-you-know-your-group-variances-are-unequal"><i class="fa fa-check"></i><b>26.6.6</b> <code>oneway.test()</code> - if you know your group variances are unequal</a></li>
<li class="chapter" data-level="26.6.7" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#multiple-variables"><i class="fa fa-check"></i><b>26.6.7</b> Multiple Variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="design-of-experiments-in-r.html"><a href="design-of-experiments-in-r.html#conclusion-20"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="part"><span><b>VIII Factorial Design &amp; RSM</b></span></li>
<li class="chapter" data-level="27" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html"><i class="fa fa-check"></i><b>27</b> Factorial Design and Interaction Effects in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#getting-started-26"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#factorial-design"><i class="fa fa-check"></i>Factorial Design</a></li>
<li class="chapter" data-level="" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#data-packages"><i class="fa fa-check"></i>Data &amp; Packages</a></li>
</ul></li>
<li class="chapter" data-level="27.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-direct-effects"><i class="fa fa-check"></i><b>27.1</b> Estimating Direct Effects</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#difference-of-grand-means-barbard"><i class="fa fa-check"></i><b>27.1.1</b> Difference of Grand Means <span class="math inline">\(\bar{\bar{d}}\)</span></a></li>
<li class="chapter" data-level="27.1.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#slower-but-clearer-method-of-getting-the-difference-of-grand-means-barbard"><i class="fa fa-check"></i><b>27.1.2</b> Slower-but-Clearer Method of Getting the Difference of Grand Means <span class="math inline">\(\bar{\bar{d}}\)</span></a></li>
<li class="chapter" data-level="27.1.3" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#faster-but-messier-method-of-getting-the-difference-of-grand-means-barbard"><i class="fa fa-check"></i><b>27.1.3</b> Faster-but-Messier Method of Getting the Difference of Grand Means <span class="math inline">\(\bar{\bar{d}}\)</span></a></li>
<li class="chapter" data-level="27.1.4" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-many-difference-of-grand-means-barbard"><i class="fa fa-check"></i><b>27.1.4</b> Estimating <em>Many</em> Difference of Grand Means <span class="math inline">\(\bar{\bar{d}}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#standard-errors-for-barbard"><i class="fa fa-check"></i><b>27.2</b> Standard Errors for <span class="math inline">\(\bar{\bar{d}}\)</span></a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-standard-error-when-s2_i-is-known"><i class="fa fa-check"></i><b>27.2.1</b> Estimating Standard Error when <span class="math inline">\(s^2_i\)</span> is known</a></li>
<li class="chapter" data-level="27.2.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#using-pooled-variance-to-estimate-standard-errors"><i class="fa fa-check"></i><b>27.2.2</b> Using Pooled Variance to Estimate Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#pivoting-data-with-pivot_longer-pivot_wider"><i class="fa fa-check"></i><b>27.3</b> Pivoting Data with <code>pivot_longer()</code> &amp; <code>pivot_wider()</code></a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#contains"><i class="fa fa-check"></i><b>27.3.1</b> <code>contains()</code></a></li>
<li class="chapter" data-level="27.3.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>27.3.2</b> <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="27.3.3" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>27.3.3</b> <code>pivot_wider()</code></a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#visualizing-reporting-treatment-effects"><i class="fa fa-check"></i><b>27.4</b> Visualizing &amp; Reporting Treatment Effects</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#building-a-table-of-direct-effects"><i class="fa fa-check"></i><b>27.4.1</b> Building a Table of Direct Effects</a></li>
<li class="chapter" data-level="27.4.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#visualization-strategies"><i class="fa fa-check"></i><b>27.4.2</b> Visualization Strategies</a></li>
<li class="chapter" data-level="27.4.3" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#an-excellent-visual"><i class="fa fa-check"></i><b>27.4.3</b> An Excellent Visual</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#interaction-effects"><i class="fa fa-check"></i><b>27.5</b> Interaction Effects</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-a-pooled-standard-error"><i class="fa fa-check"></i><b>27.5.1</b> Estimating a Pooled Standard Error</a></li>
<li class="chapter" data-level="27.5.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-1-way-direct-effects-with-dbar_oneway"><i class="fa fa-check"></i><b>27.5.2</b> Estimating 1-way (direct) effects with <code>dbar_oneway()</code></a></li>
<li class="chapter" data-level="27.5.3" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-2-way-interactions"><i class="fa fa-check"></i><b>27.5.3</b> Estimating 2-way interactions</a></li>
<li class="chapter" data-level="27.5.4" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-3-way-interactions"><i class="fa fa-check"></i><b>27.5.4</b> Estimating 3-way interactions</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#estimating-interactions-in-lm"><i class="fa fa-check"></i><b>27.6</b> Estimating Interactions in <code>lm()</code></a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#modeling-interactions"><i class="fa fa-check"></i><b>27.6.1</b> Modeling Interactions</a></li>
<li class="chapter" data-level="27.6.2" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#using-predict-to-visualize-interaction-effects"><i class="fa fa-check"></i><b>27.6.2</b> Using <code>predict()</code> to visualize interaction effects</a></li>
<li class="chapter" data-level="27.6.3" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#finding-the-best-model-with-anova"><i class="fa fa-check"></i><b>27.6.3</b> Finding the best model with <code>anova()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factorial-design-and-interaction-effects-in-r.html"><a href="factorial-design-and-interaction-effects-in-r.html#conclusion-21"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html"><i class="fa fa-check"></i><b>28</b> Response Surface Methodology in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#getting-started-27"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#packages-10"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#our-data-9"><i class="fa fa-check"></i>Our Data</a></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#import-data-1"><i class="fa fa-check"></i>Import Data</a></li>
</ul></li>
<li class="chapter" data-level="28.1" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#models-for-rsm"><i class="fa fa-check"></i><b>28.1</b> Models for RSM</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#specifying-an-interaction-model-with-polynomials"><i class="fa fa-check"></i><b>28.1.1</b> Specifying an Interaction Model with Polynomials</a></li>
<li class="chapter" data-level="28.1.2" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#modeling-with-rsm"><i class="fa fa-check"></i><b>28.1.2</b> Modeling with <code>rsm()</code></a></li>
<li class="chapter" data-level="28.1.3" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#transforming-variables"><i class="fa fa-check"></i><b>28.1.3</b> Transforming Variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#learning-check-1-21"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="28.2" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#contour-plots"><i class="fa fa-check"></i><b>28.2</b> Contour Plots</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#simple-contour-plots"><i class="fa fa-check"></i><b>28.2.1</b> Simple <code>contour()</code> plots</a></li>
<li class="chapter" data-level="28.2.2" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#geom_tile-plots"><i class="fa fa-check"></i><b>28.2.2</b> <code>geom_tile()</code> plots</a></li>
<li class="chapter" data-level="28.2.3" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#pretty-geom_contour-plots"><i class="fa fa-check"></i><b>28.2.3</b> Pretty <code>geom_contour()</code> plots!</a></li>
<li class="chapter" data-level="28.2.4" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#one-step-rsm-in-ggplot"><i class="fa fa-check"></i><b>28.2.4</b> One-step RSM in <code>ggplot</code></a></li>
<li class="chapter" data-level="28.2.5" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#more-realistic-plots"><i class="fa fa-check"></i><b>28.2.5</b> More Realistic Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#learning-check-2-17"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="28.3" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#iterate"><i class="fa fa-check"></i><b>28.3</b> Iterate!</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#modeling-many-interactions"><i class="fa fa-check"></i><b>28.3.1</b> Modeling many Interactions</a></li>
<li class="chapter" data-level="28.3.2" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#contours-with-multiple-variables"><i class="fa fa-check"></i><b>28.3.2</b> Contours with Multiple Variables</a></li>
<li class="chapter" data-level="28.3.3" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#ggplot-contour-plots"><i class="fa fa-check"></i><b>28.3.3</b> <code>ggplot</code> contour plots!</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#learning-check-3-13"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="28.4" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#quantities-of-interest-in-rsm"><i class="fa fa-check"></i><b>28.4</b> Quantities of Interest in RSM</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#percent-change-in-bins"><i class="fa fa-check"></i><b>28.4.1</b> Percent Change in Bins</a></li>
<li class="chapter" data-level="28.4.2" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#study-range"><i class="fa fa-check"></i><b>28.4.2</b> Study Range</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#extra-concepts-of-interest-canonical-form"><i class="fa fa-check"></i><b>28.5</b> Extra Concepts of Interest: Canonical Form</a>
<ul>
<li class="chapter" data-level="28.5.1" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#finding-the-canonical-form"><i class="fa fa-check"></i><b>28.5.1</b> Finding the Canonical Form</a></li>
<li class="chapter" data-level="28.5.2" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#canonical-form-coefficients"><i class="fa fa-check"></i><b>28.5.2</b> Canonical Form Coefficients</a></li>
<li class="chapter" data-level="28.5.3" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#stationary-points"><i class="fa fa-check"></i><b>28.5.3</b> Stationary Points</a></li>
<li class="chapter" data-level="28.5.4" data-path="response-surface-methodology-in-r.html"><a href="response-surface-methodology-in-r.html#shift-points"><i class="fa fa-check"></i><b>28.5.4</b> Shift Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion-22.html"><a href="conclusion-22.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="29" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html"><i class="fa fa-check"></i><b>29</b> Response Surface Methodology in <code>Python</code></a>
<ul>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#getting-started-28"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#packages-11"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#our-data-10"><i class="fa fa-check"></i>Our Data</a></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#import-data-2"><i class="fa fa-check"></i>Import Data</a></li>
</ul></li>
<li class="chapter" data-level="29.1" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#models-for-rsm-1"><i class="fa fa-check"></i><b>29.1</b> Models for RSM</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#specifying-an-interaction-model-with-polynomials-1"><i class="fa fa-check"></i><b>29.1.1</b> Specifying an Interaction Model with Polynomials</a></li>
<li class="chapter" data-level="29.1.2" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#modeling-with-lm"><i class="fa fa-check"></i><b>29.1.2</b> Modeling with <code>lm()</code></a></li>
<li class="chapter" data-level="29.1.3" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#transforming-variables-1"><i class="fa fa-check"></i><b>29.1.3</b> Transforming Variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#learning-check-1-22"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="29.2" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#contour-plots-1"><i class="fa fa-check"></i><b>29.2</b> Contour Plots</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#simple-contour-plots-1"><i class="fa fa-check"></i><b>29.2.1</b> Simple <code>contour()</code> plots</a></li>
<li class="chapter" data-level="29.2.2" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#simple-contour-plots-with-plotnine"><i class="fa fa-check"></i><b>29.2.2</b> Simple contour plots with <code>plotnine</code></a></li>
<li class="chapter" data-level="29.2.3" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#more-detailed-contour-plots-with-matplotlib"><i class="fa fa-check"></i><b>29.2.3</b> More detailed contour plots with <code>matplotlib</code></a></li>
<li class="chapter" data-level="29.2.4" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#one-step-rsm-in-matplotlib"><i class="fa fa-check"></i><b>29.2.4</b> One-step RSM in <code>matplotlib</code></a></li>
<li class="chapter" data-level="29.2.5" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#more-realistic-plots-1"><i class="fa fa-check"></i><b>29.2.5</b> More Realistic Plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#learning-check-2-18"><i class="fa fa-check"></i>Learning Check 2</a></li>
<li class="chapter" data-level="29.3" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#iterate-1"><i class="fa fa-check"></i><b>29.3</b> Iterate!</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#modeling-many-interactions-1"><i class="fa fa-check"></i><b>29.3.1</b> Modeling many Interactions</a></li>
<li class="chapter" data-level="29.3.2" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#contours-with-multiple-variables-1"><i class="fa fa-check"></i><b>29.3.2</b> Contours with Multiple Variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#learning-check-3-14"><i class="fa fa-check"></i>Learning Check 3</a></li>
<li class="chapter" data-level="29.4" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#quantities-of-interest-in-rsm-1"><i class="fa fa-check"></i><b>29.4</b> Quantities of Interest in RSM</a>
<ul>
<li class="chapter" data-level="29.4.1" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#percent-change-in-bins-1"><i class="fa fa-check"></i><b>29.4.1</b> Percent Change in Bins</a></li>
<li class="chapter" data-level="29.4.2" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#study-range-1"><i class="fa fa-check"></i><b>29.4.2</b> Study Range</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="response-surface-methodology-in-python.html"><a href="response-surface-methodology-in-python.html#extra-concepts-of-interest-canonical-form-1"><i class="fa fa-check"></i><b>29.5</b> Extra Concepts of Interest: Canonical Form</a></li>
</ul></li>
<li class="part"><span><b>IX Appendices</b></span></li>
<li class="chapter" data-level="30" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html"><i class="fa fa-check"></i><b>30</b> Appendix: <code>ggplot</code> tips</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#getting-started-29"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="30.0.1" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#resources"><i class="fa fa-check"></i><b>30.0.1</b> Resources</a></li>
<li class="chapter" data-level="30.0.2" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#our-packages"><i class="fa fa-check"></i><b>30.0.2</b> Our Packages</a></li>
<li class="chapter" data-level="30.0.3" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#our-data-11"><i class="fa fa-check"></i><b>30.0.3</b> Our Data</a></li>
</ul></li>
<li class="chapter" data-level="30.1" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#flipping-axes"><i class="fa fa-check"></i><b>30.1</b> Flipping Axes</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#learning-check-1-23"><i class="fa fa-check"></i>Learning Check 1</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#legend-positioning"><i class="fa fa-check"></i><b>30.2</b> Legend Positioning</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#learning-check-8"><i class="fa fa-check"></i>Learning Check 8</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#breaking-up-a-visual"><i class="fa fa-check"></i><b>30.3</b> Breaking Up a Visual</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-ggplot-tips.html"><a href="appendix-ggplot-tips.html#learning-check-10"><i class="fa fa-check"></i>Learning Check 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><i class="fa fa-check"></i><b>31</b> Appendix: <code>mermaid</code> Block Diagrams (Flowcharts) in R</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#getting-started-30"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#block-diagrams"><i class="fa fa-check"></i>Block Diagrams</a></li>
<li class="chapter" data-level="" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#load-packages-10"><i class="fa fa-check"></i>Load Packages</a></li>
</ul></li>
<li class="chapter" data-level="31.1" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#mermaid"><i class="fa fa-check"></i><b>31.1</b> Mermaid</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#example-block-diagram-with-mermaid"><i class="fa fa-check"></i><b>31.1.1</b> Example Block Diagram with <code>mermaid</code></a></li>
<li class="chapter" data-level="" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#learning-check-1-24"><i class="fa fa-check"></i>Learning Check 1</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#diagram-of-ice-cream-shipment"><i class="fa fa-check"></i><b>31.2</b> Diagram of Ice Cream Shipment</a></li>
<li class="chapter" data-level="31.3" data-path="appendix-mermaid-block-diagrams-flowcharts-in-r.html"><a href="appendix-mermaid-block-diagrams-flowcharts-in-r.html#diagram-failures"><i class="fa fa-check"></i><b>31.3</b> Diagram Failures</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><i class="fa fa-check"></i><b>32</b> Appendix: Using <code>fitdistr</code> to Fitting Distribution Parameters</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#getting-started-31"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#load-packages-11"><i class="fa fa-check"></i>Load Packages</a></li>
<li class="chapter" data-level="32.0.1" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#our-data-12"><i class="fa fa-check"></i><b>32.0.1</b> Our Data</a></li>
</ul></li>
<li class="chapter" data-level="32.1" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#example-exponential-distribution"><i class="fa fa-check"></i><b>32.1</b> Example: Exponential Distribution</a></li>
<li class="chapter" data-level="32.2" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#method-of-moments"><i class="fa fa-check"></i><b>32.2</b> Method of Moments</a></li>
<li class="chapter" data-level="32.3" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#mle-with-fitdistr"><i class="fa fa-check"></i><b>32.3</b> MLE with <code>fitdistr()</code></a></li>
<li class="chapter" data-level="32.4" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#mle-with-optim"><i class="fa fa-check"></i><b>32.4</b> MLE with <code>optim()</code></a></li>
<li class="chapter" data-level="32.5" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#applications"><i class="fa fa-check"></i><b>32.5</b> Applications</a>
<ul>
<li class="chapter" data-level="32.5.1" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#normal-distribution-1"><i class="fa fa-check"></i><b>32.5.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="32.5.2" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#poisson-distribution-1"><i class="fa fa-check"></i><b>32.5.2</b> Poisson Distribution</a></li>
<li class="chapter" data-level="32.5.3" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#gamma-distribution-2"><i class="fa fa-check"></i><b>32.5.3</b> Gamma Distribution</a></li>
<li class="chapter" data-level="32.5.4" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#weibull-distribution-2"><i class="fa fa-check"></i><b>32.5.4</b> Weibull Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#learning-check-1-25"><i class="fa fa-check"></i>Learning Check 1</a></li>
<li class="chapter" data-level="32.6" data-path="appendix-using-fitdistr-to-fitting-distribution-parameters.html"><a href="appendix-using-fitdistr-to-fitting-distribution-parameters.html#conclusion-23"><i class="fa fa-check"></i><b>32.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html"><i class="fa fa-check"></i><b>33</b> Appendix: Statistical Tables and Common Equations</a>
<ul>
<li class="chapter" data-level="33.1" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#table-1-chi-squared"><i class="fa fa-check"></i><b>33.1</b> Table 1: Chi-Squared</a></li>
<li class="chapter" data-level="33.2" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#table-2-k-factor-rules"><i class="fa fa-check"></i><b>33.2</b> Table 2: k-factor rules</a></li>
<li class="chapter" data-level="33.3" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#table-3-k-factor-upper"><i class="fa fa-check"></i><b>33.3</b> Table 3: k-factor (upper)</a></li>
<li class="chapter" data-level="33.4" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#table-4-k-factor-lower"><i class="fa fa-check"></i><b>33.4</b> Table 4: k-factor (lower)</a></li>
<li class="chapter" data-level="33.5" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#table-5-control-constants-d"><i class="fa fa-check"></i><b>33.5</b> Table 5: Control Constants (d)</a></li>
<li class="chapter" data-level="33.6" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#table-6-control-constants-b"><i class="fa fa-check"></i><b>33.6</b> Table 6: Control Constants (b)</a></li>
<li class="chapter" data-level="33.7" data-path="appendix-statistical-tables-and-common-equations.html"><a href="appendix-statistical-tables-and-common-equations.html#formula"><i class="fa fa-check"></i><b>33.7</b> Formula</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">System Reliability and Six Sigma in R and Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="response-surface-methodology-in-python" class="section level1 hasAnchor" number="29">
<h1><span class="header-section-number">29</span> Response Surface Methodology in <code>Python</code><a href="response-surface-methodology-in-python.html#response-surface-methodology-in-python" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="images/15_plot_2.png" width="800" /></p>
<div id="getting-started-28" class="section level2 unnumbered hasAnchor">
<h2>Getting Started<a href="response-surface-methodology-in-python.html#getting-started-28" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Imagine: A team of enterprising Systems Engineering students have decided to start their own baking company, selling gingerbread cookies in the month of December in the greater Ithaca area! None of them are particularly good at baking, but they’re rad good at design of experiments, so they set out to discover the ultimate gingerbread cookie through factorial design and our new tool, <strong>response surface methodology!</strong> Follow along below to see a <strong>surprisingly accurate example</strong> of how <em>you</em> can apply <em>RSM</em> to find the optimal design of your product (in this case, <em>gingerbread</em>!)</p>
<p><br></p>
<div id="packages-11" class="section level3 unnumbered hasAnchor">
<h3>Packages<a href="response-surface-methodology-in-python.html#packages-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start by loading the necessary Python packages. We’ll use <code>pandas</code> for data manipulation, <code>plotnine</code> for visualization (which follows the ggplot2 framework), <code>numpy</code> for numerical operations, and <code>statsmodels</code> for statistical modeling.</p>
<div class="sourceCode" id="cb1678"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1678-1"><a href="response-surface-methodology-in-python.html#cb1678-1" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1678-2"><a href="response-surface-methodology-in-python.html#cb1678-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1678-3"><a href="response-surface-methodology-in-python.html#cb1678-3" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1678-4"><a href="response-surface-methodology-in-python.html#cb1678-4" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1678-5"><a href="response-surface-methodology-in-python.html#cb1678-5" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb1678-6"><a href="response-surface-methodology-in-python.html#cb1678-6" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1678-7"><a href="response-surface-methodology-in-python.html#cb1678-7" tabindex="-1"></a><span class="im">import</span> os, sys</span>
<span id="cb1678-8"><a href="response-surface-methodology-in-python.html#cb1678-8" tabindex="-1"></a></span>
<span id="cb1678-9"><a href="response-surface-methodology-in-python.html#cb1678-9" tabindex="-1"></a><span class="co"># Add the functions directory to Python path</span></span>
<span id="cb1678-10"><a href="response-surface-methodology-in-python.html#cb1678-10" tabindex="-1"></a>sys.path.append(os.path.abspath(<span class="st">&#39;functions&#39;</span>))</span>
<span id="cb1678-11"><a href="response-surface-methodology-in-python.html#cb1678-11" tabindex="-1"></a></span>
<span id="cb1678-12"><a href="response-surface-methodology-in-python.html#cb1678-12" tabindex="-1"></a><span class="co"># Import helper functions from functions_models.py</span></span>
<span id="cb1678-13"><a href="response-surface-methodology-in-python.html#cb1678-13" tabindex="-1"></a><span class="im">from</span> functions_models <span class="im">import</span> lm, tidy, glance</span>
<span id="cb1678-14"><a href="response-surface-methodology-in-python.html#cb1678-14" tabindex="-1"></a></span>
<span id="cb1678-15"><a href="response-surface-methodology-in-python.html#cb1678-15" tabindex="-1"></a><span class="co"># Get plasma colormap for use in plots</span></span>
<span id="cb1678-16"><a href="response-surface-methodology-in-python.html#cb1678-16" tabindex="-1"></a>plasma_cmap <span class="op">=</span> cm.get_cmap(<span class="st">&#39;plasma&#39;</span>)</span></code></pre></div>
<p><br>
<br></p>
<div class="figure">
<img src="images/15_cookies_1.jpg" alt="Gingerbread Cookies!
Courtesy of [Casey Chae @ Unsplash](https://unsplash.com/photos/3DrCZblTGoQ)" width="50%" />
<p class="caption">
(#fig:img_intro)Gingerbread Cookies!
Courtesy of <a href="https://unsplash.com/photos/3DrCZblTGoQ">Casey Chae @ Unsplash</a>
</p>
</div>
</div>
<div id="our-data-10" class="section level3 unnumbered hasAnchor">
<h3>Our Data<a href="response-surface-methodology-in-python.html#our-data-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>They know from past research that the amount of <code>molasses</code> and <code>ginger</code> in gingerbread cookies are likely significantly related to the overall tastiness (called the <code>yum</code> factor in our dataset). But, they’re not sure <strong>how much molasses</strong> and <strong>how much ginger</strong> are needed. Molasses can be somewhat <em>expensive</em> too, compared to other ingredients; <em>so they want to optimize the amount of molasses necessary to produce the best cookies.</em></p>
<p>So, holding all other conditions in the recipe constant, they ran a factorial experiment, making 16 batches of cookies (about 20 cookies per <code>batch</code>).</p>
<ul>
<li><p>In their experiment, they tested 4 different amounts of <code>molasses</code>, including <span class="math inline">\(\frac{1}{2}, \ \frac{3}{4}, \ 1,\  \&amp; \ 1 \frac{1}{4}\)</span> cups of <code>molasses</code>.</p></li>
<li><p>They also tested 4 different amounts of <code>ginger</code>, including <span class="math inline">\(\frac{1}{2}, \ 1, \ 1 \frac{1}{2}, \ \&amp; \ 2\)</span> tablespoons of <code>ginger</code>.</p></li>
<li><p>Each batch was randomly assigned one of the 16 unique pairings of amounts of ginger and molasses; there are <span class="math inline">\(4 \times 4 = 16\)</span> unique ways to assign these ingredients, and they included them <em>all</em> to fully account for all the possibilities.</p></li>
<li><p>Then, they randomly handed out cookies to folks on campus in exchange for them briefly ranking the <code>yum</code> factor of that cookie on a scale from <code>0</code> (disgusting!) to <code>100</code> (delicious!).</p></li>
</ul>
<p><br>
<br></p>
</div>
<div id="import-data-2" class="section level3 unnumbered hasAnchor">
<h3>Import Data<a href="response-surface-methodology-in-python.html#import-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>They compiled their data in the following dataset. Read it in to help them analyze their data! This dataset includes the following variables:</p>
<ul>
<li><p><code>id</code>: unique ID for each cookie (320 cookies!)</p></li>
<li><p><code>batch</code>: unique <strong>group</strong> ID for each batch of about 20 cookies.</p></li>
</ul>
<p><strong>Outcome</strong></p>
<ul>
<li><code>yum</code>: numeric scale measuring deliciousness of cookie, from <code>0</code> (disgusting) to <code>100</code> (delicious)</li>
</ul>
<p><strong>Predictors</strong></p>
<ul>
<li><p><code>molasses</code>: cups of <code>molasses</code> in batch: <code>0.75</code>, <code>1</code>, <code>1.25</code>, or <code>1.5</code> cups.</p></li>
<li><p><code>ginger</code>: tablespoons of <code>ginger</code> in batch: <code>0.5</code>, <code>1</code>, <code>1.5</code>, or <code>2</code> tablespoons.</p></li>
</ul>
<p><strong>Fixed Conditions</strong></p>
<ul>
<li><p><code>cinnamon</code>: 1 tablespoon</p></li>
<li><p><code>butter</code>: 1 cup</p></li>
<li><p><code>flour</code>: 3 cups</p></li>
</ul>
<div class="sourceCode" id="cb1679"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1679-1"><a href="response-surface-methodology-in-python.html#cb1679-1" tabindex="-1"></a><span class="co"># Import our data</span></span>
<span id="cb1679-2"><a href="response-surface-methodology-in-python.html#cb1679-2" tabindex="-1"></a>cookies <span class="op">=</span> pd.read_csv(<span class="st">&quot;workshops/gingerbread_test1.csv&quot;</span>)</span>
<span id="cb1679-3"><a href="response-surface-methodology-in-python.html#cb1679-3" tabindex="-1"></a><span class="co"># Check it out!</span></span>
<span id="cb1679-4"><a href="response-surface-methodology-in-python.html#cb1679-4" tabindex="-1"></a>cookies.head()</span></code></pre></div>
<pre><code>##    id  batch  yum  molasses  ginger  cinnamon  butter  flour
## 0  81      5    4      0.75     1.0         1       1      3
## 1  82      5    5      0.75     1.0         1       1      3
## 2  83      5    3      0.75     1.0         1       1      3
## 3  84      5    5      0.75     1.0         1       1      3
## 4  85      5    3      0.75     1.0         1       1      3</code></pre>
<p><br>
<br></p>
</div>
</div>
<div id="models-for-rsm-1" class="section level2 hasAnchor" number="29.1">
<h2><span class="header-section-number">29.1</span> Models for RSM<a href="response-surface-methodology-in-python.html#models-for-rsm-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our previous workshop, we learned to calculate the difference of means for any set of <code>group</code>s (in this case, <code>batch</code> of cookies). When we get <strong>many</strong> different levels in our <code>predictors</code> (eg. not just a treatment and control), we might prefer to use <code>lm()</code> to estimate a <strong>linear model</strong> of our outcome (<code>yum</code>), rather than computing the difference of means many times.</p>
<div id="specifying-an-interaction-model-with-polynomials-1" class="section level3 hasAnchor" number="29.1.1">
<h3><span class="header-section-number">29.1.1</span> Specifying an Interaction Model with Polynomials<a href="response-surface-methodology-in-python.html#specifying-an-interaction-model-with-polynomials-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>However, we will see quickly that different specifications of our model may work better than others. We’re going to try three different models that predict <code>yum</code> using cups of <code>molasses</code> and tablespoons of <code>ginger</code>, and we’ll evaluate the <span class="math inline">\(R^{2}\)</span> of each (% of variation in outcome <code>yum</code> explained by model). These include:</p>
<ol style="list-style-type: decimal">
<li><strong>Basic First-Order Polynomial Model</strong>, where:</li>
</ol>
<p><span class="math display">\[ Yum = \alpha + \beta_{m} X_{m} + \beta_{g} X_{g} \]</span></p>
<ul>
<li><p><span class="math inline">\(B_{m}\)</span> is the effect of a 1 cup increase of Molasses.</p></li>
<li><p><span class="math inline">\(B_{g}\)</span> is the effect of a 1 tablespoon increase of Ginger.</p></li>
</ul>
<div class="sourceCode" id="cb1681"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1681-1"><a href="response-surface-methodology-in-python.html#cb1681-1" tabindex="-1"></a>m1 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses + ginger&#39;</span>, data <span class="op">=</span> cookies)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Interaction Model</strong>, where:</li>
</ol>
<p><span class="math display">\[ Yum = \alpha + \beta_{m} X_{m} + \beta_{g} X_{g} + \beta_{mg} X_{m} X_{g} \]</span></p>
<ul>
<li><span class="math inline">\(B_{mg}\)</span> is the interaction effect as <code>molasses</code> increases by 1 cup <strong>AND</strong> <code>ginger</code> increases by 1 tablespoon.</li>
</ul>
<div class="sourceCode" id="cb1682"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1682-1"><a href="response-surface-methodology-in-python.html#cb1682-1" tabindex="-1"></a>m2 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses * ginger&#39;</span>, data <span class="op">=</span> cookies)</span>
<span id="cb1682-2"><a href="response-surface-methodology-in-python.html#cb1682-2" tabindex="-1"></a><span class="co"># Also written manually as:</span></span>
<span id="cb1682-3"><a href="response-surface-methodology-in-python.html#cb1682-3" tabindex="-1"></a><span class="co"># yum ~ molasses + ginger + molasses:ginger</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Second-Order Polynomial Model with Interaction</strong>, where:</li>
</ol>
<p><span class="math display">\[ Yum = \alpha + \beta_{m} X_{m} + \beta_{g} X_{g} + \beta_{mg} X_{m} X_{g} + \beta_{m^{2}} X_{m}^{2} + \beta_{g^{2}} X_{g}^{2} \]</span>
- <span class="math inline">\(\beta{m^2} X_{m}^{2}\)</span> is the effect as the square of <code>molasses</code> increases by 1.</p>
<ul>
<li>Together, <span class="math inline">\(\beta_{m} X_{m}\)</span> and <span class="math inline">\(\beta_{m^2} X_{m}^{2}\)</span> act as a polynomial term predicting <code>yum</code>.</li>
</ul>
<div class="sourceCode" id="cb1683"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1683-1"><a href="response-surface-methodology-in-python.html#cb1683-1" tabindex="-1"></a><span class="co"># Add polynomial terms using I() in the formula (matching R syntax)</span></span>
<span id="cb1683-2"><a href="response-surface-methodology-in-python.html#cb1683-2" tabindex="-1"></a>m3 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies)</span></code></pre></div>
<p>To review, this model equation can be viewed by just checking the coefficients. We can also write it out below; I’ve rounded to 2 decimal places for simplicity.</p>
<div class="sourceCode" id="cb1684"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1684-1"><a href="response-surface-methodology-in-python.html#cb1684-1" tabindex="-1"></a><span class="co"># Get coefficients rounded to 2 decimal places</span></span>
<span id="cb1684-2"><a href="response-surface-methodology-in-python.html#cb1684-2" tabindex="-1"></a>m3.params.<span class="bu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Intercept           46.64
## molasses           -94.93
## ginger               7.21
## molasses:ginger     -9.79
## I(molasses ** 2)    62.15
## I(ginger ** 2)       0.54
## dtype: float64</code></pre>
<p>The model equation is:</p>
<p><span class="math display">\[ \hat{yum} = \hat{Y} = \alpha + \beta_{m} X_{m} + \beta_{m^{2}} X_{m}^{2} + \beta_{g} X_{g} + \beta_{g^{2}} X_{g}^{2} + \beta_{mg} X_{m} X_{g} \]</span></p>
<p>Let’s evaluate the <span class="math inline">\(R^{2}\)</span> of our three models below using the <code>glance()</code> function from our helper functions in <code>functions/functions_models.py</code>, and combine those DataFrames into one using <code>pd.concat()</code>. We see that the polynomial terms <em>dramatically</em> improve the predictive power of our model.</p>
<div class="sourceCode" id="cb1686"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1686-1"><a href="response-surface-methodology-in-python.html#cb1686-1" tabindex="-1"></a><span class="co"># Get model summaries</span></span>
<span id="cb1686-2"><a href="response-surface-methodology-in-python.html#cb1686-2" tabindex="-1"></a>g1 <span class="op">=</span> glance(m1)</span>
<span id="cb1686-3"><a href="response-surface-methodology-in-python.html#cb1686-3" tabindex="-1"></a>g2 <span class="op">=</span> glance(m2)</span>
<span id="cb1686-4"><a href="response-surface-methodology-in-python.html#cb1686-4" tabindex="-1"></a>g3 <span class="op">=</span> glance(m3)</span>
<span id="cb1686-5"><a href="response-surface-methodology-in-python.html#cb1686-5" tabindex="-1"></a></span>
<span id="cb1686-6"><a href="response-surface-methodology-in-python.html#cb1686-6" tabindex="-1"></a><span class="co"># Combine them</span></span>
<span id="cb1686-7"><a href="response-surface-methodology-in-python.html#cb1686-7" tabindex="-1"></a>model_comparison <span class="op">=</span> pd.concat([g1, g2, g3], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1686-8"><a href="response-surface-methodology-in-python.html#cb1686-8" tabindex="-1"></a>model_comparison.insert(<span class="dv">0</span>, <span class="st">&#39;model&#39;</span>, [<span class="st">&#39;m1&#39;</span>, <span class="st">&#39;m2&#39;</span>, <span class="st">&#39;m3&#39;</span>])</span>
<span id="cb1686-9"><a href="response-surface-methodology-in-python.html#cb1686-9" tabindex="-1"></a>model_comparison</span></code></pre></div>
<pre><code>##   model       rsq   adj_rsq  ...          bic  df.residual   nobs
## 0    m1  0.003773 -0.002513  ...  2192.865469        317.0  320.0
## 1    m2  0.048160  0.039123  ...  2184.048809        316.0  320.0
## 2    m3  0.334834  0.324242  ...  2080.910146        314.0  320.0
## 
## [3 rows x 12 columns]</code></pre>
<p>Not really amazing quality model fit here - and that does happen! We can <code>tidy()</code> our model <code>m3</code> to confirm.</p>
<p>The low <code>p_value</code> for many of our predictors tells us that our predictors <em>do</em> tend to have statistically significant relationships with the <code>yum</code> factor of our cookies. (Admittedly, <code>ginger</code>’s direct effect is not very significant - just ~75% confidence). But, it looks like other factors not currently in our model might <em>also</em> impact <code>yum</code> factor.</p>
<div class="sourceCode" id="cb1688"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1688-1"><a href="response-surface-methodology-in-python.html#cb1688-1" tabindex="-1"></a>m3_tidy <span class="op">=</span> <span class="bu">round</span>(tidy(m3), <span class="dv">2</span>)</span>
<span id="cb1688-2"><a href="response-surface-methodology-in-python.html#cb1688-2" tabindex="-1"></a><span class="bu">print</span>(m3_tidy.to_string())</span></code></pre></div>
<pre><code>##                term  estimate    se  statistic  p_value   lower  upper
## 0         Intercept     46.64  4.85       9.62     0.00   37.10  56.19
## 1          molasses    -94.93  9.80      -9.68     0.00 -114.22 -75.65
## 2            ginger      7.21  3.88       1.86     0.06   -0.42  14.83
## 3   molasses:ginger     -9.79  2.14      -4.58     0.00  -14.00  -5.58
## 4  I(molasses ** 2)     62.15  5.35      11.63     0.00   51.63  72.67
## 5    I(ginger ** 2)      0.54  1.34       0.40     0.69   -2.09   3.17</code></pre>
<p><br>
<br></p>
</div>
<div id="modeling-with-lm" class="section level3 hasAnchor" number="29.1.2">
<h3><span class="header-section-number">29.1.2</span> Modeling with <code>lm()</code><a href="response-surface-methodology-in-python.html#modeling-with-lm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R’s <code>rsm()</code> package has no direct Python equivalent. However, we can achieve the same results by manually specifying polynomial terms in our <code>lm()</code> formulas, as we did above.</p>
<p>Let’s make a simple ‘First-Order’ polynomial: <code>yum ~ molasses + ginger</code> (‘m1’ from above!)</p>
<div class="sourceCode" id="cb1690"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1690-1"><a href="response-surface-methodology-in-python.html#cb1690-1" tabindex="-1"></a>l1 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses + ginger&#39;</span>, data <span class="op">=</span> cookies)</span>
<span id="cb1690-2"><a href="response-surface-methodology-in-python.html#cb1690-2" tabindex="-1"></a><span class="bu">print</span>(l1.params)</span></code></pre></div>
<pre><code>## Intercept    13.948125
## molasses      1.595000
## ginger       -0.012500
## dtype: float64</code></pre>
<div class="sourceCode" id="cb1692"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1692-1"><a href="response-surface-methodology-in-python.html#cb1692-1" tabindex="-1"></a><span class="co"># See if it&#39;s the same as m1</span></span>
<span id="cb1692-2"><a href="response-surface-methodology-in-python.html#cb1692-2" tabindex="-1"></a><span class="bu">print</span>(l1.params <span class="op">==</span> m1.params)</span></code></pre></div>
<pre><code>## Intercept    True
## molasses     True
## ginger       True
## dtype: bool</code></pre>
<p>Let’s make a more complex ‘Second-Order’ polynomial model: <code>yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)</code> (which we did as <code>m3</code>)</p>
<div class="sourceCode" id="cb1694"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1694-1"><a href="response-surface-methodology-in-python.html#cb1694-1" tabindex="-1"></a>l3 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies)</span>
<span id="cb1694-2"><a href="response-surface-methodology-in-python.html#cb1694-2" tabindex="-1"></a><span class="bu">print</span>(l3.params)</span></code></pre></div>
<pre><code>## Intercept           46.64250
## molasses           -94.93250
## ginger               7.20825
## molasses:ginger     -9.78800
## I(molasses ** 2)    62.15000
## I(ginger ** 2)       0.53750
## dtype: float64</code></pre>
<div class="sourceCode" id="cb1696"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1696-1"><a href="response-surface-methodology-in-python.html#cb1696-1" tabindex="-1"></a><span class="co"># See if it&#39;s the same as m1</span></span>
<span id="cb1696-2"><a href="response-surface-methodology-in-python.html#cb1696-2" tabindex="-1"></a><span class="bu">print</span>(l3.params <span class="op">==</span> m3.params)</span></code></pre></div>
<pre><code>## Intercept           True
## molasses            True
## ginger              True
## molasses:ginger     True
## I(molasses ** 2)    True
## I(ginger ** 2)      True
## dtype: bool</code></pre>
<p><br>
<br></p>
</div>
<div id="transforming-variables-1" class="section level3 hasAnchor" number="29.1.3">
<h3><span class="header-section-number">29.1.3</span> Transforming Variables<a href="response-surface-methodology-in-python.html#transforming-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By default, linear models estimate linear relationships between predictors and outcomes, but many relationships are indeed <em>not</em> linear! Here are 8 ways we might model associations!</p>
<p><img src="15_workshop_python_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>A <code>logit</code> function can sometimes help - that is designed for when a variable ranges between 0 and 1; we could write a classic logit as <code>logit = lambda p: np.log(p / (1 - p))</code>.</p>
<div class="sourceCode" id="cb1698"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1698-1"><a href="response-surface-methodology-in-python.html#cb1698-1" tabindex="-1"></a><span class="co"># Write a custom logit function for data from 0 to 100</span></span>
<span id="cb1698-2"><a href="response-surface-methodology-in-python.html#cb1698-2" tabindex="-1"></a><span class="kw">def</span> logit(p):</span>
<span id="cb1698-3"><a href="response-surface-methodology-in-python.html#cb1698-3" tabindex="-1"></a>    <span class="cf">return</span> np.log(p <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> p))</span>
<span id="cb1698-4"><a href="response-surface-methodology-in-python.html#cb1698-4" tabindex="-1"></a></span>
<span id="cb1698-5"><a href="response-surface-methodology-in-python.html#cb1698-5" tabindex="-1"></a><span class="co"># Notice how it ONLY accepts our positive values greater than 0 and less than 1</span></span>
<span id="cb1698-6"><a href="response-surface-methodology-in-python.html#cb1698-6" tabindex="-1"></a>test_vals <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1698-7"><a href="response-surface-methodology-in-python.html#cb1698-7" tabindex="-1"></a>result <span class="op">=</span> [logit(val) <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;</span> val <span class="op">&lt;</span> <span class="dv">1</span> <span class="cf">else</span> np.nan <span class="cf">for</span> val <span class="kw">in</span> test_vals]</span>
<span id="cb1698-8"><a href="response-surface-methodology-in-python.html#cb1698-8" tabindex="-1"></a><span class="bu">print</span>(result)</span></code></pre></div>
<pre><code>## [nan, nan, -2.197224577336219, -1.3862943611198906, 0.0, nan, nan]</code></pre>
<p>Let’s try a few of these strategies for our <code>x</code> and <code>y</code> variables, and see if any of them improve our predictive power (<span class="math inline">\(R^{2}\)</span>). <em>Spoiler alert</em>: In our data, they don’t but in other datasets, they very well might! Always a good thing to check.</p>
<p>For example, we can try transforming the outcome variable, using a standard linear trend (business as usual), a log transformation, or a square root transformation.</p>
<div class="sourceCode" id="cb1700"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1700-1"><a href="response-surface-methodology-in-python.html#cb1700-1" tabindex="-1"></a><span class="co"># Linear (normal)</span></span>
<span id="cb1700-2"><a href="response-surface-methodology-in-python.html#cb1700-2" tabindex="-1"></a>m_linear <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies)</span>
<span id="cb1700-3"><a href="response-surface-methodology-in-python.html#cb1700-3" tabindex="-1"></a>g_linear <span class="op">=</span> glance(m_linear)</span>
<span id="cb1700-4"><a href="response-surface-methodology-in-python.html#cb1700-4" tabindex="-1"></a>R2_linear <span class="op">=</span> g_linear[<span class="st">&#39;rsq&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb1700-5"><a href="response-surface-methodology-in-python.html#cb1700-5" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R2: </span><span class="sc">{</span>R2_linear<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<pre><code>## R2: 0.335</code></pre>
<div class="sourceCode" id="cb1702"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1702-1"><a href="response-surface-methodology-in-python.html#cb1702-1" tabindex="-1"></a><span class="co"># Logged (add 1 since yum contains 0s)</span></span>
<span id="cb1702-2"><a href="response-surface-methodology-in-python.html#cb1702-2" tabindex="-1"></a>cookies_log <span class="op">=</span> cookies.copy()</span>
<span id="cb1702-3"><a href="response-surface-methodology-in-python.html#cb1702-3" tabindex="-1"></a>cookies_log[<span class="st">&#39;log_yum&#39;</span>] <span class="op">=</span> np.log(cookies_log[<span class="st">&#39;yum&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1702-4"><a href="response-surface-methodology-in-python.html#cb1702-4" tabindex="-1"></a>m_log <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;log_yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies_log)</span>
<span id="cb1702-5"><a href="response-surface-methodology-in-python.html#cb1702-5" tabindex="-1"></a>g_log <span class="op">=</span> glance(m_log)</span>
<span id="cb1702-6"><a href="response-surface-methodology-in-python.html#cb1702-6" tabindex="-1"></a>R2_log <span class="op">=</span> g_log[<span class="st">&#39;rsq&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb1702-7"><a href="response-surface-methodology-in-python.html#cb1702-7" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R2 (logged): </span><span class="sc">{</span>R2_log<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span><span class="st">&#39;Worse&#39;</span> <span class="cf">if</span> R2_log <span class="op">&lt;</span> R2_linear <span class="cf">else</span> <span class="st">&#39;Better&#39;</span><span class="sc">}</span><span class="ss">)&quot;</span>)</span></code></pre></div>
<pre><code>## R2 (logged): 0.241 (Worse)</code></pre>
<div class="sourceCode" id="cb1704"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1704-1"><a href="response-surface-methodology-in-python.html#cb1704-1" tabindex="-1"></a><span class="co"># Square Root</span></span>
<span id="cb1704-2"><a href="response-surface-methodology-in-python.html#cb1704-2" tabindex="-1"></a>cookies_sqrt <span class="op">=</span> cookies.copy()</span>
<span id="cb1704-3"><a href="response-surface-methodology-in-python.html#cb1704-3" tabindex="-1"></a>cookies_sqrt[<span class="st">&#39;sqrt_yum&#39;</span>] <span class="op">=</span> np.sqrt(cookies_sqrt[<span class="st">&#39;yum&#39;</span>])</span>
<span id="cb1704-4"><a href="response-surface-methodology-in-python.html#cb1704-4" tabindex="-1"></a>m_sqrt <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;sqrt_yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies_sqrt)</span>
<span id="cb1704-5"><a href="response-surface-methodology-in-python.html#cb1704-5" tabindex="-1"></a>g_sqrt <span class="op">=</span> glance(m_sqrt)</span>
<span id="cb1704-6"><a href="response-surface-methodology-in-python.html#cb1704-6" tabindex="-1"></a>R2_sqrt <span class="op">=</span> g_sqrt[<span class="st">&#39;rsq&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb1704-7"><a href="response-surface-methodology-in-python.html#cb1704-7" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R2 (square root): </span><span class="sc">{</span>R2_sqrt<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span><span class="st">&#39;Worse&#39;</span> <span class="cf">if</span> R2_sqrt <span class="op">&lt;</span> R2_linear <span class="cf">else</span> <span class="st">&#39;Better&#39;</span><span class="sc">}</span><span class="ss">)&quot;</span>)</span></code></pre></div>
<pre><code>## R2 (square root): 0.290 (Worse)</code></pre>
<p>Alternatively, we could try transforming the predictor variables, using a log-transformation.</p>
<div class="sourceCode" id="cb1706"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1706-1"><a href="response-surface-methodology-in-python.html#cb1706-1" tabindex="-1"></a>cookies[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">=</span> np.log(cookies[<span class="st">&#39;molasses&#39;</span>])</span>
<span id="cb1706-2"><a href="response-surface-methodology-in-python.html#cb1706-2" tabindex="-1"></a>cookies[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">=</span> np.log(cookies[<span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1706-3"><a href="response-surface-methodology-in-python.html#cb1706-3" tabindex="-1"></a>cookies[<span class="st">&#39;log_molasses_sq&#39;</span>] <span class="op">=</span> cookies[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1706-4"><a href="response-surface-methodology-in-python.html#cb1706-4" tabindex="-1"></a>cookies[<span class="st">&#39;log_ginger_sq&#39;</span>] <span class="op">=</span> cookies[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1706-5"><a href="response-surface-methodology-in-python.html#cb1706-5" tabindex="-1"></a></span>
<span id="cb1706-6"><a href="response-surface-methodology-in-python.html#cb1706-6" tabindex="-1"></a>m_log_pred <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ log_molasses * log_ginger + log_molasses_sq + log_ginger_sq&#39;</span>, data <span class="op">=</span> cookies)</span>
<span id="cb1706-7"><a href="response-surface-methodology-in-python.html#cb1706-7" tabindex="-1"></a>glance(m_log_pred)</span></code></pre></div>
<pre><code>##         rsq  adj_rsq     sigma  ...          bic  df.residual   nobs
## 0  0.335107  0.32452  5.975476  ...  2080.778411        314.0  320.0
## 
## [1 rows x 11 columns]</code></pre>
<p>It turns out that few of these transformations really dramatically change the predictive power of the model, so I’ll stick with our original models <code>m3</code> for the time being.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="images/15_cookies_3.jpg" alt="A poorly predicted Gingerbread Cookie Photo by Noelle Otto" width="320" />
<p class="caption">
Figure 7.7: A poorly predicted Gingerbread Cookie Photo by Noelle Otto
</p>
</div>
<p><br>
<br></p>
<hr />
</div>
</div>
<div id="learning-check-1-22" class="section level2 unnumbered LC hasAnchor">
<h2>Learning Check 1<a href="response-surface-methodology-in-python.html#learning-check-1-22" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Question</strong></p>
<p>What happens when you (1) square <span class="math inline">\(y\)</span>, (2) cube <span class="math inline">\(y\)</span>, or (3) take the logit of <span class="math inline">\((y + 1) / 100\)</span>? Find the <span class="math inline">\(R^{2}\)</span> for each of these models.</p>
<details>
<summary>
<strong>[View Answer!]</strong>
</summary>
<p>Looks like a linear, business-as-usual modeling strategy for our outcome variable <span class="math inline">\(y\)</span> (<code>yum</code>) is best for this data.</p>
<div class="sourceCode" id="cb1708"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1708-1"><a href="response-surface-methodology-in-python.html#cb1708-1" tabindex="-1"></a><span class="co"># Logit transformation</span></span>
<span id="cb1708-2"><a href="response-surface-methodology-in-python.html#cb1708-2" tabindex="-1"></a>cookies_logit <span class="op">=</span> cookies.copy()</span>
<span id="cb1708-3"><a href="response-surface-methodology-in-python.html#cb1708-3" tabindex="-1"></a>cookies_logit[<span class="st">&#39;yum_scaled&#39;</span>] <span class="op">=</span> (cookies_logit[<span class="st">&#39;yum&#39;</span>] <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb1708-4"><a href="response-surface-methodology-in-python.html#cb1708-4" tabindex="-1"></a>cookies_logit[<span class="st">&#39;logit_yum&#39;</span>] <span class="op">=</span> np.log(cookies_logit[<span class="st">&#39;yum_scaled&#39;</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> cookies_logit[<span class="st">&#39;yum_scaled&#39;</span>]))</span>
<span id="cb1708-5"><a href="response-surface-methodology-in-python.html#cb1708-5" tabindex="-1"></a>m_logit <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;logit_yum ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies_logit)</span>
<span id="cb1708-6"><a href="response-surface-methodology-in-python.html#cb1708-6" tabindex="-1"></a>g_logit <span class="op">=</span> glance(m_logit)</span>
<span id="cb1708-7"><a href="response-surface-methodology-in-python.html#cb1708-7" tabindex="-1"></a>R2_logit <span class="op">=</span> g_logit[<span class="st">&#39;rsq&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb1708-8"><a href="response-surface-methodology-in-python.html#cb1708-8" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R2 (logit): </span><span class="sc">{</span>R2_logit<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span><span class="st">&#39;Worse&#39;</span> <span class="cf">if</span> R2_logit <span class="op">&lt;</span> R2_linear <span class="cf">else</span> <span class="st">&#39;Better&#39;</span><span class="sc">}</span><span class="ss">)&quot;</span>)</span></code></pre></div>
<pre><code>## R2 (logit): 0.258 (Worse)</code></pre>
<div class="sourceCode" id="cb1710"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1710-1"><a href="response-surface-methodology-in-python.html#cb1710-1" tabindex="-1"></a><span class="co"># Squared</span></span>
<span id="cb1710-2"><a href="response-surface-methodology-in-python.html#cb1710-2" tabindex="-1"></a>cookies_sq <span class="op">=</span> cookies.copy()</span>
<span id="cb1710-3"><a href="response-surface-methodology-in-python.html#cb1710-3" tabindex="-1"></a>cookies_sq[<span class="st">&#39;yum_sq&#39;</span>] <span class="op">=</span> cookies_sq[<span class="st">&#39;yum&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1710-4"><a href="response-surface-methodology-in-python.html#cb1710-4" tabindex="-1"></a>m_sq <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum_sq ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies_sq)</span>
<span id="cb1710-5"><a href="response-surface-methodology-in-python.html#cb1710-5" tabindex="-1"></a>g_sq <span class="op">=</span> glance(m_sq)</span>
<span id="cb1710-6"><a href="response-surface-methodology-in-python.html#cb1710-6" tabindex="-1"></a>R2_sq <span class="op">=</span> g_sq[<span class="st">&#39;rsq&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb1710-7"><a href="response-surface-methodology-in-python.html#cb1710-7" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R2 (squared): </span><span class="sc">{</span>R2_sq<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span><span class="st">&#39;Worse&#39;</span> <span class="cf">if</span> R2_sq <span class="op">&lt;</span> R2_linear <span class="cf">else</span> <span class="st">&#39;Better&#39;</span><span class="sc">}</span><span class="ss">)&quot;</span>)</span></code></pre></div>
<pre><code>## R2 (squared): 0.326 (Worse)</code></pre>
<div class="sourceCode" id="cb1712"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1712-1"><a href="response-surface-methodology-in-python.html#cb1712-1" tabindex="-1"></a><span class="co"># Cubed</span></span>
<span id="cb1712-2"><a href="response-surface-methodology-in-python.html#cb1712-2" tabindex="-1"></a>cookies_cubed <span class="op">=</span> cookies.copy()</span>
<span id="cb1712-3"><a href="response-surface-methodology-in-python.html#cb1712-3" tabindex="-1"></a>cookies_cubed[<span class="st">&#39;yum_cubed&#39;</span>] <span class="op">=</span> cookies_cubed[<span class="st">&#39;yum&#39;</span>] <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb1712-4"><a href="response-surface-methodology-in-python.html#cb1712-4" tabindex="-1"></a>m_cubed <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum_cubed ~ molasses * ginger + I(molasses**2) + I(ginger**2)&#39;</span>, data <span class="op">=</span> cookies_cubed)</span>
<span id="cb1712-5"><a href="response-surface-methodology-in-python.html#cb1712-5" tabindex="-1"></a>g_cubed <span class="op">=</span> glance(m_cubed)</span>
<span id="cb1712-6"><a href="response-surface-methodology-in-python.html#cb1712-6" tabindex="-1"></a>R2_cubed <span class="op">=</span> g_cubed[<span class="st">&#39;rsq&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb1712-7"><a href="response-surface-methodology-in-python.html#cb1712-7" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R2 (cubed): </span><span class="sc">{</span>R2_cubed<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span><span class="st">&#39;Worse&#39;</span> <span class="cf">if</span> R2_cubed <span class="op">&lt;</span> R2_linear <span class="cf">else</span> <span class="st">&#39;Better&#39;</span><span class="sc">}</span><span class="ss">)&quot;</span>)</span></code></pre></div>
<pre><code>## R2 (cubed): 0.287 (Worse)</code></pre>
</details>
<hr />
<p><br>
<br></p>
</div>
<div id="contour-plots-1" class="section level2 hasAnchor" number="29.2">
<h2><span class="header-section-number">29.2</span> Contour Plots<a href="response-surface-methodology-in-python.html#contour-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So now that we have this model, what do we do with it? <strong>Response Surface Methodology</strong> refers to using statistical models to predict an outcome (a.k.a. <strong>response</strong> variable) given a series of varying conditions. This lets us predict and visualize the <strong>full range/surface</strong> for that outcome.</p>
<p><br></p>
<div id="simple-contour-plots-1" class="section level3 hasAnchor" number="29.2.1">
<h3><span class="header-section-number">29.2.1</span> Simple <code>contour()</code> plots<a href="response-surface-methodology-in-python.html#simple-contour-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The easiest way to think of this is in 3-dimensions, meaning 3 variables (1 outcome and 2 predictors). A regression model traditionally finds us the <em>plane</em> of best fit when looking at 3 dimensions, or the <em>hyperplane</em> of best fit when looking at +4 dimensions. However, when we use <em>polynomial terms</em> in our model equation, we can map that plane <em>almost perfectly</em> to our observed data, creating more of a <em>contour</em> or <em>topographical</em> surface than a <em>simple plane</em>.</p>
<p>We can use our model object <code>m3</code> from above to generate a contour-like plot, predicting the <code>yum</code> factor (shown by color) while we vary <code>molasses</code> and <code>ginger</code> levels. Our model predicts that middling levels of ginger and molasses produce a kind of sad coldspot where the <code>yum</code> factor is about <code>11</code> (middle), but our model projects the <code>yum</code> factor will increase when you increase <code>ginger</code> and/or <code>molasses</code> from that center amount.</p>
<p><img src="matplotlib_figures/15_contour_demo.png" width="100%" /></p>
<p>That’s beautiful - but a little unclear how it was produced! How could we make that plot ourselves?</p>
<p><br></p>
</div>
<div id="simple-contour-plots-with-plotnine" class="section level3 hasAnchor" number="29.2.2">
<h3><span class="header-section-number">29.2.2</span> Simple contour plots with <code>plotnine</code><a href="response-surface-methodology-in-python.html#simple-contour-plots-with-plotnine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can create contour plots using <code>plotnine</code> (which follows the <code>ggplot2</code> framework). It’s really quick! We need to (1) make a grid of predictor values to feed to <code>predict()</code>, (2) extract the predicted <code>yum</code> values (usually called <code>yhat</code>), and (3) then visualize the result with <code>plotnine</code>!</p>
<div class="sourceCode" id="cb1714"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1714-1"><a href="response-surface-methodology-in-python.html#cb1714-1" tabindex="-1"></a><span class="co"># Let&#39;s check the range of our predictors... </span></span>
<span id="cb1714-2"><a href="response-surface-methodology-in-python.html#cb1714-2" tabindex="-1"></a><span class="bu">print</span>(cookies[<span class="st">&#39;molasses&#39;</span>].<span class="bu">min</span>(), cookies[<span class="st">&#39;molasses&#39;</span>].<span class="bu">max</span>())</span></code></pre></div>
<pre><code>## 0.5 1.25</code></pre>
<div class="sourceCode" id="cb1716"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1716-1"><a href="response-surface-methodology-in-python.html#cb1716-1" tabindex="-1"></a><span class="bu">print</span>(cookies[<span class="st">&#39;ginger&#39;</span>].<span class="bu">min</span>(), cookies[<span class="st">&#39;ginger&#39;</span>].<span class="bu">max</span>())</span></code></pre></div>
<pre><code>## 0.5 2.0</code></pre>
<div class="sourceCode" id="cb1718"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1718-1"><a href="response-surface-methodology-in-python.html#cb1718-1" tabindex="-1"></a><span class="co"># Great! So we could vary our ingredient amounts from 0 to ~5 while still being realistic.</span></span></code></pre></div>
<p><strong>Step 1</strong>: We’ll create a grid of molasses and ginger values, called <code>myx</code>, where <code>molasses</code> spans its observed range and <code>ginger</code> spans its own observed range.</p>
<div class="sourceCode" id="cb1719"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1719-1"><a href="response-surface-methodology-in-python.html#cb1719-1" tabindex="-1"></a><span class="co"># Make the grid of conditions!</span></span>
<span id="cb1719-2"><a href="response-surface-methodology-in-python.html#cb1719-2" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb1719-3"><a href="response-surface-methodology-in-python.html#cb1719-3" tabindex="-1"></a></span>
<span id="cb1719-4"><a href="response-surface-methodology-in-python.html#cb1719-4" tabindex="-1"></a>molasses_seq <span class="op">=</span> np.linspace(cookies[<span class="st">&#39;molasses&#39;</span>].<span class="bu">min</span>(), cookies[<span class="st">&#39;molasses&#39;</span>].<span class="bu">max</span>(), <span class="dv">50</span>)</span>
<span id="cb1719-5"><a href="response-surface-methodology-in-python.html#cb1719-5" tabindex="-1"></a>ginger_seq <span class="op">=</span> np.linspace(cookies[<span class="st">&#39;ginger&#39;</span>].<span class="bu">min</span>(), cookies[<span class="st">&#39;ginger&#39;</span>].<span class="bu">max</span>(), <span class="dv">50</span>)</span>
<span id="cb1719-6"><a href="response-surface-methodology-in-python.html#cb1719-6" tabindex="-1"></a></span>
<span id="cb1719-7"><a href="response-surface-methodology-in-python.html#cb1719-7" tabindex="-1"></a><span class="co"># Create all combinations</span></span>
<span id="cb1719-8"><a href="response-surface-methodology-in-python.html#cb1719-8" tabindex="-1"></a>myx <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(product(molasses_seq, ginger_seq)), </span>
<span id="cb1719-9"><a href="response-surface-methodology-in-python.html#cb1719-9" tabindex="-1"></a>                    columns<span class="op">=</span>[<span class="st">&#39;molasses&#39;</span>, <span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1719-10"><a href="response-surface-methodology-in-python.html#cb1719-10" tabindex="-1"></a></span>
<span id="cb1719-11"><a href="response-surface-methodology-in-python.html#cb1719-11" tabindex="-1"></a><span class="co"># Optionally, you could pick some arbitrary ranges, like 0 to 5</span></span>
<span id="cb1719-12"><a href="response-surface-methodology-in-python.html#cb1719-12" tabindex="-1"></a><span class="co"># molasses_seq = np.linspace(0, 5, 50)</span></span>
<span id="cb1719-13"><a href="response-surface-methodology-in-python.html#cb1719-13" tabindex="-1"></a><span class="co"># ginger_seq = np.linspace(0, 3, 50)</span></span>
<span id="cb1719-14"><a href="response-surface-methodology-in-python.html#cb1719-14" tabindex="-1"></a></span>
<span id="cb1719-15"><a href="response-surface-methodology-in-python.html#cb1719-15" tabindex="-1"></a><span class="co"># Check it out!</span></span>
<span id="cb1719-16"><a href="response-surface-methodology-in-python.html#cb1719-16" tabindex="-1"></a>myx.head()</span></code></pre></div>
<pre><code>##    molasses    ginger
## 0       0.5  0.500000
## 1       0.5  0.530612
## 2       0.5  0.561224
## 3       0.5  0.591837
## 4       0.5  0.622449</code></pre>
<p><em>Note</em>: You have to pick these values!! (eg. 0 to 5, 0 to 3, etc.) We want to make predictions slightly <em>beyond</em> our observed data. Just remember, a grid of 20 by 20 items produces 400 cells; 100 by 100 produces 10,000 cells; etc. Once you get above a few 1000, plotting may start to slow down quickly.</p>
<p><strong>Step 2</strong>: Next, we’ll add a column <code>yhat</code> to our <code>myx</code> DataFrame. In that column, we <code>predict()</code> the <code>yum</code> factor for those conditions based on our model <code>m3</code>. We must give <code>predict()</code> a DataFrame containing hypothetical values of each predictor in our model, called <code>new_data</code>. We’ll save the result in a DataFrame called <code>mypred</code>.</p>
<div class="sourceCode" id="cb1721"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1721-1"><a href="response-surface-methodology-in-python.html#cb1721-1" tabindex="-1"></a><span class="co"># Make predictions!</span></span>
<span id="cb1721-2"><a href="response-surface-methodology-in-python.html#cb1721-2" tabindex="-1"></a><span class="co"># patsy will automatically evaluate I(molasses**2) and I(ginger**2) from the model formula</span></span>
<span id="cb1721-3"><a href="response-surface-methodology-in-python.html#cb1721-3" tabindex="-1"></a>mypred <span class="op">=</span> myx.copy()</span>
<span id="cb1721-4"><a href="response-surface-methodology-in-python.html#cb1721-4" tabindex="-1"></a>mypred[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> m3.predict(mypred)</span>
<span id="cb1721-5"><a href="response-surface-methodology-in-python.html#cb1721-5" tabindex="-1"></a></span>
<span id="cb1721-6"><a href="response-surface-methodology-in-python.html#cb1721-6" tabindex="-1"></a><span class="co"># Check it out!</span></span>
<span id="cb1721-7"><a href="response-surface-methodology-in-python.html#cb1721-7" tabindex="-1"></a>mypred.head()</span></code></pre></div>
<pre><code>##    molasses    ginger       yhat
## 0       0.5  0.500000  16.005250
## 1       0.5  0.530612  16.093052
## 2       0.5  0.561224  16.181862
## 3       0.5  0.591837  16.271679
## 4       0.5  0.622449  16.362503</code></pre>
<p><strong>Step 3</strong>: Finally, we’ll visualize it using <code>plotnine</code>’s <code>geom_tile()</code> to create a simple heatmap-style contour plot.</p>
<div class="sourceCode" id="cb1723"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1723-1"><a href="response-surface-methodology-in-python.html#cb1723-1" tabindex="-1"></a><span class="co"># Create a simple tile plot with plotnine</span></span>
<span id="cb1723-2"><a href="response-surface-methodology-in-python.html#cb1723-2" tabindex="-1"></a>g <span class="op">=</span> (ggplot(mypred, aes(x<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, y<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, fill<span class="op">=</span><span class="st">&#39;yhat&#39;</span>)) <span class="op">+</span></span>
<span id="cb1723-3"><a href="response-surface-methodology-in-python.html#cb1723-3" tabindex="-1"></a>      geom_tile() <span class="op">+</span></span>
<span id="cb1723-4"><a href="response-surface-methodology-in-python.html#cb1723-4" tabindex="-1"></a>      scale_fill_cmap(cmap_name<span class="op">=</span><span class="st">&#39;plasma&#39;</span>) <span class="op">+</span></span>
<span id="cb1723-5"><a href="response-surface-methodology-in-python.html#cb1723-5" tabindex="-1"></a>      theme_classic(base_size<span class="op">=</span><span class="dv">14</span>) <span class="op">+</span></span>
<span id="cb1723-6"><a href="response-surface-methodology-in-python.html#cb1723-6" tabindex="-1"></a>      labs(x<span class="op">=</span><span class="st">&#39;Molasses (cups)&#39;</span>, y<span class="op">=</span><span class="st">&#39;Ginger (tablespoons)&#39;</span>, </span>
<span id="cb1723-7"><a href="response-surface-methodology-in-python.html#cb1723-7" tabindex="-1"></a>           fill<span class="op">=</span><span class="st">&#39;Predicted</span><span class="ch">\n</span><span class="st">Yum</span><span class="ch">\n</span><span class="st">Factor&#39;</span>,</span>
<span id="cb1723-8"><a href="response-surface-methodology-in-python.html#cb1723-8" tabindex="-1"></a>           subtitle<span class="op">=</span><span class="st">&#39;Contour of Predicted Gingerbread Cookie Tastiness&#39;</span>))</span>
<span id="cb1723-9"><a href="response-surface-methodology-in-python.html#cb1723-9" tabindex="-1"></a><span class="co"># Save the plot for display</span></span>
<span id="cb1723-10"><a href="response-surface-methodology-in-python.html#cb1723-10" tabindex="-1"></a>ggsave(g, filename<span class="op">=</span><span class="st">&quot;plotnine_figures/15_contour_tile.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, width<span class="op">=</span><span class="dv">8</span>, height<span class="op">=</span><span class="dv">6</span>)</span></code></pre></div>
<p><img src="plotnine_figures/15_contour_tile.png" width="100%" /></p>
<p>This creates a simple heatmap-style visualization that’s easy to understand!</p>
<p><br>
<br></p>
</div>
<div id="more-detailed-contour-plots-with-matplotlib" class="section level3 hasAnchor" number="29.2.3">
<h3><span class="header-section-number">29.2.3</span> More detailed contour plots with <code>matplotlib</code><a href="response-surface-methodology-in-python.html#more-detailed-contour-plots-with-matplotlib" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>But can we make this prettier and clearer for our reader? <code>matplotlib</code> can give us greater flexibility when designing and communicating information. We can create more detailed contour plots with filled contours, contour lines, and labels that make it easier to read specific values. Let’s see how to do this with <code>matplotlib</code>:</p>
<p><strong>Step 1</strong>: We’ll use the same grid <code>myx</code> and predictions <code>mypred</code> from above.</p>
<p><strong>Step 2</strong>: We need to reshape the data for matplotlib’s contour plotting functions, which require data in a specific grid format.</p>
<div class="sourceCode" id="cb1724"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1724-1"><a href="response-surface-methodology-in-python.html#cb1724-1" tabindex="-1"></a><span class="co"># Reshape data for matplotlib contour plotting</span></span>
<span id="cb1724-2"><a href="response-surface-methodology-in-python.html#cb1724-2" tabindex="-1"></a><span class="co"># Get unique molasses values and sort them for consistent ordering</span></span>
<span id="cb1724-3"><a href="response-surface-methodology-in-python.html#cb1724-3" tabindex="-1"></a>molasses_unique <span class="op">=</span> <span class="bu">sorted</span>(mypred[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1724-4"><a href="response-surface-methodology-in-python.html#cb1724-4" tabindex="-1"></a><span class="co"># Get unique ginger values and sort them for consistent ordering</span></span>
<span id="cb1724-5"><a href="response-surface-methodology-in-python.html#cb1724-5" tabindex="-1"></a>ginger_unique <span class="op">=</span> <span class="bu">sorted</span>(mypred[<span class="st">&#39;ginger&#39;</span>].unique())</span>
<span id="cb1724-6"><a href="response-surface-methodology-in-python.html#cb1724-6" tabindex="-1"></a><span class="co"># Create coordinate grids from the unique values (needed for contour plotting)</span></span>
<span id="cb1724-7"><a href="response-surface-methodology-in-python.html#cb1724-7" tabindex="-1"></a>M, G <span class="op">=</span> np.meshgrid(molasses_unique, ginger_unique)</span>
<span id="cb1724-8"><a href="response-surface-methodology-in-python.html#cb1724-8" tabindex="-1"></a><span class="co"># Reshape predictions into a 2D grid matching the coordinate grids</span></span>
<span id="cb1724-9"><a href="response-surface-methodology-in-python.html#cb1724-9" tabindex="-1"></a>yhat_grid <span class="op">=</span> mypred.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span></code></pre></div>
<p><strong>Step 3</strong>: Now we’ll create a more detailed contour plot with filled contours, contour lines, and labels.</p>
<div class="sourceCode" id="cb1725"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1725-1"><a href="response-surface-methodology-in-python.html#cb1725-1" tabindex="-1"></a><span class="co"># Create the contour plot with matplotlib</span></span>
<span id="cb1725-2"><a href="response-surface-methodology-in-python.html#cb1725-2" tabindex="-1"></a><span class="co"># Initialize a figure and axes with specified size (8 inches wide, 6 inches tall)</span></span>
<span id="cb1725-3"><a href="response-surface-methodology-in-python.html#cb1725-3" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb1725-4"><a href="response-surface-methodology-in-python.html#cb1725-4" tabindex="-1"></a><span class="co"># Create filled contour plot with 15 levels using the &#39;plasma&#39; colormap, 80% opacity</span></span>
<span id="cb1725-5"><a href="response-surface-methodology-in-python.html#cb1725-5" tabindex="-1"></a>contour_filled <span class="op">=</span> ax.contourf(M, G, yhat_grid, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb1725-6"><a href="response-surface-methodology-in-python.html#cb1725-6" tabindex="-1"></a><span class="co"># Add contour line overlays with 10 levels in white, 60% opacity</span></span>
<span id="cb1725-7"><a href="response-surface-methodology-in-python.html#cb1725-7" tabindex="-1"></a>contour_lines <span class="op">=</span> ax.contour(M, G, yhat_grid, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1725-8"><a href="response-surface-methodology-in-python.html#cb1725-8" tabindex="-1"></a><span class="co"># Add labels to the contour lines, formatted to 1 decimal place</span></span>
<span id="cb1725-9"><a href="response-surface-methodology-in-python.html#cb1725-9" tabindex="-1"></a>ax.clabel(contour_lines, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">8</span>, fmt<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f</span><span class="st">&#39;</span>)</span>
<span id="cb1725-10"><a href="response-surface-methodology-in-python.html#cb1725-10" tabindex="-1"></a><span class="co"># Set the x-axis label</span></span>
<span id="cb1725-11"><a href="response-surface-methodology-in-python.html#cb1725-11" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1725-12"><a href="response-surface-methodology-in-python.html#cb1725-12" tabindex="-1"></a><span class="co"># Set the y-axis label</span></span>
<span id="cb1725-13"><a href="response-surface-methodology-in-python.html#cb1725-13" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Ginger (tablespoons)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1725-14"><a href="response-surface-methodology-in-python.html#cb1725-14" tabindex="-1"></a><span class="co"># Add a colorbar to show the scale of predicted values</span></span>
<span id="cb1725-15"><a href="response-surface-methodology-in-python.html#cb1725-15" tabindex="-1"></a>cbar <span class="op">=</span> plt.colorbar(contour_filled, ax<span class="op">=</span>ax)</span>
<span id="cb1725-16"><a href="response-surface-methodology-in-python.html#cb1725-16" tabindex="-1"></a><span class="co"># Set the colorbar label with line breaks</span></span>
<span id="cb1725-17"><a href="response-surface-methodology-in-python.html#cb1725-17" tabindex="-1"></a>cbar.set_label(<span class="st">&#39;Predicted</span><span class="ch">\n</span><span class="st">Yum</span><span class="ch">\n</span><span class="st">Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1725-18"><a href="response-surface-methodology-in-python.html#cb1725-18" tabindex="-1"></a><span class="co"># Adjust layout to prevent label cutoff</span></span>
<span id="cb1725-19"><a href="response-surface-methodology-in-python.html#cb1725-19" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1725-20"><a href="response-surface-methodology-in-python.html#cb1725-20" tabindex="-1"></a></span>
<span id="cb1725-21"><a href="response-surface-methodology-in-python.html#cb1725-21" tabindex="-1"></a><span class="co"># Save the figure</span></span>
<span id="cb1725-22"><a href="response-surface-methodology-in-python.html#cb1725-22" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_contour_with_lines.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1725-23"><a href="response-surface-methodology-in-python.html#cb1725-23" tabindex="-1"></a>plt.close(fig)</span></code></pre></div>
<p><img src="matplotlib_figures/15_contour_with_lines.png" width="100%" /></p>
<p>This creates a more detailed visualization with contour lines and labels that make it easier to read specific values!</p>
<p>Beautiful!</p>
<p><br>
<br></p>
</div>
<div id="one-step-rsm-in-matplotlib" class="section level3 hasAnchor" number="29.2.4">
<h3><span class="header-section-number">29.2.4</span> One-step RSM in <code>matplotlib</code><a href="response-surface-methodology-in-python.html#one-step-rsm-in-matplotlib" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, let’s practice doing this in one code chunk in <code>matplotlib</code>.</p>
<div class="sourceCode" id="cb1726"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1726-1"><a href="response-surface-methodology-in-python.html#cb1726-1" tabindex="-1"></a><span class="co"># Create sequences of predictor values (expanding beyond observed range)</span></span>
<span id="cb1726-2"><a href="response-surface-methodology-in-python.html#cb1726-2" tabindex="-1"></a>molasses_seq2 <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb1726-3"><a href="response-surface-methodology-in-python.html#cb1726-3" tabindex="-1"></a>ginger_seq2 <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb1726-4"><a href="response-surface-methodology-in-python.html#cb1726-4" tabindex="-1"></a></span>
<span id="cb1726-5"><a href="response-surface-methodology-in-python.html#cb1726-5" tabindex="-1"></a><span class="co"># Create grid of all combinations (50 × 50 = 2,500 rows)</span></span>
<span id="cb1726-6"><a href="response-surface-methodology-in-python.html#cb1726-6" tabindex="-1"></a>mypred2 <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(product(molasses_seq2, ginger_seq2)), </span>
<span id="cb1726-7"><a href="response-surface-methodology-in-python.html#cb1726-7" tabindex="-1"></a>                       columns<span class="op">=</span>[<span class="st">&#39;molasses&#39;</span>, <span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1726-8"><a href="response-surface-methodology-in-python.html#cb1726-8" tabindex="-1"></a><span class="co"># Generate predictions using our fitted model (patsy will automatically evaluate I() terms)</span></span>
<span id="cb1726-9"><a href="response-surface-methodology-in-python.html#cb1726-9" tabindex="-1"></a>mypred2[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> m3.predict(mypred2)</span>
<span id="cb1726-10"><a href="response-surface-methodology-in-python.html#cb1726-10" tabindex="-1"></a></span>
<span id="cb1726-11"><a href="response-surface-methodology-in-python.html#cb1726-11" tabindex="-1"></a><span class="co"># Reshape data for matplotlib contour plotting</span></span>
<span id="cb1726-12"><a href="response-surface-methodology-in-python.html#cb1726-12" tabindex="-1"></a>molasses_unique2 <span class="op">=</span> <span class="bu">sorted</span>(mypred2[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1726-13"><a href="response-surface-methodology-in-python.html#cb1726-13" tabindex="-1"></a>ginger_unique2 <span class="op">=</span> <span class="bu">sorted</span>(mypred2[<span class="st">&#39;ginger&#39;</span>].unique())</span>
<span id="cb1726-14"><a href="response-surface-methodology-in-python.html#cb1726-14" tabindex="-1"></a>M2, G2 <span class="op">=</span> np.meshgrid(molasses_unique2, ginger_unique2)</span>
<span id="cb1726-15"><a href="response-surface-methodology-in-python.html#cb1726-15" tabindex="-1"></a>yhat_grid2 <span class="op">=</span> mypred2.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span>
<span id="cb1726-16"><a href="response-surface-methodology-in-python.html#cb1726-16" tabindex="-1"></a></span>
<span id="cb1726-17"><a href="response-surface-methodology-in-python.html#cb1726-17" tabindex="-1"></a><span class="co"># Create the visualization with matplotlib</span></span>
<span id="cb1726-18"><a href="response-surface-methodology-in-python.html#cb1726-18" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb1726-19"><a href="response-surface-methodology-in-python.html#cb1726-19" tabindex="-1"></a>contour_filled2 <span class="op">=</span> ax2.contourf(M2, G2, yhat_grid2, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb1726-20"><a href="response-surface-methodology-in-python.html#cb1726-20" tabindex="-1"></a>contour_lines2 <span class="op">=</span> ax2.contour(M2, G2, yhat_grid2, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1726-21"><a href="response-surface-methodology-in-python.html#cb1726-21" tabindex="-1"></a>ax2.clabel(contour_lines2, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">8</span>, fmt<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f</span><span class="st">&#39;</span>)</span>
<span id="cb1726-22"><a href="response-surface-methodology-in-python.html#cb1726-22" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1726-23"><a href="response-surface-methodology-in-python.html#cb1726-23" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Ginger (tablespoons)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1726-24"><a href="response-surface-methodology-in-python.html#cb1726-24" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Contour of Predicted Gingerbread Cookie Tastiness&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb1726-25"><a href="response-surface-methodology-in-python.html#cb1726-25" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(contour_filled2, ax<span class="op">=</span>ax2)</span>
<span id="cb1726-26"><a href="response-surface-methodology-in-python.html#cb1726-26" tabindex="-1"></a>cbar2.set_label(<span class="st">&#39;Predicted</span><span class="ch">\n</span><span class="st">Yum</span><span class="ch">\n</span><span class="st">Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1726-27"><a href="response-surface-methodology-in-python.html#cb1726-27" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1726-28"><a href="response-surface-methodology-in-python.html#cb1726-28" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb1726-29"><a href="response-surface-methodology-in-python.html#cb1726-29" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_contour_onestep.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1726-30"><a href="response-surface-methodology-in-python.html#cb1726-30" tabindex="-1"></a>plt.close(fig2)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="matplotlib_figures/15_contour_onestep.png" alt="One-step RSM contour plot" width="100%" />
<p class="caption">
Figure 29.1: One-step RSM contour plot
</p>
</div>
<p>Excellent! Our plot can serve as a visual diagnostic. Tentatively, our model results suggest that increasing <code>molasses</code> may lead to considerable gains in our outcome, with <code>ginger</code> contributing some impact early on. Notably, we see that though our actual outcome’s measurement ranged from 0 to 100, our predictions might exceed those limits.</p>
</div>
<div id="more-realistic-plots-1" class="section level3 hasAnchor" number="29.2.5">
<h3><span class="header-section-number">29.2.5</span> More Realistic Plots<a href="response-surface-methodology-in-python.html#more-realistic-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Even though transformations don’t improve our predictive accuracy, they might make our predictions more <em>realistic</em>. Let’s try a few transformations.</p>
<ul>
<li><p>A <code>logit()</code> transformation could help with bounding <code>yum</code> to 0 and 1, if we scale down yum from 0-100 to 0-1. We’ll have to add <code>+1</code> to the <code>yum</code> scale though, because some cookies got a score of zero, which can be logit-transformed.</p></li>
<li><p>A <code>log()</code> transformation to <code>molasses</code> and <code>ginger</code> could help with bounding these conditions to only positive values, since we know we need at least a little of each, and we can’t have ‘negative ginger.’</p></li>
</ul>
<div class="sourceCode" id="cb1727"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1727-1"><a href="response-surface-methodology-in-python.html#cb1727-1" tabindex="-1"></a><span class="co"># Write a quick adjusted logit function</span></span>
<span id="cb1727-2"><a href="response-surface-methodology-in-python.html#cb1727-2" tabindex="-1"></a><span class="kw">def</span> adj_logit(p):</span>
<span id="cb1727-3"><a href="response-surface-methodology-in-python.html#cb1727-3" tabindex="-1"></a>    p <span class="op">=</span> (p <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">100</span>  <span class="co"># adjust p from 0 - 100 to 0 - 1</span></span>
<span id="cb1727-4"><a href="response-surface-methodology-in-python.html#cb1727-4" tabindex="-1"></a>    <span class="cf">return</span> np.log(p <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> p))  <span class="co"># logit transformation</span></span>
<span id="cb1727-5"><a href="response-surface-methodology-in-python.html#cb1727-5" tabindex="-1"></a></span>
<span id="cb1727-6"><a href="response-surface-methodology-in-python.html#cb1727-6" tabindex="-1"></a><span class="co"># Transform outcome and predictors</span></span>
<span id="cb1727-7"><a href="response-surface-methodology-in-python.html#cb1727-7" tabindex="-1"></a>cookies[<span class="st">&#39;adj_logit_yum&#39;</span>] <span class="op">=</span> adj_logit(cookies[<span class="st">&#39;yum&#39;</span>])</span>
<span id="cb1727-8"><a href="response-surface-methodology-in-python.html#cb1727-8" tabindex="-1"></a>cookies[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">=</span> np.log(cookies[<span class="st">&#39;molasses&#39;</span>])</span>
<span id="cb1727-9"><a href="response-surface-methodology-in-python.html#cb1727-9" tabindex="-1"></a>cookies[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">=</span> np.log(cookies[<span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1727-10"><a href="response-surface-methodology-in-python.html#cb1727-10" tabindex="-1"></a>cookies[<span class="st">&#39;log_molasses_sq&#39;</span>] <span class="op">=</span> cookies[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1727-11"><a href="response-surface-methodology-in-python.html#cb1727-11" tabindex="-1"></a>cookies[<span class="st">&#39;log_ginger_sq&#39;</span>] <span class="op">=</span> cookies[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1727-12"><a href="response-surface-methodology-in-python.html#cb1727-12" tabindex="-1"></a></span>
<span id="cb1727-13"><a href="response-surface-methodology-in-python.html#cb1727-13" tabindex="-1"></a>m4 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;adj_logit_yum ~ log_molasses * log_ginger + log_molasses_sq + log_ginger_sq&#39;</span>, </span>
<span id="cb1727-14"><a href="response-surface-methodology-in-python.html#cb1727-14" tabindex="-1"></a>        data <span class="op">=</span> cookies)</span>
<span id="cb1727-15"><a href="response-surface-methodology-in-python.html#cb1727-15" tabindex="-1"></a></span>
<span id="cb1727-16"><a href="response-surface-methodology-in-python.html#cb1727-16" tabindex="-1"></a><span class="co"># Get conditions and predictions</span></span>
<span id="cb1727-17"><a href="response-surface-methodology-in-python.html#cb1727-17" tabindex="-1"></a>molasses_seq3 <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb1727-18"><a href="response-surface-methodology-in-python.html#cb1727-18" tabindex="-1"></a>ginger_seq3 <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb1727-19"><a href="response-surface-methodology-in-python.html#cb1727-19" tabindex="-1"></a></span>
<span id="cb1727-20"><a href="response-surface-methodology-in-python.html#cb1727-20" tabindex="-1"></a>mypred3 <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(product(molasses_seq3, ginger_seq3)), </span>
<span id="cb1727-21"><a href="response-surface-methodology-in-python.html#cb1727-21" tabindex="-1"></a>                       columns<span class="op">=</span>[<span class="st">&#39;molasses&#39;</span>, <span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1727-22"><a href="response-surface-methodology-in-python.html#cb1727-22" tabindex="-1"></a>mypred3[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">=</span> np.log(mypred3[<span class="st">&#39;molasses&#39;</span>])</span>
<span id="cb1727-23"><a href="response-surface-methodology-in-python.html#cb1727-23" tabindex="-1"></a>mypred3[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">=</span> np.log(mypred3[<span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1727-24"><a href="response-surface-methodology-in-python.html#cb1727-24" tabindex="-1"></a>mypred3[<span class="st">&#39;log_molasses_sq&#39;</span>] <span class="op">=</span> mypred3[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1727-25"><a href="response-surface-methodology-in-python.html#cb1727-25" tabindex="-1"></a>mypred3[<span class="st">&#39;log_ginger_sq&#39;</span>] <span class="op">=</span> mypred3[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1727-26"><a href="response-surface-methodology-in-python.html#cb1727-26" tabindex="-1"></a></span>
<span id="cb1727-27"><a href="response-surface-methodology-in-python.html#cb1727-27" tabindex="-1"></a><span class="co"># Predict on log scale</span></span>
<span id="cb1727-28"><a href="response-surface-methodology-in-python.html#cb1727-28" tabindex="-1"></a>mypred3[<span class="st">&#39;yhat_logit&#39;</span>] <span class="op">=</span> m4.predict(mypred3)</span>
<span id="cb1727-29"><a href="response-surface-methodology-in-python.html#cb1727-29" tabindex="-1"></a></span>
<span id="cb1727-30"><a href="response-surface-methodology-in-python.html#cb1727-30" tabindex="-1"></a><span class="co"># Undo the logit transformation!</span></span>
<span id="cb1727-31"><a href="response-surface-methodology-in-python.html#cb1727-31" tabindex="-1"></a>mypred3[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> np.exp(mypred3[<span class="st">&#39;yhat_logit&#39;</span>]) <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(mypred3[<span class="st">&#39;yhat_logit&#39;</span>]))</span>
<span id="cb1727-32"><a href="response-surface-methodology-in-python.html#cb1727-32" tabindex="-1"></a><span class="co"># Undo the (y + 1) / 100 transformation</span></span>
<span id="cb1727-33"><a href="response-surface-methodology-in-python.html#cb1727-33" tabindex="-1"></a>mypred3[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> mypred3[<span class="st">&#39;yhat&#39;</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1727-34"><a href="response-surface-methodology-in-python.html#cb1727-34" tabindex="-1"></a></span>
<span id="cb1727-35"><a href="response-surface-methodology-in-python.html#cb1727-35" tabindex="-1"></a><span class="co"># Reshape data for matplotlib contour plotting</span></span>
<span id="cb1727-36"><a href="response-surface-methodology-in-python.html#cb1727-36" tabindex="-1"></a>molasses_unique3 <span class="op">=</span> <span class="bu">sorted</span>(mypred3[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1727-37"><a href="response-surface-methodology-in-python.html#cb1727-37" tabindex="-1"></a>ginger_unique3 <span class="op">=</span> <span class="bu">sorted</span>(mypred3[<span class="st">&#39;ginger&#39;</span>].unique())</span>
<span id="cb1727-38"><a href="response-surface-methodology-in-python.html#cb1727-38" tabindex="-1"></a>M3, G3 <span class="op">=</span> np.meshgrid(molasses_unique3, ginger_unique3)</span>
<span id="cb1727-39"><a href="response-surface-methodology-in-python.html#cb1727-39" tabindex="-1"></a>yhat_grid3 <span class="op">=</span> mypred3.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span>
<span id="cb1727-40"><a href="response-surface-methodology-in-python.html#cb1727-40" tabindex="-1"></a></span>
<span id="cb1727-41"><a href="response-surface-methodology-in-python.html#cb1727-41" tabindex="-1"></a><span class="co"># Visualize it with matplotlib!</span></span>
<span id="cb1727-42"><a href="response-surface-methodology-in-python.html#cb1727-42" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb1727-43"><a href="response-surface-methodology-in-python.html#cb1727-43" tabindex="-1"></a>contour_filled3 <span class="op">=</span> ax3.contourf(M3, G3, yhat_grid3, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb1727-44"><a href="response-surface-methodology-in-python.html#cb1727-44" tabindex="-1"></a>contour_lines3 <span class="op">=</span> ax3.contour(M3, G3, yhat_grid3, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1727-45"><a href="response-surface-methodology-in-python.html#cb1727-45" tabindex="-1"></a>ax3.clabel(contour_lines3, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">8</span>, fmt<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f</span><span class="st">&#39;</span>)</span>
<span id="cb1727-46"><a href="response-surface-methodology-in-python.html#cb1727-46" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1727-47"><a href="response-surface-methodology-in-python.html#cb1727-47" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Ginger (tablespoons)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1727-48"><a href="response-surface-methodology-in-python.html#cb1727-48" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Contour of Predicted Gingerbread Cookie Tastiness&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb1727-49"><a href="response-surface-methodology-in-python.html#cb1727-49" tabindex="-1"></a>cbar3 <span class="op">=</span> plt.colorbar(contour_filled3, ax<span class="op">=</span>ax3)</span>
<span id="cb1727-50"><a href="response-surface-methodology-in-python.html#cb1727-50" tabindex="-1"></a>cbar3.set_label(<span class="st">&#39;Predicted</span><span class="ch">\n</span><span class="st">Yum</span><span class="ch">\n</span><span class="st">Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1727-51"><a href="response-surface-methodology-in-python.html#cb1727-51" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1727-52"><a href="response-surface-methodology-in-python.html#cb1727-52" tabindex="-1"></a></span>
<span id="cb1727-53"><a href="response-surface-methodology-in-python.html#cb1727-53" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb1727-54"><a href="response-surface-methodology-in-python.html#cb1727-54" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_plot_2.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1727-55"><a href="response-surface-methodology-in-python.html#cb1727-55" tabindex="-1"></a>plt.close(fig3)</span></code></pre></div>
<p><img src="matplotlib_figures/15_plot_2.png" width="100%" /></p>
<p>Ta-da! Now we have much more reasonable predictions, even though we lost 2% predictive power. It’s always a trade-off between predictive power and our ability to generate reasonable, useful quantities of interest. Ideally, let’s get a much better <span class="math inline">\(R^{2}\)</span>!</p>
<p><br>
<br></p>
<hr />
</div>
</div>
<div id="learning-check-2-18" class="section level2 unnumbered LC hasAnchor">
<h2>Learning Check 2<a href="response-surface-methodology-in-python.html#learning-check-2-18" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we expanded our factorial experiment based on this contour plot, adding more permutations of <code>molasses</code> and <code>ginger</code>, such that we now have <code>1280</code> cookies under test! We’ve saved this data in <code>workshops/gingerbread_test2.csv</code>.</p>
<p><strong>Question</strong></p>
<p>Generate a second-order polynomial model like <code>m3</code> and visualize the contour plot in <code>matplotlib</code>. How do our predictions change?</p>
<div class="sourceCode" id="cb1728"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1728-1"><a href="response-surface-methodology-in-python.html#cb1728-1" tabindex="-1"></a>cookies2 <span class="op">=</span> pd.read_csv(<span class="st">&quot;workshops/gingerbread_test2.csv&quot;</span>)</span></code></pre></div>
<details>
<summary>
<strong>[View Answer!]</strong>
</summary>
<div class="sourceCode" id="cb1729"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1729-1"><a href="response-surface-methodology-in-python.html#cb1729-1" tabindex="-1"></a><span class="co"># Check the range</span></span>
<span id="cb1729-2"><a href="response-surface-methodology-in-python.html#cb1729-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Ginger range:&quot;</span>, cookies[<span class="st">&#39;ginger&#39;</span>].<span class="bu">min</span>(), <span class="st">&quot;to&quot;</span>, cookies[<span class="st">&#39;ginger&#39;</span>].<span class="bu">max</span>())</span></code></pre></div>
<pre><code>## Ginger range: 0.5 to 2.0</code></pre>
<div class="sourceCode" id="cb1731"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1731-1"><a href="response-surface-methodology-in-python.html#cb1731-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Molasses range:&quot;</span>, cookies[<span class="st">&#39;molasses&#39;</span>].<span class="bu">min</span>(), <span class="st">&quot;to&quot;</span>, cookies[<span class="st">&#39;molasses&#39;</span>].<span class="bu">max</span>())</span></code></pre></div>
<pre><code>## Molasses range: 0.5 to 1.25</code></pre>
<div class="sourceCode" id="cb1733"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1733-1"><a href="response-surface-methodology-in-python.html#cb1733-1" tabindex="-1"></a><span class="co"># Write a quick adjusted logit function</span></span>
<span id="cb1733-2"><a href="response-surface-methodology-in-python.html#cb1733-2" tabindex="-1"></a><span class="kw">def</span> adj_logit(p):</span>
<span id="cb1733-3"><a href="response-surface-methodology-in-python.html#cb1733-3" tabindex="-1"></a>    p <span class="op">=</span> (p <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">100</span>  <span class="co"># adjust p from 0 - 100 to 0 - 1</span></span>
<span id="cb1733-4"><a href="response-surface-methodology-in-python.html#cb1733-4" tabindex="-1"></a>    <span class="cf">return</span> np.log(p <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> p))  <span class="co"># logit transformation</span></span>
<span id="cb1733-5"><a href="response-surface-methodology-in-python.html#cb1733-5" tabindex="-1"></a></span>
<span id="cb1733-6"><a href="response-surface-methodology-in-python.html#cb1733-6" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb1733-7"><a href="response-surface-methodology-in-python.html#cb1733-7" tabindex="-1"></a>cookies2[<span class="st">&#39;molasses_sq&#39;</span>] <span class="op">=</span> cookies2[<span class="st">&#39;molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1733-8"><a href="response-surface-methodology-in-python.html#cb1733-8" tabindex="-1"></a>cookies2[<span class="st">&#39;ginger_sq&#39;</span>] <span class="op">=</span> cookies2[<span class="st">&#39;ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1733-9"><a href="response-surface-methodology-in-python.html#cb1733-9" tabindex="-1"></a>cookies2[<span class="st">&#39;adj_logit_yum&#39;</span>] <span class="op">=</span> adj_logit(cookies2[<span class="st">&#39;yum&#39;</span>])</span>
<span id="cb1733-10"><a href="response-surface-methodology-in-python.html#cb1733-10" tabindex="-1"></a>cookies2[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">=</span> np.log(cookies2[<span class="st">&#39;molasses&#39;</span>])</span>
<span id="cb1733-11"><a href="response-surface-methodology-in-python.html#cb1733-11" tabindex="-1"></a>cookies2[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">=</span> np.log(cookies2[<span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1733-12"><a href="response-surface-methodology-in-python.html#cb1733-12" tabindex="-1"></a>cookies2[<span class="st">&#39;log_molasses_sq&#39;</span>] <span class="op">=</span> cookies2[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1733-13"><a href="response-surface-methodology-in-python.html#cb1733-13" tabindex="-1"></a>cookies2[<span class="st">&#39;log_ginger_sq&#39;</span>] <span class="op">=</span> cookies2[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1733-14"><a href="response-surface-methodology-in-python.html#cb1733-14" tabindex="-1"></a></span>
<span id="cb1733-15"><a href="response-surface-methodology-in-python.html#cb1733-15" tabindex="-1"></a><span class="co"># Transform outcome and predictors</span></span>
<span id="cb1733-16"><a href="response-surface-methodology-in-python.html#cb1733-16" tabindex="-1"></a>m_lc <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;adj_logit_yum ~ log_molasses * log_ginger + log_molasses_sq + log_ginger_sq&#39;</span>, </span>
<span id="cb1733-17"><a href="response-surface-methodology-in-python.html#cb1733-17" tabindex="-1"></a>          data <span class="op">=</span> cookies2)</span>
<span id="cb1733-18"><a href="response-surface-methodology-in-python.html#cb1733-18" tabindex="-1"></a></span>
<span id="cb1733-19"><a href="response-surface-methodology-in-python.html#cb1733-19" tabindex="-1"></a><span class="co"># Check the R2 (still terrible! whoops!)</span></span>
<span id="cb1733-20"><a href="response-surface-methodology-in-python.html#cb1733-20" tabindex="-1"></a>glance(m_lc)</span></code></pre></div>
<pre><code>##         rsq  adj_rsq     sigma  ...          bic  df.residual    nobs
## 0  0.157427  0.15412  0.557732  ...  2174.670235       1274.0  1280.0
## 
## [1 rows x 11 columns]</code></pre>
<div class="sourceCode" id="cb1735"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1735-1"><a href="response-surface-methodology-in-python.html#cb1735-1" tabindex="-1"></a><span class="co"># Get conditions and predictions</span></span>
<span id="cb1735-2"><a href="response-surface-methodology-in-python.html#cb1735-2" tabindex="-1"></a>molasses_seq_lc <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb1735-3"><a href="response-surface-methodology-in-python.html#cb1735-3" tabindex="-1"></a>ginger_seq_lc <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb1735-4"><a href="response-surface-methodology-in-python.html#cb1735-4" tabindex="-1"></a></span>
<span id="cb1735-5"><a href="response-surface-methodology-in-python.html#cb1735-5" tabindex="-1"></a>mypred_lc <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(product(molasses_seq_lc, ginger_seq_lc)), </span>
<span id="cb1735-6"><a href="response-surface-methodology-in-python.html#cb1735-6" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">&#39;molasses&#39;</span>, <span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1735-7"><a href="response-surface-methodology-in-python.html#cb1735-7" tabindex="-1"></a>mypred_lc[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">=</span> np.log(mypred_lc[<span class="st">&#39;molasses&#39;</span>])</span>
<span id="cb1735-8"><a href="response-surface-methodology-in-python.html#cb1735-8" tabindex="-1"></a>mypred_lc[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">=</span> np.log(mypred_lc[<span class="st">&#39;ginger&#39;</span>])</span>
<span id="cb1735-9"><a href="response-surface-methodology-in-python.html#cb1735-9" tabindex="-1"></a>mypred_lc[<span class="st">&#39;log_molasses_sq&#39;</span>] <span class="op">=</span> mypred_lc[<span class="st">&#39;log_molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1735-10"><a href="response-surface-methodology-in-python.html#cb1735-10" tabindex="-1"></a>mypred_lc[<span class="st">&#39;log_ginger_sq&#39;</span>] <span class="op">=</span> mypred_lc[<span class="st">&#39;log_ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1735-11"><a href="response-surface-methodology-in-python.html#cb1735-11" tabindex="-1"></a></span>
<span id="cb1735-12"><a href="response-surface-methodology-in-python.html#cb1735-12" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb1735-13"><a href="response-surface-methodology-in-python.html#cb1735-13" tabindex="-1"></a>mypred_lc[<span class="st">&#39;yhat_logit&#39;</span>] <span class="op">=</span> m_lc.predict(mypred_lc)</span>
<span id="cb1735-14"><a href="response-surface-methodology-in-python.html#cb1735-14" tabindex="-1"></a><span class="co"># Undo the logit transformation!</span></span>
<span id="cb1735-15"><a href="response-surface-methodology-in-python.html#cb1735-15" tabindex="-1"></a>mypred_lc[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> np.exp(mypred_lc[<span class="st">&#39;yhat_logit&#39;</span>]) <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(mypred_lc[<span class="st">&#39;yhat_logit&#39;</span>]))</span>
<span id="cb1735-16"><a href="response-surface-methodology-in-python.html#cb1735-16" tabindex="-1"></a><span class="co"># Undo the (y + 1) / 100 transformation</span></span>
<span id="cb1735-17"><a href="response-surface-methodology-in-python.html#cb1735-17" tabindex="-1"></a>mypred_lc[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> mypred_lc[<span class="st">&#39;yhat&#39;</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1735-18"><a href="response-surface-methodology-in-python.html#cb1735-18" tabindex="-1"></a></span>
<span id="cb1735-19"><a href="response-surface-methodology-in-python.html#cb1735-19" tabindex="-1"></a><span class="co"># Reshape data for matplotlib contour plotting</span></span>
<span id="cb1735-20"><a href="response-surface-methodology-in-python.html#cb1735-20" tabindex="-1"></a>molasses_unique_lc <span class="op">=</span> <span class="bu">sorted</span>(mypred_lc[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1735-21"><a href="response-surface-methodology-in-python.html#cb1735-21" tabindex="-1"></a>ginger_unique_lc <span class="op">=</span> <span class="bu">sorted</span>(mypred_lc[<span class="st">&#39;ginger&#39;</span>].unique())</span>
<span id="cb1735-22"><a href="response-surface-methodology-in-python.html#cb1735-22" tabindex="-1"></a>M_lc, G_lc <span class="op">=</span> np.meshgrid(molasses_unique_lc, ginger_unique_lc)</span>
<span id="cb1735-23"><a href="response-surface-methodology-in-python.html#cb1735-23" tabindex="-1"></a>yhat_grid_lc <span class="op">=</span> mypred_lc.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span>
<span id="cb1735-24"><a href="response-surface-methodology-in-python.html#cb1735-24" tabindex="-1"></a></span>
<span id="cb1735-25"><a href="response-surface-methodology-in-python.html#cb1735-25" tabindex="-1"></a><span class="co"># Visualize it with matplotlib!</span></span>
<span id="cb1735-26"><a href="response-surface-methodology-in-python.html#cb1735-26" tabindex="-1"></a>fig_lc, ax_lc <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb1735-27"><a href="response-surface-methodology-in-python.html#cb1735-27" tabindex="-1"></a>contour_filled_lc <span class="op">=</span> ax_lc.contourf(M_lc, G_lc, yhat_grid_lc, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb1735-28"><a href="response-surface-methodology-in-python.html#cb1735-28" tabindex="-1"></a>contour_lines_lc <span class="op">=</span> ax_lc.contour(M_lc, G_lc, yhat_grid_lc, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1735-29"><a href="response-surface-methodology-in-python.html#cb1735-29" tabindex="-1"></a>ax_lc.clabel(contour_lines_lc, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">8</span>, fmt<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f</span><span class="st">&#39;</span>)</span>
<span id="cb1735-30"><a href="response-surface-methodology-in-python.html#cb1735-30" tabindex="-1"></a>ax_lc.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1735-31"><a href="response-surface-methodology-in-python.html#cb1735-31" tabindex="-1"></a>ax_lc.set_ylabel(<span class="st">&#39;Ginger (tablespoons)&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1735-32"><a href="response-surface-methodology-in-python.html#cb1735-32" tabindex="-1"></a>ax_lc.set_title(<span class="st">&#39;Contour of Predicted Gingerbread Cookie Tastiness&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb1735-33"><a href="response-surface-methodology-in-python.html#cb1735-33" tabindex="-1"></a>cbar_lc <span class="op">=</span> plt.colorbar(contour_filled_lc, ax<span class="op">=</span>ax_lc)</span>
<span id="cb1735-34"><a href="response-surface-methodology-in-python.html#cb1735-34" tabindex="-1"></a>cbar_lc.set_label(<span class="st">&#39;Predicted</span><span class="ch">\n</span><span class="st">Yum</span><span class="ch">\n</span><span class="st">Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1735-35"><a href="response-surface-methodology-in-python.html#cb1735-35" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1735-36"><a href="response-surface-methodology-in-python.html#cb1735-36" tabindex="-1"></a></span>
<span id="cb1735-37"><a href="response-surface-methodology-in-python.html#cb1735-37" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb1735-38"><a href="response-surface-methodology-in-python.html#cb1735-38" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_learning_check_2.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1735-39"><a href="response-surface-methodology-in-python.html#cb1735-39" tabindex="-1"></a>plt.close(fig_lc)</span></code></pre></div>
<p><img src="matplotlib_figures/15_learning_check_2.png" width="100%" /></p>
<p>Our predictive power is still not quite that good. Ironically, our model (based on fake data) suggests that the best gingerbread cookies you can make should either have <strong>very little molasses</strong> OR <strong>lots of molasses and ginger</strong>, but the payoff for using very little molasses will be higher!</p>
<p>This plot demonstrates how even though your original model <code>m4</code> predicted really high payoff for adding more molasses, when we compare those predictions to updated model predictions based on new experiments, we might find that the new empirical data tempers our earlier predictions.</p>
<p><strong>This is good news</strong>. This probably means that our earlier predictions were <em>not very accurate</em>, and our extra experiments paid off by helping clarify. New results can be <strong>surprising</strong>, but are never a bad thing - because they get you closer to <strong>truth</strong>.</p>
</details>
<hr />
<p><br>
<br></p>
</div>
<div id="iterate-1" class="section level2 hasAnchor" number="29.3">
<h2><span class="header-section-number">29.3</span> Iterate!<a href="response-surface-methodology-in-python.html#iterate-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose now that we expanded our factorial experiment to vary the amount of <code>flour</code>, <code>butter</code>, and <code>cinnamon</code> too! We’ve saved this data in <code>workshops/gingerbread_test3.csv</code>. How would we model this data?</p>
<div class="sourceCode" id="cb1736"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1736-1"><a href="response-surface-methodology-in-python.html#cb1736-1" tabindex="-1"></a>cookies3 <span class="op">=</span> pd.read_csv(<span class="st">&quot;workshops/gingerbread_test3.csv&quot;</span>)</span>
<span id="cb1736-2"><a href="response-surface-methodology-in-python.html#cb1736-2" tabindex="-1"></a>cookies3.head()</span></code></pre></div>
<pre><code>##    id  batch  yum  molasses  ginger  cinnamon  butter  flour
## 0   1      1    6      0.75     1.0       1.0    0.75   2.75
## 1   2      1    0      0.75     1.0       1.0    0.75   2.75
## 2   3      1    3      0.75     1.0       1.0    0.75   2.75
## 3   4      1    4      0.75     1.0       1.0    0.75   2.75
## 4   5      1   10      0.75     1.0       1.0    0.75   2.75</code></pre>
<div id="modeling-many-interactions-1" class="section level3 hasAnchor" number="29.3.1">
<h3><span class="header-section-number">29.3.1</span> Modeling many Interactions<a href="response-surface-methodology-in-python.html#modeling-many-interactions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can make a second-order polynomial for these 5 variables with <code>lm()</code>, like so:</p>
<div class="sourceCode" id="cb1738"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1738-1"><a href="response-surface-methodology-in-python.html#cb1738-1" tabindex="-1"></a><span class="co"># Prepare polynomial terms</span></span>
<span id="cb1738-2"><a href="response-surface-methodology-in-python.html#cb1738-2" tabindex="-1"></a>cookies3[<span class="st">&#39;molasses_sq&#39;</span>] <span class="op">=</span> cookies3[<span class="st">&#39;molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1738-3"><a href="response-surface-methodology-in-python.html#cb1738-3" tabindex="-1"></a>cookies3[<span class="st">&#39;ginger_sq&#39;</span>] <span class="op">=</span> cookies3[<span class="st">&#39;ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1738-4"><a href="response-surface-methodology-in-python.html#cb1738-4" tabindex="-1"></a>cookies3[<span class="st">&#39;cinnamon_sq&#39;</span>] <span class="op">=</span> cookies3[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1738-5"><a href="response-surface-methodology-in-python.html#cb1738-5" tabindex="-1"></a>cookies3[<span class="st">&#39;butter_sq&#39;</span>] <span class="op">=</span> cookies3[<span class="st">&#39;butter&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1738-6"><a href="response-surface-methodology-in-python.html#cb1738-6" tabindex="-1"></a>cookies3[<span class="st">&#39;flour_sq&#39;</span>] <span class="op">=</span> cookies3[<span class="st">&#39;flour&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1738-7"><a href="response-surface-methodology-in-python.html#cb1738-7" tabindex="-1"></a></span>
<span id="cb1738-8"><a href="response-surface-methodology-in-python.html#cb1738-8" tabindex="-1"></a><span class="co"># Model using lm() - note: this creates a very complex model with many interactions</span></span>
<span id="cb1738-9"><a href="response-surface-methodology-in-python.html#cb1738-9" tabindex="-1"></a><span class="co"># For demonstration, we&#39;ll use a simpler version focusing on main effects and key interactions</span></span>
<span id="cb1738-10"><a href="response-surface-methodology-in-python.html#cb1738-10" tabindex="-1"></a>m5 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses * ginger * cinnamon * butter * flour + molasses_sq + ginger_sq + cinnamon_sq + butter_sq + flour_sq&#39;</span>, </span>
<span id="cb1738-11"><a href="response-surface-methodology-in-python.html#cb1738-11" tabindex="-1"></a>        data <span class="op">=</span> cookies3)</span></code></pre></div>
<div class="sourceCode" id="cb1739"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1739-1"><a href="response-surface-methodology-in-python.html#cb1739-1" tabindex="-1"></a><span class="co"># Check out our coefficients! Wow that&#39;s a long list!</span></span>
<span id="cb1739-2"><a href="response-surface-methodology-in-python.html#cb1739-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of coefficients:&quot;</span>, <span class="bu">len</span>(m5.params))</span></code></pre></div>
<pre><code>## Number of coefficients: 37</code></pre>
<div class="sourceCode" id="cb1741"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1741-1"><a href="response-surface-methodology-in-python.html#cb1741-1" tabindex="-1"></a>m5.params.<span class="bu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Intercept                               -44.202
## molasses                                 21.149
## ginger                                   11.681
## molasses:ginger                          -2.255
## cinnamon                                -12.672
## molasses:cinnamon                        14.729
## ginger:cinnamon                           9.096
## molasses:ginger:cinnamon                -10.827
## butter                                   55.345
## molasses:butter                         -18.536
## ginger:butter                           -10.683
## molasses:ginger:butter                   -0.083
## cinnamon:butter                          12.802
## molasses:cinnamon:butter                -18.825
## ginger:cinnamon:butter                  -10.923
## molasses:ginger:cinnamon:butter          12.816
## flour                                    22.688
## molasses:flour                           -8.049
## ginger:flour                             -3.940
## molasses:ginger:flour                     0.728
## cinnamon:flour                            2.461
## molasses:cinnamon:flour                  -4.439
## ginger:cinnamon:flour                    -2.525
## molasses:ginger:cinnamon:flour            3.394
## butter:flour                            -20.872
## molasses:butter:flour                     6.189
## ginger:butter:flour                       3.440
## molasses:ginger:butter:flour              0.195
## cinnamon:butter:flour                    -2.737
## molasses:cinnamon:butter:flour            5.893
## ginger:cinnamon:butter:flour              3.226
## molasses:ginger:cinnamon:butter:flour    -4.162
## molasses_sq                               2.917
## ginger_sq                                 0.121
## cinnamon_sq                               0.301
## butter_sq                                 2.598
## flour_sq                                 -0.411
## dtype: float64</code></pre>
<div class="sourceCode" id="cb1743"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1743-1"><a href="response-surface-methodology-in-python.html#cb1743-1" tabindex="-1"></a><span class="co"># Check predictive power (still pretty bad!)</span></span>
<span id="cb1743-2"><a href="response-surface-methodology-in-python.html#cb1743-2" tabindex="-1"></a>glance(m5)</span></code></pre></div>
<pre><code>##         rsq   adj_rsq     sigma  ...            bic  df.residual     nobs
## 0  0.178806  0.178164  7.117948  ...  312004.685704      46043.0  46080.0
## 
## [1 rows x 11 columns]</code></pre>
<div class="sourceCode" id="cb1745"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1745-1"><a href="response-surface-methodology-in-python.html#cb1745-1" tabindex="-1"></a><span class="co"># Check which variables are significant </span></span>
<span id="cb1745-2"><a href="response-surface-methodology-in-python.html#cb1745-2" tabindex="-1"></a><span class="co"># (if some were not, we might cut them if we wanted to make as parsimonious a model as possible)</span></span>
<span id="cb1745-3"><a href="response-surface-methodology-in-python.html#cb1745-3" tabindex="-1"></a>m5_tidy <span class="op">=</span> tidy(m5)</span>
<span id="cb1745-4"><a href="response-surface-methodology-in-python.html#cb1745-4" tabindex="-1"></a>m5_tidy[m5_tidy[<span class="st">&#39;p_value&#39;</span>] <span class="op">&lt;</span> <span class="fl">0.05</span>].head(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##                                term   estimate  ...     lower      upper
## 15  molasses:ginger:cinnamon:butter  12.816032  ...  0.031075  25.600988
## 32                      molasses_sq   2.916733  ...  2.689815   3.143651
## 33                        ginger_sq   0.120552  ...  0.063823   0.177282
## 34                      cinnamon_sq   0.301215  ...  0.041248   0.561182
## 35                        butter_sq   2.598438  ...  0.392545   4.804330
## 
## [5 rows x 7 columns]</code></pre>
<p><br>
<br></p>
</div>
<div id="contours-with-multiple-variables-1" class="section level3 hasAnchor" number="29.3.2">
<h3><span class="header-section-number">29.3.2</span> Contours with Multiple Variables<a href="response-surface-methodology-in-python.html#contours-with-multiple-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, whenever we analyze contours, since we have more than 2 predictors, we need multiple plots.</p>
<p>For example, let’s examine variation in <code>yum</code> as 3 predictions change simultaneously. These include <code>molasses</code>, <code>ginger</code>, <strong>and</strong> <code>cinnamon</code>.</p>
<p>In Python with <code>matplotlib</code>, we’ll create our own faceted plots using subplots, which gives us more control and clarity.</p>
<p>For example, we want to see 3 panels showing the contours of molasses x ginger when cinnamon = 0, cinnamon = 1, and cinnamon = 2 tablespoons. All other conditions would be held constant, allowing us to see how the contour changes shape. If we hold constant the other values though, we should hold them at <strong>meaningful values</strong>, like the <strong>average</strong> or perhaps a value you know to be sufficient.</p>
<div class="sourceCode" id="cb1747"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1747-1"><a href="response-surface-methodology-in-python.html#cb1747-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Cinnamon range:&quot;</span>, cookies3[<span class="st">&#39;cinnamon&#39;</span>].<span class="bu">min</span>(), <span class="st">&quot;to&quot;</span>, cookies3[<span class="st">&#39;cinnamon&#39;</span>].<span class="bu">max</span>())</span></code></pre></div>
<pre><code>## Cinnamon range: 0.5 to 2.0</code></pre>
<div class="sourceCode" id="cb1749"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1749-1"><a href="response-surface-methodology-in-python.html#cb1749-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Butter mean:&quot;</span>, cookies3[<span class="st">&#39;butter&#39;</span>].mean())</span></code></pre></div>
<pre><code>## Butter mean: 1.0</code></pre>
<div class="sourceCode" id="cb1751"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1751-1"><a href="response-surface-methodology-in-python.html#cb1751-1" tabindex="-1"></a></span>
<span id="cb1751-2"><a href="response-surface-methodology-in-python.html#cb1751-2" tabindex="-1"></a><span class="co"># Get a grid...</span></span>
<span id="cb1751-3"><a href="response-surface-methodology-in-python.html#cb1751-3" tabindex="-1"></a>molasses_grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">30</span>)</span>
<span id="cb1751-4"><a href="response-surface-methodology-in-python.html#cb1751-4" tabindex="-1"></a>ginger_grid <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">30</span>)</span>
<span id="cb1751-5"><a href="response-surface-methodology-in-python.html#cb1751-5" tabindex="-1"></a>cinnamon_vals <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1751-6"><a href="response-surface-methodology-in-python.html#cb1751-6" tabindex="-1"></a></span>
<span id="cb1751-7"><a href="response-surface-methodology-in-python.html#cb1751-7" tabindex="-1"></a><span class="co"># Create grid for each cinnamon value</span></span>
<span id="cb1751-8"><a href="response-surface-methodology-in-python.html#cb1751-8" tabindex="-1"></a>grid_list <span class="op">=</span> []</span>
<span id="cb1751-9"><a href="response-surface-methodology-in-python.html#cb1751-9" tabindex="-1"></a><span class="cf">for</span> cinnamon_val <span class="kw">in</span> cinnamon_vals:</span>
<span id="cb1751-10"><a href="response-surface-methodology-in-python.html#cb1751-10" tabindex="-1"></a>    <span class="cf">for</span> mol, gin <span class="kw">in</span> product(molasses_grid, ginger_grid):</span>
<span id="cb1751-11"><a href="response-surface-methodology-in-python.html#cb1751-11" tabindex="-1"></a>        grid_list.append({</span>
<span id="cb1751-12"><a href="response-surface-methodology-in-python.html#cb1751-12" tabindex="-1"></a>            <span class="st">&#39;molasses&#39;</span>: mol,</span>
<span id="cb1751-13"><a href="response-surface-methodology-in-python.html#cb1751-13" tabindex="-1"></a>            <span class="st">&#39;ginger&#39;</span>: gin,</span>
<span id="cb1751-14"><a href="response-surface-methodology-in-python.html#cb1751-14" tabindex="-1"></a>            <span class="st">&#39;cinnamon&#39;</span>: cinnamon_val,</span>
<span id="cb1751-15"><a href="response-surface-methodology-in-python.html#cb1751-15" tabindex="-1"></a>            <span class="st">&#39;flour&#39;</span>: cookies3[<span class="st">&#39;flour&#39;</span>].mean(),</span>
<span id="cb1751-16"><a href="response-surface-methodology-in-python.html#cb1751-16" tabindex="-1"></a>            <span class="st">&#39;butter&#39;</span>: cookies3[<span class="st">&#39;butter&#39;</span>].mean()</span>
<span id="cb1751-17"><a href="response-surface-methodology-in-python.html#cb1751-17" tabindex="-1"></a>        })</span>
<span id="cb1751-18"><a href="response-surface-methodology-in-python.html#cb1751-18" tabindex="-1"></a></span>
<span id="cb1751-19"><a href="response-surface-methodology-in-python.html#cb1751-19" tabindex="-1"></a>mygrid <span class="op">=</span> pd.DataFrame(grid_list)</span>
<span id="cb1751-20"><a href="response-surface-methodology-in-python.html#cb1751-20" tabindex="-1"></a></span>
<span id="cb1751-21"><a href="response-surface-methodology-in-python.html#cb1751-21" tabindex="-1"></a><span class="co"># Add polynomial terms</span></span>
<span id="cb1751-22"><a href="response-surface-methodology-in-python.html#cb1751-22" tabindex="-1"></a>mygrid[<span class="st">&#39;molasses_sq&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1751-23"><a href="response-surface-methodology-in-python.html#cb1751-23" tabindex="-1"></a>mygrid[<span class="st">&#39;ginger_sq&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1751-24"><a href="response-surface-methodology-in-python.html#cb1751-24" tabindex="-1"></a>mygrid[<span class="st">&#39;cinnamon_sq&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1751-25"><a href="response-surface-methodology-in-python.html#cb1751-25" tabindex="-1"></a>mygrid[<span class="st">&#39;butter_sq&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1751-26"><a href="response-surface-methodology-in-python.html#cb1751-26" tabindex="-1"></a>mygrid[<span class="st">&#39;flour_sq&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;flour&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1751-27"><a href="response-surface-methodology-in-python.html#cb1751-27" tabindex="-1"></a></span>
<span id="cb1751-28"><a href="response-surface-methodology-in-python.html#cb1751-28" tabindex="-1"></a><span class="co"># Then predict your outcome!</span></span>
<span id="cb1751-29"><a href="response-surface-methodology-in-python.html#cb1751-29" tabindex="-1"></a><span class="co"># Note: We need all interaction terms for prediction</span></span>
<span id="cb1751-30"><a href="response-surface-methodology-in-python.html#cb1751-30" tabindex="-1"></a><span class="co"># For simplicity, let&#39;s create the key interaction terms</span></span>
<span id="cb1751-31"><a href="response-surface-methodology-in-python.html#cb1751-31" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>]</span>
<span id="cb1751-32"><a href="response-surface-methodology-in-python.html#cb1751-32" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_cin&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>]</span>
<span id="cb1751-33"><a href="response-surface-methodology-in-python.html#cb1751-33" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_cin&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>]</span>
<span id="cb1751-34"><a href="response-surface-methodology-in-python.html#cb1751-34" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-35"><a href="response-surface-methodology-in-python.html#cb1751-35" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-36"><a href="response-surface-methodology-in-python.html#cb1751-36" tabindex="-1"></a>mygrid[<span class="st">&#39;cin_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-37"><a href="response-surface-methodology-in-python.html#cb1751-37" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-38"><a href="response-surface-methodology-in-python.html#cb1751-38" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-39"><a href="response-surface-methodology-in-python.html#cb1751-39" tabindex="-1"></a>mygrid[<span class="st">&#39;cin_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-40"><a href="response-surface-methodology-in-python.html#cb1751-40" tabindex="-1"></a>mygrid[<span class="st">&#39;but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-41"><a href="response-surface-methodology-in-python.html#cb1751-41" tabindex="-1"></a></span>
<span id="cb1751-42"><a href="response-surface-methodology-in-python.html#cb1751-42" tabindex="-1"></a><span class="co"># Higher order interactions (simplified - full model would have many more)</span></span>
<span id="cb1751-43"><a href="response-surface-methodology-in-python.html#cb1751-43" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_cin&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>]</span>
<span id="cb1751-44"><a href="response-surface-methodology-in-python.html#cb1751-44" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-45"><a href="response-surface-methodology-in-python.html#cb1751-45" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-46"><a href="response-surface-methodology-in-python.html#cb1751-46" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_cin_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-47"><a href="response-surface-methodology-in-python.html#cb1751-47" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_cin_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-48"><a href="response-surface-methodology-in-python.html#cb1751-48" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_cin_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-49"><a href="response-surface-methodology-in-python.html#cb1751-49" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_cin_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-50"><a href="response-surface-methodology-in-python.html#cb1751-50" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-51"><a href="response-surface-methodology-in-python.html#cb1751-51" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-52"><a href="response-surface-methodology-in-python.html#cb1751-52" tabindex="-1"></a>mygrid[<span class="st">&#39;cin_but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-53"><a href="response-surface-methodology-in-python.html#cb1751-53" tabindex="-1"></a></span>
<span id="cb1751-54"><a href="response-surface-methodology-in-python.html#cb1751-54" tabindex="-1"></a><span class="co"># 4-way interactions</span></span>
<span id="cb1751-55"><a href="response-surface-methodology-in-python.html#cb1751-55" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_cin_but&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1751-56"><a href="response-surface-methodology-in-python.html#cb1751-56" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_cin_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-57"><a href="response-surface-methodology-in-python.html#cb1751-57" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-58"><a href="response-surface-methodology-in-python.html#cb1751-58" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_cin_but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-59"><a href="response-surface-methodology-in-python.html#cb1751-59" tabindex="-1"></a>mygrid[<span class="st">&#39;gin_cin_but_flour&#39;</span>] <span class="op">=</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1751-60"><a href="response-surface-methodology-in-python.html#cb1751-60" tabindex="-1"></a></span>
<span id="cb1751-61"><a href="response-surface-methodology-in-python.html#cb1751-61" tabindex="-1"></a><span class="co"># 5-way interaction</span></span>
<span id="cb1751-62"><a href="response-surface-methodology-in-python.html#cb1751-62" tabindex="-1"></a>mygrid[<span class="st">&#39;mol_gin_cin_but_flour&#39;</span>] <span class="op">=</span> (mygrid[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;ginger&#39;</span>] <span class="op">*</span> </span>
<span id="cb1751-63"><a href="response-surface-methodology-in-python.html#cb1751-63" tabindex="-1"></a>                                    mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;butter&#39;</span>] <span class="op">*</span> mygrid[<span class="st">&#39;flour&#39;</span>])</span>
<span id="cb1751-64"><a href="response-surface-methodology-in-python.html#cb1751-64" tabindex="-1"></a></span>
<span id="cb1751-65"><a href="response-surface-methodology-in-python.html#cb1751-65" tabindex="-1"></a><span class="co"># Predict (this is complex - in practice you might want to use a simpler model)</span></span>
<span id="cb1751-66"><a href="response-surface-methodology-in-python.html#cb1751-66" tabindex="-1"></a><span class="co"># statsmodels will automatically use the columns it needs from the DataFrame</span></span>
<span id="cb1751-67"><a href="response-surface-methodology-in-python.html#cb1751-67" tabindex="-1"></a>mygrid[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> m5.predict(mygrid)</span></code></pre></div>
<p>Next, let’s use our grid to visualize the contours in <code>matplotlib</code> with subplots!</p>
<div class="sourceCode" id="cb1752"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1752-1"><a href="response-surface-methodology-in-python.html#cb1752-1" tabindex="-1"></a><span class="co"># Create subplots for each cinnamon value</span></span>
<span id="cb1752-2"><a href="response-surface-methodology-in-python.html#cb1752-2" tabindex="-1"></a>cinnamon_vals_plot <span class="op">=</span> <span class="bu">sorted</span>(mygrid[<span class="st">&#39;cinnamon&#39;</span>].unique())</span>
<span id="cb1752-3"><a href="response-surface-methodology-in-python.html#cb1752-3" tabindex="-1"></a>fig4, axes4 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), constrained_layout<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1752-4"><a href="response-surface-methodology-in-python.html#cb1752-4" tabindex="-1"></a></span>
<span id="cb1752-5"><a href="response-surface-methodology-in-python.html#cb1752-5" tabindex="-1"></a><span class="co"># Get common min/max for consistent colorbar</span></span>
<span id="cb1752-6"><a href="response-surface-methodology-in-python.html#cb1752-6" tabindex="-1"></a>vmin <span class="op">=</span> mygrid[<span class="st">&#39;yhat&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb1752-7"><a href="response-surface-methodology-in-python.html#cb1752-7" tabindex="-1"></a>vmax <span class="op">=</span> mygrid[<span class="st">&#39;yhat&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb1752-8"><a href="response-surface-methodology-in-python.html#cb1752-8" tabindex="-1"></a></span>
<span id="cb1752-9"><a href="response-surface-methodology-in-python.html#cb1752-9" tabindex="-1"></a><span class="co"># Create subplots for each cinnamon value</span></span>
<span id="cb1752-10"><a href="response-surface-methodology-in-python.html#cb1752-10" tabindex="-1"></a><span class="cf">for</span> idx, cinnamon_val <span class="kw">in</span> <span class="bu">enumerate</span>(cinnamon_vals_plot):</span>
<span id="cb1752-11"><a href="response-surface-methodology-in-python.html#cb1752-11" tabindex="-1"></a>    <span class="co"># Filter data for this cinnamon value</span></span>
<span id="cb1752-12"><a href="response-surface-methodology-in-python.html#cb1752-12" tabindex="-1"></a>    grid_subset <span class="op">=</span> mygrid[mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">==</span> cinnamon_val].copy()</span>
<span id="cb1752-13"><a href="response-surface-methodology-in-python.html#cb1752-13" tabindex="-1"></a>    </span>
<span id="cb1752-14"><a href="response-surface-methodology-in-python.html#cb1752-14" tabindex="-1"></a>    <span class="co"># Reshape for contour plotting</span></span>
<span id="cb1752-15"><a href="response-surface-methodology-in-python.html#cb1752-15" tabindex="-1"></a>    molasses_unique_grid <span class="op">=</span> <span class="bu">sorted</span>(grid_subset[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1752-16"><a href="response-surface-methodology-in-python.html#cb1752-16" tabindex="-1"></a>    ginger_unique_grid <span class="op">=</span> <span class="bu">sorted</span>(grid_subset[<span class="st">&#39;ginger&#39;</span>].unique())</span>
<span id="cb1752-17"><a href="response-surface-methodology-in-python.html#cb1752-17" tabindex="-1"></a>    M_grid, G_grid <span class="op">=</span> np.meshgrid(molasses_unique_grid, ginger_unique_grid)</span>
<span id="cb1752-18"><a href="response-surface-methodology-in-python.html#cb1752-18" tabindex="-1"></a>    yhat_grid_subset <span class="op">=</span> grid_subset.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span>
<span id="cb1752-19"><a href="response-surface-methodology-in-python.html#cb1752-19" tabindex="-1"></a>    </span>
<span id="cb1752-20"><a href="response-surface-methodology-in-python.html#cb1752-20" tabindex="-1"></a>    <span class="co"># Create contour plot</span></span>
<span id="cb1752-21"><a href="response-surface-methodology-in-python.html#cb1752-21" tabindex="-1"></a>    ax <span class="op">=</span> axes4[idx]</span>
<span id="cb1752-22"><a href="response-surface-methodology-in-python.html#cb1752-22" tabindex="-1"></a>    contour_filled <span class="op">=</span> ax.contourf(M_grid, G_grid, yhat_grid_subset, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax)</span>
<span id="cb1752-23"><a href="response-surface-methodology-in-python.html#cb1752-23" tabindex="-1"></a>    contour_lines <span class="op">=</span> ax.contour(M_grid, G_grid, yhat_grid_subset, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1752-24"><a href="response-surface-methodology-in-python.html#cb1752-24" tabindex="-1"></a>    ax.clabel(contour_lines, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">7</span>, fmt<span class="op">=</span><span class="st">&#39;%1.0f&#39;</span>)</span>
<span id="cb1752-25"><a href="response-surface-methodology-in-python.html#cb1752-25" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb1752-26"><a href="response-surface-methodology-in-python.html#cb1752-26" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1752-27"><a href="response-surface-methodology-in-python.html#cb1752-27" tabindex="-1"></a>        ax.set_ylabel(<span class="st">&#39;Ginger (tablespoons)&#39;</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb1752-28"><a href="response-surface-methodology-in-python.html#cb1752-28" tabindex="-1"></a>    ax.set_title(<span class="ss">f&#39;Cinnamon = </span><span class="sc">{</span>cinnamon_val<span class="sc">}</span><span class="ss">&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1752-29"><a href="response-surface-methodology-in-python.html#cb1752-29" tabindex="-1"></a></span>
<span id="cb1752-30"><a href="response-surface-methodology-in-python.html#cb1752-30" tabindex="-1"></a><span class="co"># Add overall title</span></span>
<span id="cb1752-31"><a href="response-surface-methodology-in-python.html#cb1752-31" tabindex="-1"></a>fig4.suptitle(<span class="st">&#39;Predicted Gingerbread Cookie Tastiness</span><span class="ch">\n</span><span class="st">by Tablespoons of Cinnamon&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, y<span class="op">=</span><span class="fl">1.1</span>)</span>
<span id="cb1752-32"><a href="response-surface-methodology-in-python.html#cb1752-32" tabindex="-1"></a></span>
<span id="cb1752-33"><a href="response-surface-methodology-in-python.html#cb1752-33" tabindex="-1"></a><span class="co"># Add colorbar</span></span>
<span id="cb1752-34"><a href="response-surface-methodology-in-python.html#cb1752-34" tabindex="-1"></a>cbar4 <span class="op">=</span> plt.colorbar(contour_filled, ax<span class="op">=</span>axes4, orientation<span class="op">=</span><span class="st">&#39;vertical&#39;</span>)</span>
<span id="cb1752-35"><a href="response-surface-methodology-in-python.html#cb1752-35" tabindex="-1"></a>cbar4.set_label(<span class="st">&#39;Predicted Yum Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1752-36"><a href="response-surface-methodology-in-python.html#cb1752-36" tabindex="-1"></a></span>
<span id="cb1752-37"><a href="response-surface-methodology-in-python.html#cb1752-37" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb1752-38"><a href="response-surface-methodology-in-python.html#cb1752-38" tabindex="-1"></a><span class="co"># plt.tight_layout(rect=[0, 0, 0.92, 0.95])</span></span>
<span id="cb1752-39"><a href="response-surface-methodology-in-python.html#cb1752-39" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_plot.png&quot;</span>, dpi<span class="op">=</span><span class="dv">500</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1752-40"><a href="response-surface-methodology-in-python.html#cb1752-40" tabindex="-1"></a>plt.close(fig4)</span></code></pre></div>
<p><img src="matplotlib_figures/15_plot.png" width="100%" /></p>
<p>What can we learn from this plot?</p>
<ul>
<li><p>When we add more <code>cinnamon</code> (<code>2</code> tbsp; right), the zone in which cookies are truly bad (the smallest yum scores) shrinks greatly (compared to <code>left</code> and <code>center</code> panels).</p></li>
<li><p>Otherwise, <code>cinnamon</code> has fairly minimal interaction effects with <code>ginger</code> and <code>molasses</code> on <code>yum</code> scores.</p></li>
</ul>
<p><br></p>
</div>
</div>
<div id="learning-check-3-14" class="section level2 unnumbered LC hasAnchor">
<h2>Learning Check 3<a href="response-surface-methodology-in-python.html#learning-check-3-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we want to examine <em>other</em> interactions! Design your own <code>matplotlib</code> plot to test how <code>butter</code> shapes the <code>yum</code> factor as <code>molasses</code> and <code>flour</code> vary.</p>
<p><strong>Question</strong></p>
<p>Put molasses on the x-axis from 0 to 4 cups, flour on the y-axis from 0 to 4 cups, and vary the level of butter across panels from 0.75 to 1 to 1.25 cups. Hold other conditions at their mean values.</p>
<details>
<summary>
<strong>[View Answer!]</strong>
</summary>
<div class="sourceCode" id="cb1753"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1753-1"><a href="response-surface-methodology-in-python.html#cb1753-1" tabindex="-1"></a><span class="co"># Make the grid!</span></span>
<span id="cb1753-2"><a href="response-surface-methodology-in-python.html#cb1753-2" tabindex="-1"></a>molasses_lc <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">30</span>)</span>
<span id="cb1753-3"><a href="response-surface-methodology-in-python.html#cb1753-3" tabindex="-1"></a>flour_lc <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">30</span>)</span>
<span id="cb1753-4"><a href="response-surface-methodology-in-python.html#cb1753-4" tabindex="-1"></a>butter_vals <span class="op">=</span> [<span class="fl">0.75</span>, <span class="dv">1</span>, <span class="fl">1.25</span>]</span>
<span id="cb1753-5"><a href="response-surface-methodology-in-python.html#cb1753-5" tabindex="-1"></a></span>
<span id="cb1753-6"><a href="response-surface-methodology-in-python.html#cb1753-6" tabindex="-1"></a>grid_list_lc <span class="op">=</span> []</span>
<span id="cb1753-7"><a href="response-surface-methodology-in-python.html#cb1753-7" tabindex="-1"></a><span class="cf">for</span> butter_val <span class="kw">in</span> butter_vals:</span>
<span id="cb1753-8"><a href="response-surface-methodology-in-python.html#cb1753-8" tabindex="-1"></a>    <span class="cf">for</span> mol, fl <span class="kw">in</span> product(molasses_lc, flour_lc):</span>
<span id="cb1753-9"><a href="response-surface-methodology-in-python.html#cb1753-9" tabindex="-1"></a>        grid_list_lc.append({</span>
<span id="cb1753-10"><a href="response-surface-methodology-in-python.html#cb1753-10" tabindex="-1"></a>            <span class="st">&#39;molasses&#39;</span>: mol,</span>
<span id="cb1753-11"><a href="response-surface-methodology-in-python.html#cb1753-11" tabindex="-1"></a>            <span class="st">&#39;flour&#39;</span>: fl,</span>
<span id="cb1753-12"><a href="response-surface-methodology-in-python.html#cb1753-12" tabindex="-1"></a>            <span class="st">&#39;butter&#39;</span>: butter_val,</span>
<span id="cb1753-13"><a href="response-surface-methodology-in-python.html#cb1753-13" tabindex="-1"></a>            <span class="st">&#39;ginger&#39;</span>: cookies3[<span class="st">&#39;ginger&#39;</span>].mean(),</span>
<span id="cb1753-14"><a href="response-surface-methodology-in-python.html#cb1753-14" tabindex="-1"></a>            <span class="st">&#39;cinnamon&#39;</span>: cookies3[<span class="st">&#39;cinnamon&#39;</span>].mean()</span>
<span id="cb1753-15"><a href="response-surface-methodology-in-python.html#cb1753-15" tabindex="-1"></a>        })</span>
<span id="cb1753-16"><a href="response-surface-methodology-in-python.html#cb1753-16" tabindex="-1"></a></span>
<span id="cb1753-17"><a href="response-surface-methodology-in-python.html#cb1753-17" tabindex="-1"></a>mygrid_lc3 <span class="op">=</span> pd.DataFrame(grid_list_lc)</span>
<span id="cb1753-18"><a href="response-surface-methodology-in-python.html#cb1753-18" tabindex="-1"></a></span>
<span id="cb1753-19"><a href="response-surface-methodology-in-python.html#cb1753-19" tabindex="-1"></a><span class="co"># Add all necessary polynomial and interaction terms (simplified version)</span></span>
<span id="cb1753-20"><a href="response-surface-methodology-in-python.html#cb1753-20" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;molasses_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-21"><a href="response-surface-methodology-in-python.html#cb1753-21" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;ginger_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;ginger&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-22"><a href="response-surface-methodology-in-python.html#cb1753-22" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;cinnamon_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-23"><a href="response-surface-methodology-in-python.html#cb1753-23" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;butter_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;butter&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-24"><a href="response-surface-methodology-in-python.html#cb1753-24" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;flour_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;flour&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-25"><a href="response-surface-methodology-in-python.html#cb1753-25" tabindex="-1"></a></span>
<span id="cb1753-26"><a href="response-surface-methodology-in-python.html#cb1753-26" tabindex="-1"></a><span class="co"># Add interaction terms (simplified - would need all for full model)</span></span>
<span id="cb1753-27"><a href="response-surface-methodology-in-python.html#cb1753-27" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_gin&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;ginger&#39;</span>]</span>
<span id="cb1753-28"><a href="response-surface-methodology-in-python.html#cb1753-28" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_cin&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;cinnamon&#39;</span>]</span>
<span id="cb1753-29"><a href="response-surface-methodology-in-python.html#cb1753-29" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_but&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1753-30"><a href="response-surface-methodology-in-python.html#cb1753-30" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_flour&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1753-31"><a href="response-surface-methodology-in-python.html#cb1753-31" tabindex="-1"></a><span class="co"># ... (would need all interactions for full prediction)</span></span>
<span id="cb1753-32"><a href="response-surface-methodology-in-python.html#cb1753-32" tabindex="-1"></a></span>
<span id="cb1753-33"><a href="response-surface-methodology-in-python.html#cb1753-33" tabindex="-1"></a><span class="co"># For demonstration, let&#39;s use a simpler approach: create a model just for this visualization</span></span>
<span id="cb1753-34"><a href="response-surface-methodology-in-python.html#cb1753-34" tabindex="-1"></a><span class="co"># with the key terms</span></span>
<span id="cb1753-35"><a href="response-surface-methodology-in-python.html#cb1753-35" tabindex="-1"></a>cookies3_simple <span class="op">=</span> cookies3.copy()</span>
<span id="cb1753-36"><a href="response-surface-methodology-in-python.html#cb1753-36" tabindex="-1"></a>cookies3_simple[<span class="st">&#39;molasses_sq&#39;</span>] <span class="op">=</span> cookies3_simple[<span class="st">&#39;molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-37"><a href="response-surface-methodology-in-python.html#cb1753-37" tabindex="-1"></a>cookies3_simple[<span class="st">&#39;flour_sq&#39;</span>] <span class="op">=</span> cookies3_simple[<span class="st">&#39;flour&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-38"><a href="response-surface-methodology-in-python.html#cb1753-38" tabindex="-1"></a>cookies3_simple[<span class="st">&#39;butter_sq&#39;</span>] <span class="op">=</span> cookies3_simple[<span class="st">&#39;butter&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-39"><a href="response-surface-methodology-in-python.html#cb1753-39" tabindex="-1"></a></span>
<span id="cb1753-40"><a href="response-surface-methodology-in-python.html#cb1753-40" tabindex="-1"></a>m_lc3 <span class="op">=</span> lm(formula <span class="op">=</span> <span class="st">&#39;yum ~ molasses * flour * butter + molasses_sq + flour_sq + butter_sq&#39;</span>, </span>
<span id="cb1753-41"><a href="response-surface-methodology-in-python.html#cb1753-41" tabindex="-1"></a>           data <span class="op">=</span> cookies3_simple)</span>
<span id="cb1753-42"><a href="response-surface-methodology-in-python.html#cb1753-42" tabindex="-1"></a></span>
<span id="cb1753-43"><a href="response-surface-methodology-in-python.html#cb1753-43" tabindex="-1"></a><span class="co"># Prepare prediction grid with necessary terms</span></span>
<span id="cb1753-44"><a href="response-surface-methodology-in-python.html#cb1753-44" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;molasses_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-45"><a href="response-surface-methodology-in-python.html#cb1753-45" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;flour_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;flour&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-46"><a href="response-surface-methodology-in-python.html#cb1753-46" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;butter_sq&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;butter&#39;</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1753-47"><a href="response-surface-methodology-in-python.html#cb1753-47" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_flour&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;flour&#39;</span>]</span>
<span id="cb1753-48"><a href="response-surface-methodology-in-python.html#cb1753-48" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_but&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1753-49"><a href="response-surface-methodology-in-python.html#cb1753-49" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;flour_but&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;flour&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1753-50"><a href="response-surface-methodology-in-python.html#cb1753-50" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;mol_flour_but&#39;</span>] <span class="op">=</span> mygrid_lc3[<span class="st">&#39;molasses&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;flour&#39;</span>] <span class="op">*</span> mygrid_lc3[<span class="st">&#39;butter&#39;</span>]</span>
<span id="cb1753-51"><a href="response-surface-methodology-in-python.html#cb1753-51" tabindex="-1"></a></span>
<span id="cb1753-52"><a href="response-surface-methodology-in-python.html#cb1753-52" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb1753-53"><a href="response-surface-methodology-in-python.html#cb1753-53" tabindex="-1"></a>mygrid_lc3[<span class="st">&#39;yhat&#39;</span>] <span class="op">=</span> m_lc3.predict(mygrid_lc3)</span>
<span id="cb1753-54"><a href="response-surface-methodology-in-python.html#cb1753-54" tabindex="-1"></a></span>
<span id="cb1753-55"><a href="response-surface-methodology-in-python.html#cb1753-55" tabindex="-1"></a><span class="co"># Create subplots for each butter value</span></span>
<span id="cb1753-56"><a href="response-surface-methodology-in-python.html#cb1753-56" tabindex="-1"></a>butter_vals_plot <span class="op">=</span> <span class="bu">sorted</span>(mygrid_lc3[<span class="st">&#39;butter&#39;</span>].unique())</span>
<span id="cb1753-57"><a href="response-surface-methodology-in-python.html#cb1753-57" tabindex="-1"></a>fig_lc3, axes_lc3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), constrained_layout<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1753-58"><a href="response-surface-methodology-in-python.html#cb1753-58" tabindex="-1"></a></span>
<span id="cb1753-59"><a href="response-surface-methodology-in-python.html#cb1753-59" tabindex="-1"></a><span class="co"># Get common min/max for consistent colorbar</span></span>
<span id="cb1753-60"><a href="response-surface-methodology-in-python.html#cb1753-60" tabindex="-1"></a>vmin_lc3 <span class="op">=</span> mygrid_lc3[<span class="st">&#39;yhat&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb1753-61"><a href="response-surface-methodology-in-python.html#cb1753-61" tabindex="-1"></a>vmax_lc3 <span class="op">=</span> mygrid_lc3[<span class="st">&#39;yhat&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb1753-62"><a href="response-surface-methodology-in-python.html#cb1753-62" tabindex="-1"></a></span>
<span id="cb1753-63"><a href="response-surface-methodology-in-python.html#cb1753-63" tabindex="-1"></a><span class="cf">for</span> idx, butter_val <span class="kw">in</span> <span class="bu">enumerate</span>(butter_vals_plot):</span>
<span id="cb1753-64"><a href="response-surface-methodology-in-python.html#cb1753-64" tabindex="-1"></a>    <span class="co"># Filter data for this butter value</span></span>
<span id="cb1753-65"><a href="response-surface-methodology-in-python.html#cb1753-65" tabindex="-1"></a>    grid_subset_lc3 <span class="op">=</span> mygrid_lc3[mygrid_lc3[<span class="st">&#39;butter&#39;</span>] <span class="op">==</span> butter_val].copy()</span>
<span id="cb1753-66"><a href="response-surface-methodology-in-python.html#cb1753-66" tabindex="-1"></a>    </span>
<span id="cb1753-67"><a href="response-surface-methodology-in-python.html#cb1753-67" tabindex="-1"></a>    <span class="co"># Reshape for contour plotting</span></span>
<span id="cb1753-68"><a href="response-surface-methodology-in-python.html#cb1753-68" tabindex="-1"></a>    molasses_unique_lc3 <span class="op">=</span> <span class="bu">sorted</span>(grid_subset_lc3[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1753-69"><a href="response-surface-methodology-in-python.html#cb1753-69" tabindex="-1"></a>    flour_unique_lc3 <span class="op">=</span> <span class="bu">sorted</span>(grid_subset_lc3[<span class="st">&#39;flour&#39;</span>].unique())</span>
<span id="cb1753-70"><a href="response-surface-methodology-in-python.html#cb1753-70" tabindex="-1"></a>    M_lc3, F_lc3 <span class="op">=</span> np.meshgrid(molasses_unique_lc3, flour_unique_lc3)</span>
<span id="cb1753-71"><a href="response-surface-methodology-in-python.html#cb1753-71" tabindex="-1"></a>    yhat_grid_lc3 <span class="op">=</span> grid_subset_lc3.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;flour&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span>
<span id="cb1753-72"><a href="response-surface-methodology-in-python.html#cb1753-72" tabindex="-1"></a>    </span>
<span id="cb1753-73"><a href="response-surface-methodology-in-python.html#cb1753-73" tabindex="-1"></a>    <span class="co"># Create contour plot</span></span>
<span id="cb1753-74"><a href="response-surface-methodology-in-python.html#cb1753-74" tabindex="-1"></a>    ax <span class="op">=</span> axes_lc3[idx]</span>
<span id="cb1753-75"><a href="response-surface-methodology-in-python.html#cb1753-75" tabindex="-1"></a>    contour_filled_lc3 <span class="op">=</span> ax.contourf(M_lc3, F_lc3, yhat_grid_lc3, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, vmin<span class="op">=</span>vmin_lc3, vmax<span class="op">=</span>vmax_lc3)</span>
<span id="cb1753-76"><a href="response-surface-methodology-in-python.html#cb1753-76" tabindex="-1"></a>    contour_lines_lc3 <span class="op">=</span> ax.contour(M_lc3, F_lc3, yhat_grid_lc3, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1753-77"><a href="response-surface-methodology-in-python.html#cb1753-77" tabindex="-1"></a>    ax.clabel(contour_lines_lc3, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">7</span>, fmt<span class="op">=</span><span class="st">&#39;%1.0f&#39;</span>)</span>
<span id="cb1753-78"><a href="response-surface-methodology-in-python.html#cb1753-78" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb1753-79"><a href="response-surface-methodology-in-python.html#cb1753-79" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1753-80"><a href="response-surface-methodology-in-python.html#cb1753-80" tabindex="-1"></a>        ax.set_ylabel(<span class="st">&#39;Flour (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb1753-81"><a href="response-surface-methodology-in-python.html#cb1753-81" tabindex="-1"></a>    ax.set_title(<span class="ss">f&#39;Butter = </span><span class="sc">{</span>butter_val<span class="sc">}</span><span class="ss">&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1753-82"><a href="response-surface-methodology-in-python.html#cb1753-82" tabindex="-1"></a></span>
<span id="cb1753-83"><a href="response-surface-methodology-in-python.html#cb1753-83" tabindex="-1"></a><span class="co"># Add overall title</span></span>
<span id="cb1753-84"><a href="response-surface-methodology-in-python.html#cb1753-84" tabindex="-1"></a>fig_lc3.suptitle(<span class="st">&#39;Predicted Gingerbread Cookie Tastiness</span><span class="ch">\n</span><span class="st">by Cups of Butter&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>, y<span class="op">=</span><span class="fl">1.1</span>)</span>
<span id="cb1753-85"><a href="response-surface-methodology-in-python.html#cb1753-85" tabindex="-1"></a></span>
<span id="cb1753-86"><a href="response-surface-methodology-in-python.html#cb1753-86" tabindex="-1"></a><span class="co"># Add colorbar</span></span>
<span id="cb1753-87"><a href="response-surface-methodology-in-python.html#cb1753-87" tabindex="-1"></a>cbar_lc3 <span class="op">=</span> plt.colorbar(contour_filled_lc3, ax<span class="op">=</span>axes_lc3, orientation<span class="op">=</span><span class="st">&#39;vertical&#39;</span>)</span>
<span id="cb1753-88"><a href="response-surface-methodology-in-python.html#cb1753-88" tabindex="-1"></a>cbar_lc3.set_label(<span class="st">&#39;Predicted Yum Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1753-89"><a href="response-surface-methodology-in-python.html#cb1753-89" tabindex="-1"></a></span>
<span id="cb1753-90"><a href="response-surface-methodology-in-python.html#cb1753-90" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb1753-91"><a href="response-surface-methodology-in-python.html#cb1753-91" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_learning_check_3.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1753-92"><a href="response-surface-methodology-in-python.html#cb1753-92" tabindex="-1"></a>plt.close(fig_lc3)</span></code></pre></div>
<p><img src="matplotlib_figures/15_learning_check_3.png" width="100%" /></p>
<p>This plot tells us that adding more butter to the cookies tends to reduce the amount of the contour with low <code>yum</code> scores, and increases the relative share of the response surface with mid-range <code>yum</code> scores.</p>
</details>
<hr />
<p><br>
<br></p>
</div>
<div id="quantities-of-interest-in-rsm-1" class="section level2 hasAnchor" number="29.4">
<h2><span class="header-section-number">29.4</span> Quantities of Interest in RSM<a href="response-surface-methodology-in-python.html#quantities-of-interest-in-rsm-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we might be interested in calculating (and annotating our charts) with some key quantities of interest! Let’s use our model <code>m5</code> from earlier.</p>
<p><br></p>
<div id="percent-change-in-bins-1" class="section level3 hasAnchor" number="29.4.1">
<h3><span class="header-section-number">29.4.1</span> Percent Change in Bins<a href="response-surface-methodology-in-python.html#percent-change-in-bins-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, when comparing change across panels, we’re essentially comparing change in <em>area</em>. So we can use our grid of conditions and predictions <code>mygrid</code> to calculate those percentages!</p>
<div class="sourceCode" id="cb1754"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1754-1"><a href="response-surface-methodology-in-python.html#cb1754-1" tabindex="-1"></a><span class="co"># Cut the outcome into bins, 5 units wide on the yum scale</span></span>
<span id="cb1754-2"><a href="response-surface-methodology-in-python.html#cb1754-2" tabindex="-1"></a><span class="co"># cut_interval creates bins starting from the minimum value, not from a round number</span></span>
<span id="cb1754-3"><a href="response-surface-methodology-in-python.html#cb1754-3" tabindex="-1"></a>yhat_min <span class="op">=</span> mygrid[<span class="st">&#39;yhat&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb1754-4"><a href="response-surface-methodology-in-python.html#cb1754-4" tabindex="-1"></a>yhat_max <span class="op">=</span> mygrid[<span class="st">&#39;yhat&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb1754-5"><a href="response-surface-methodology-in-python.html#cb1754-5" tabindex="-1"></a><span class="co"># Create bin edges every 5 units, starting from the actual minimum value</span></span>
<span id="cb1754-6"><a href="response-surface-methodology-in-python.html#cb1754-6" tabindex="-1"></a>bin_start <span class="op">=</span> np.floor(yhat_min <span class="op">/</span> <span class="dv">5</span>) <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb1754-7"><a href="response-surface-methodology-in-python.html#cb1754-7" tabindex="-1"></a>bin_end <span class="op">=</span> np.ceil(yhat_max <span class="op">/</span> <span class="dv">5</span>) <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb1754-8"><a href="response-surface-methodology-in-python.html#cb1754-8" tabindex="-1"></a><span class="co"># Generate bins: start, start+5, start+10, ... up to at least the max</span></span>
<span id="cb1754-9"><a href="response-surface-methodology-in-python.html#cb1754-9" tabindex="-1"></a>bins <span class="op">=</span> np.arange(bin_start, bin_end <span class="op">+</span> <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb1754-10"><a href="response-surface-methodology-in-python.html#cb1754-10" tabindex="-1"></a></span>
<span id="cb1754-11"><a href="response-surface-methodology-in-python.html#cb1754-11" tabindex="-1"></a><span class="co"># Cut into bins of width 5 (right=True means intervals are (left, right])</span></span>
<span id="cb1754-12"><a href="response-surface-methodology-in-python.html#cb1754-12" tabindex="-1"></a>mygrid[<span class="st">&#39;bin&#39;</span>] <span class="op">=</span> pd.cut(mygrid[<span class="st">&#39;yhat&#39;</span>], bins<span class="op">=</span>bins, include_lowest<span class="op">=</span><span class="va">True</span>, right<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1754-13"><a href="response-surface-methodology-in-python.html#cb1754-13" tabindex="-1"></a></span>
<span id="cb1754-14"><a href="response-surface-methodology-in-python.html#cb1754-14" tabindex="-1"></a><span class="co"># For each panel and bin, count up the predictions in that interval</span></span>
<span id="cb1754-15"><a href="response-surface-methodology-in-python.html#cb1754-15" tabindex="-1"></a>area <span class="op">=</span> (mygrid.groupby([<span class="st">&#39;cinnamon&#39;</span>, <span class="st">&#39;bin&#39;</span>])</span>
<span id="cb1754-16"><a href="response-surface-methodology-in-python.html#cb1754-16" tabindex="-1"></a>        .size()</span>
<span id="cb1754-17"><a href="response-surface-methodology-in-python.html#cb1754-17" tabindex="-1"></a>        .reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>))</span>
<span id="cb1754-18"><a href="response-surface-methodology-in-python.html#cb1754-18" tabindex="-1"></a></span>
<span id="cb1754-19"><a href="response-surface-methodology-in-python.html#cb1754-19" tabindex="-1"></a><span class="co"># Now, for each panel, calculate the percentage of predictions in that panel located in each bin</span></span>
<span id="cb1754-20"><a href="response-surface-methodology-in-python.html#cb1754-20" tabindex="-1"></a>area[<span class="st">&#39;percent&#39;</span>] <span class="op">=</span> (area.groupby(<span class="st">&#39;cinnamon&#39;</span>)[<span class="st">&#39;count&#39;</span>]</span>
<span id="cb1754-21"><a href="response-surface-methodology-in-python.html#cb1754-21" tabindex="-1"></a>                   .transform(<span class="kw">lambda</span> x: x <span class="op">/</span> x.<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span>))</span>
<span id="cb1754-22"><a href="response-surface-methodology-in-python.html#cb1754-22" tabindex="-1"></a></span>
<span id="cb1754-23"><a href="response-surface-methodology-in-python.html#cb1754-23" tabindex="-1"></a><span class="co"># Round to 2 decimal places</span></span>
<span id="cb1754-24"><a href="response-surface-methodology-in-python.html#cb1754-24" tabindex="-1"></a>area[<span class="st">&#39;percent&#39;</span>] <span class="op">=</span> area[<span class="st">&#39;percent&#39;</span>].<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb1754-25"><a href="response-surface-methodology-in-python.html#cb1754-25" tabindex="-1"></a></span>
<span id="cb1754-26"><a href="response-surface-methodology-in-python.html#cb1754-26" tabindex="-1"></a><span class="co"># Zoom into the lowest bin.</span></span>
<span id="cb1754-27"><a href="response-surface-methodology-in-python.html#cb1754-27" tabindex="-1"></a><span class="co"># What percentage of the area was in that bin given each level of cinnamon?</span></span>
<span id="cb1754-28"><a href="response-surface-methodology-in-python.html#cb1754-28" tabindex="-1"></a><span class="co"># Filter for the bin [10,15]</span></span>
<span id="cb1754-29"><a href="response-surface-methodology-in-python.html#cb1754-29" tabindex="-1"></a>qi1 <span class="op">=</span> area[area[<span class="st">&#39;bin&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">abs</span>(x.left <span class="op">-</span> <span class="dv">10</span>) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="kw">and</span> <span class="bu">abs</span>(x.right <span class="op">-</span> <span class="dv">15</span>) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">if</span> <span class="bu">hasattr</span>(x, <span class="st">&#39;left&#39;</span>) <span class="kw">and</span> <span class="bu">hasattr</span>(x, <span class="st">&#39;right&#39;</span>) <span class="cf">else</span> <span class="va">False</span>)]</span>
<span id="cb1754-30"><a href="response-surface-methodology-in-python.html#cb1754-30" tabindex="-1"></a></span>
<span id="cb1754-31"><a href="response-surface-methodology-in-python.html#cb1754-31" tabindex="-1"></a><span class="bu">print</span>(qi1)</span></code></pre></div>
<pre><code>##     cinnamon            bin  count  percent
## 0          0  (9.999, 15.0]    121    13.44
## 10         1  (9.999, 15.0]    119    13.22
## 20         2  (9.999, 15.0]     35     3.89</code></pre>
<p>We computed that the area predicted to score lowest on the <code>yum</code> scale decreased as we added more cinnamon.</p>
<p><br>
<br></p>
</div>
<div id="study-range-1" class="section level3 hasAnchor" number="29.4.2">
<h3><span class="header-section-number">29.4.2</span> Study Range<a href="response-surface-methodology-in-python.html#study-range-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We might want our reader to know what is the area that we actually had data on, versus what was the area we were generating predictions from. For this, we can just draw a <code>box</code> from our raw data using matplotlib’s <code>Rectangle</code> patch. For example, since <code>molasses</code> is our <code>x</code> variable and <code>ginger</code> has been our <code>y</code> variable in our <code>matplotlib</code> analyses, we can do the following:</p>
<div class="sourceCode" id="cb1756"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1756-1"><a href="response-surface-methodology-in-python.html#cb1756-1" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb1756-2"><a href="response-surface-methodology-in-python.html#cb1756-2" tabindex="-1"></a></span>
<span id="cb1756-3"><a href="response-surface-methodology-in-python.html#cb1756-3" tabindex="-1"></a><span class="co"># Define the study range box</span></span>
<span id="cb1756-4"><a href="response-surface-methodology-in-python.html#cb1756-4" tabindex="-1"></a>xmin <span class="op">=</span> cookies3[<span class="st">&#39;molasses&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb1756-5"><a href="response-surface-methodology-in-python.html#cb1756-5" tabindex="-1"></a>xmax <span class="op">=</span> cookies3[<span class="st">&#39;molasses&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb1756-6"><a href="response-surface-methodology-in-python.html#cb1756-6" tabindex="-1"></a>ymin <span class="op">=</span> cookies3[<span class="st">&#39;ginger&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb1756-7"><a href="response-surface-methodology-in-python.html#cb1756-7" tabindex="-1"></a>ymax <span class="op">=</span> cookies3[<span class="st">&#39;ginger&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb1756-8"><a href="response-surface-methodology-in-python.html#cb1756-8" tabindex="-1"></a></span>
<span id="cb1756-9"><a href="response-surface-methodology-in-python.html#cb1756-9" tabindex="-1"></a><span class="co"># Create subplots for each cinnamon value</span></span>
<span id="cb1756-10"><a href="response-surface-methodology-in-python.html#cb1756-10" tabindex="-1"></a>cinnamon_vals_study <span class="op">=</span> <span class="bu">sorted</span>(mygrid[<span class="st">&#39;cinnamon&#39;</span>].unique())</span>
<span id="cb1756-11"><a href="response-surface-methodology-in-python.html#cb1756-11" tabindex="-1"></a>fig_study, axes_study <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), constrained_layout<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1756-12"><a href="response-surface-methodology-in-python.html#cb1756-12" tabindex="-1"></a></span>
<span id="cb1756-13"><a href="response-surface-methodology-in-python.html#cb1756-13" tabindex="-1"></a><span class="co"># Get common min/max for consistent colorbar</span></span>
<span id="cb1756-14"><a href="response-surface-methodology-in-python.html#cb1756-14" tabindex="-1"></a>vmin_study <span class="op">=</span> mygrid[<span class="st">&#39;yhat&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb1756-15"><a href="response-surface-methodology-in-python.html#cb1756-15" tabindex="-1"></a>vmax_study <span class="op">=</span> mygrid[<span class="st">&#39;yhat&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb1756-16"><a href="response-surface-methodology-in-python.html#cb1756-16" tabindex="-1"></a></span>
<span id="cb1756-17"><a href="response-surface-methodology-in-python.html#cb1756-17" tabindex="-1"></a><span class="cf">for</span> idx, cinnamon_val <span class="kw">in</span> <span class="bu">enumerate</span>(cinnamon_vals_study):</span>
<span id="cb1756-18"><a href="response-surface-methodology-in-python.html#cb1756-18" tabindex="-1"></a>    <span class="co"># Filter data for this cinnamon value</span></span>
<span id="cb1756-19"><a href="response-surface-methodology-in-python.html#cb1756-19" tabindex="-1"></a>    grid_subset_study <span class="op">=</span> mygrid[mygrid[<span class="st">&#39;cinnamon&#39;</span>] <span class="op">==</span> cinnamon_val].copy()</span>
<span id="cb1756-20"><a href="response-surface-methodology-in-python.html#cb1756-20" tabindex="-1"></a>    </span>
<span id="cb1756-21"><a href="response-surface-methodology-in-python.html#cb1756-21" tabindex="-1"></a>    <span class="co"># Reshape for contour plotting</span></span>
<span id="cb1756-22"><a href="response-surface-methodology-in-python.html#cb1756-22" tabindex="-1"></a>    molasses_unique_study <span class="op">=</span> <span class="bu">sorted</span>(grid_subset_study[<span class="st">&#39;molasses&#39;</span>].unique())</span>
<span id="cb1756-23"><a href="response-surface-methodology-in-python.html#cb1756-23" tabindex="-1"></a>    ginger_unique_study <span class="op">=</span> <span class="bu">sorted</span>(grid_subset_study[<span class="st">&#39;ginger&#39;</span>].unique())</span>
<span id="cb1756-24"><a href="response-surface-methodology-in-python.html#cb1756-24" tabindex="-1"></a>    M_study, G_study <span class="op">=</span> np.meshgrid(molasses_unique_study, ginger_unique_study)</span>
<span id="cb1756-25"><a href="response-surface-methodology-in-python.html#cb1756-25" tabindex="-1"></a>    yhat_grid_study <span class="op">=</span> grid_subset_study.pivot_table(values<span class="op">=</span><span class="st">&#39;yhat&#39;</span>, index<span class="op">=</span><span class="st">&#39;ginger&#39;</span>, columns<span class="op">=</span><span class="st">&#39;molasses&#39;</span>, aggfunc<span class="op">=</span><span class="st">&#39;mean&#39;</span>).values</span>
<span id="cb1756-26"><a href="response-surface-methodology-in-python.html#cb1756-26" tabindex="-1"></a>    </span>
<span id="cb1756-27"><a href="response-surface-methodology-in-python.html#cb1756-27" tabindex="-1"></a>    <span class="co"># Create contour plot</span></span>
<span id="cb1756-28"><a href="response-surface-methodology-in-python.html#cb1756-28" tabindex="-1"></a>    ax <span class="op">=</span> axes_study[idx]</span>
<span id="cb1756-29"><a href="response-surface-methodology-in-python.html#cb1756-29" tabindex="-1"></a>    contour_filled_study <span class="op">=</span> ax.contourf(M_study, G_study, yhat_grid_study, levels<span class="op">=</span><span class="dv">15</span>, cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, vmin<span class="op">=</span>vmin_study, vmax<span class="op">=</span>vmax_study)</span>
<span id="cb1756-30"><a href="response-surface-methodology-in-python.html#cb1756-30" tabindex="-1"></a>    contour_lines_study <span class="op">=</span> ax.contour(M_study, G_study, yhat_grid_study, levels<span class="op">=</span><span class="dv">10</span>, colors<span class="op">=</span><span class="st">&#39;white&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb1756-31"><a href="response-surface-methodology-in-python.html#cb1756-31" tabindex="-1"></a>    ax.clabel(contour_lines_study, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">7</span>, fmt<span class="op">=</span><span class="st">&#39;%1.0f&#39;</span>)</span>
<span id="cb1756-32"><a href="response-surface-methodology-in-python.html#cb1756-32" tabindex="-1"></a>    </span>
<span id="cb1756-33"><a href="response-surface-methodology-in-python.html#cb1756-33" tabindex="-1"></a>    <span class="co"># Add study range box</span></span>
<span id="cb1756-34"><a href="response-surface-methodology-in-python.html#cb1756-34" tabindex="-1"></a>    rect <span class="op">=</span> Rectangle((xmin, ymin), xmax <span class="op">-</span> xmin, ymax <span class="op">-</span> ymin, </span>
<span id="cb1756-35"><a href="response-surface-methodology-in-python.html#cb1756-35" tabindex="-1"></a>                     linewidth<span class="op">=</span><span class="dv">1</span>, edgecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, facecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>)</span>
<span id="cb1756-36"><a href="response-surface-methodology-in-python.html#cb1756-36" tabindex="-1"></a>    ax.add_patch(rect)</span>
<span id="cb1756-37"><a href="response-surface-methodology-in-python.html#cb1756-37" tabindex="-1"></a>    </span>
<span id="cb1756-38"><a href="response-surface-methodology-in-python.html#cb1756-38" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&#39;Molasses (cups)&#39;</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb1756-39"><a href="response-surface-methodology-in-python.html#cb1756-39" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1756-40"><a href="response-surface-methodology-in-python.html#cb1756-40" tabindex="-1"></a>        ax.set_ylabel(<span class="st">&#39;Ginger (tablespoons)&#39;</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb1756-41"><a href="response-surface-methodology-in-python.html#cb1756-41" tabindex="-1"></a>    ax.set_title(<span class="ss">f&#39;Cinnamon = </span><span class="sc">{</span>cinnamon_val<span class="sc">}</span><span class="ss">&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1756-42"><a href="response-surface-methodology-in-python.html#cb1756-42" tabindex="-1"></a></span>
<span id="cb1756-43"><a href="response-surface-methodology-in-python.html#cb1756-43" tabindex="-1"></a><span class="co"># Add colorbar</span></span>
<span id="cb1756-44"><a href="response-surface-methodology-in-python.html#cb1756-44" tabindex="-1"></a>cbar_study <span class="op">=</span> plt.colorbar(contour_filled_study, ax<span class="op">=</span>axes_study, orientation<span class="op">=</span><span class="st">&#39;vertical&#39;</span>)</span>
<span id="cb1756-45"><a href="response-surface-methodology-in-python.html#cb1756-45" tabindex="-1"></a>cbar_study.set_label(<span class="st">&#39;Predicted Yum Factor&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1756-46"><a href="response-surface-methodology-in-python.html#cb1756-46" tabindex="-1"></a></span>
<span id="cb1756-47"><a href="response-surface-methodology-in-python.html#cb1756-47" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb1756-48"><a href="response-surface-methodology-in-python.html#cb1756-48" tabindex="-1"></a>plt.savefig(<span class="st">&quot;matplotlib_figures/15_study_range.png&quot;</span>, dpi<span class="op">=</span><span class="dv">100</span>, bbox_inches<span class="op">=</span><span class="st">&#39;tight&#39;</span>)</span>
<span id="cb1756-49"><a href="response-surface-methodology-in-python.html#cb1756-49" tabindex="-1"></a>plt.close(fig_study)</span></code></pre></div>
<p><img src="matplotlib_figures/15_study_range.png" width="100%" /></p>
<p><br>
<br></p>
</div>
</div>
<div id="extra-concepts-of-interest-canonical-form-1" class="section level2 hasAnchor" number="29.5">
<h2><span class="header-section-number">29.5</span> Extra Concepts of Interest: Canonical Form<a href="response-surface-methodology-in-python.html#extra-concepts-of-interest-canonical-form-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The canonical form is an abbreviation of your long model equation into a much more understandable, short form. For example, if you have 2 predictors <span class="math inline">\(X_{1}\)</span> and <span class="math inline">\(X_{2}\)</span>, the canonical form would look like:</p>
<p><span class="math display">\[ \hat{Y} = Y_{s} +  X_{1}^{2} + X_{2}^{2}\]</span></p>
<ul>
<li>where <span class="math inline">\(Y_{s}\)</span> is the value of <span class="math inline">\(\hat{Y}\)</span> at the <strong>‘stationary point’</strong>, when <span class="math inline">\(X_{1}\)</span> and <span class="math inline">\(X_{2}\)</span> equal 0.</li>
</ul>
<p>The tricky thing is that the <strong>canonical form</strong> is not actually in units of our original predictors, say, cups of <code>molasses</code> and tablespoons of <code>ginger</code>. Instead, the <strong>canonical form</strong> is like a standardized format that maps every value of cups of <code>molasses</code> (written <span class="math inline">\(x_{1}\)</span>) to a new value <span class="math inline">\(X_{1}\)</span>, which is a certain distance away from the <strong>stationary point.</strong></p>
<p>Why would we have a system like this? It’s because certain shapes of contour plots can be recognized from their canonical form alone, with no other detail, so the canonical form can be useful for us. It’s a little more than we can go into at this moment, but suffice it to say that the <strong>canonical form of a model is like a shortcut for interpreting the shape of a contour plot</strong>.</p>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="conclusion-22.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-ggplot-tips.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  },
  "toolbar": {
    "position": "static"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
